<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>CheMPS2: CheMPS2::CASSCF Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="CheMPS2logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">CheMPS2
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classCheMPS2_1_1CASSCF.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classCheMPS2_1_1CASSCF-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CheMPS2::CASSCF Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="CASSCF_8h_source.html">CASSCF.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aee2071ba5914ed3a6e7120e6d1656144"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#aee2071ba5914ed3a6e7120e6d1656144">CASSCF</a> (const string filename)</td></tr>
<tr class="memdesc:aee2071ba5914ed3a6e7120e6d1656144"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#aee2071ba5914ed3a6e7120e6d1656144">More...</a><br/></td></tr>
<tr class="separator:aee2071ba5914ed3a6e7120e6d1656144"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c0aeea016f892a6b4a72cee8a37bd96"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a9c0aeea016f892a6b4a72cee8a37bd96">CASSCF</a> (<a class="el" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a> *HamIn, int *DOCCin, int *SOCCin)</td></tr>
<tr class="memdesc:a9c0aeea016f892a6b4a72cee8a37bd96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a9c0aeea016f892a6b4a72cee8a37bd96">More...</a><br/></td></tr>
<tr class="separator:a9c0aeea016f892a6b4a72cee8a37bd96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20937fd3dbc5c5f3fa2e7ffd4f751900"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a20937fd3dbc5c5f3fa2e7ffd4f751900"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a20937fd3dbc5c5f3fa2e7ffd4f751900">~CASSCF</a> ()</td></tr>
<tr class="memdesc:a20937fd3dbc5c5f3fa2e7ffd4f751900"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br/></td></tr>
<tr class="separator:a20937fd3dbc5c5f3fa2e7ffd4f751900"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afba8add72828a26c426f47a790511bf1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#afba8add72828a26c426f47a790511bf1">getNumberOfIrreps</a> ()</td></tr>
<tr class="memdesc:afba8add72828a26c426f47a790511bf1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of irreps.  <a href="#afba8add72828a26c426f47a790511bf1">More...</a><br/></td></tr>
<tr class="separator:afba8add72828a26c426f47a790511bf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a701bdaa40881168d6b386683eaa01cea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a701bdaa40881168d6b386683eaa01cea">setupStart</a> (int *NoccIn, int *NDMRGIn, int *NvirtIn)</td></tr>
<tr class="memdesc:a701bdaa40881168d6b386683eaa01cea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the start of the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> calculation.  <a href="#a701bdaa40881168d6b386683eaa01cea">More...</a><br/></td></tr>
<tr class="separator:a701bdaa40881168d6b386683eaa01cea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ab912e50eb821fed2089e88692ec0b1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a2ab912e50eb821fed2089e88692ec0b1">doCASSCFnewtonraphson</a> (const int Nelectrons, const int TwoS, const int Irrep, <a class="el" href="classCheMPS2_1_1ConvergenceScheme.html">ConvergenceScheme</a> *OptScheme, const int rootNum, <a class="el" href="classCheMPS2_1_1DMRGSCFoptions.html">DMRGSCFoptions</a> *theDMRGSCFoptions)</td></tr>
<tr class="memdesc:a2ab912e50eb821fed2089e88692ec0b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does the state-specific <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> cycle with the augmented Hessian Newton-Raphson method.  <a href="#a2ab912e50eb821fed2089e88692ec0b1">More...</a><br/></td></tr>
<tr class="separator:a2ab912e50eb821fed2089e88692ec0b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe585ea6f4777137d2bbdd2b475caa6a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afe585ea6f4777137d2bbdd2b475caa6a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#afe585ea6f4777137d2bbdd2b475caa6a">deleteStoredUnitary</a> (const string filename=CheMPS2::DMRGSCF_unitaryStorageName)</td></tr>
<tr class="memdesc:afe585ea6f4777137d2bbdd2b475caa6a"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> unitary rotation remove call. <br/></td></tr>
<tr class="separator:afe585ea6f4777137d2bbdd2b475caa6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd8799e175329933a246dfee97e5dfb7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abd8799e175329933a246dfee97e5dfb7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#abd8799e175329933a246dfee97e5dfb7">deleteStoredDIIS</a> (const string filename=CheMPS2::DMRGSCF_DIISstorageName)</td></tr>
<tr class="memdesc:abd8799e175329933a246dfee97e5dfb7"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> <a class="el" href="classCheMPS2_1_1DIIS.html">DIIS</a> vectors remove call. <br/></td></tr>
<tr class="separator:abd8799e175329933a246dfee97e5dfb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a0210ff118bab44593aef7c6ec9f31a56"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a0210ff118bab44593aef7c6ec9f31a56">buildFmat</a> (<a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localFmat, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localTmat, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localJKocc, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localJKact, const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *localIdx, const <a class="el" href="classCheMPS2_1_1DMRGSCFintegrals.html">DMRGSCFintegrals</a> *theInts, double *local2DM, double *local1DM)</td></tr>
<tr class="memdesc:a0210ff118bab44593aef7c6ec9f31a56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the F-matrix (Eq. (11) in the Siegbahn paper [CAS3])  <a href="#a0210ff118bab44593aef7c6ec9f31a56">More...</a><br/></td></tr>
<tr class="separator:a0210ff118bab44593aef7c6ec9f31a56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21471f166b873029b5e51dda4a6907c4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a21471f166b873029b5e51dda4a6907c4">buildWtilde</a> (<a class="el" href="classCheMPS2_1_1DMRGSCFwtilde.html">DMRGSCFwtilde</a> *localwtilde, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localTmat, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localJKocc, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localJKact, const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *localIdx, const <a class="el" href="classCheMPS2_1_1DMRGSCFintegrals.html">DMRGSCFintegrals</a> *theInts, double *local2DM, double *local1DM)</td></tr>
<tr class="memdesc:a21471f166b873029b5e51dda4a6907c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the Wtilde-matrix (Eq. (20b) in the Siegbahn paper [CAS3])  <a href="#a21471f166b873029b5e51dda4a6907c4">More...</a><br/></td></tr>
<tr class="separator:a21471f166b873029b5e51dda4a6907c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf34a3243a38979439e7aa2d9e60c4dd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#abf34a3243a38979439e7aa2d9e60c4dd">augmentedHessianNR</a> (const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localFmat, const <a class="el" href="classCheMPS2_1_1DMRGSCFwtilde.html">DMRGSCFwtilde</a> *localwtilde, const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *localIdx, const <a class="el" href="classCheMPS2_1_1DMRGSCFunitary.html">DMRGSCFunitary</a> *localUmat, double *theupdate, double *updateNorm, double *gradNorm)</td></tr>
<tr class="memdesc:abf34a3243a38979439e7aa2d9e60c4dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the augmented Hessian Newton-Raphson update for the orthogonal orbital rotation matrix.  <a href="#abf34a3243a38979439e7aa2d9e60c4dd">More...</a><br/></td></tr>
<tr class="separator:abf34a3243a38979439e7aa2d9e60c4dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8305d7f87c340f9001e497aaf7ba93f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#ae8305d7f87c340f9001e497aaf7ba93f">copy2DMover</a> (<a class="el" href="classCheMPS2_1_1TwoDM.html">TwoDM</a> *theDMRG2DM, const int totOrbDMRG, double *localDMRG2DM)</td></tr>
<tr class="memdesc:ae8305d7f87c340f9001e497aaf7ba93f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy over the <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 2-RDM.  <a href="#ae8305d7f87c340f9001e497aaf7ba93f">More...</a><br/></td></tr>
<tr class="separator:ae8305d7f87c340f9001e497aaf7ba93f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56b332538d87b477c036385b0b7c371e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a56b332538d87b477c036385b0b7c371e">setDMRG1DM</a> (const int nDMRGelectrons, const int totOrbDMRG, double *localDMRG1DM, double *localDMRG2DM)</td></tr>
<tr class="memdesc:a56b332538d87b477c036385b0b7c371e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct the 1-RDM from the 2-RDM.  <a href="#a56b332538d87b477c036385b0b7c371e">More...</a><br/></td></tr>
<tr class="separator:a56b332538d87b477c036385b0b7c371e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbda4df2bea2dc0e5667d92eae2e8013"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#acbda4df2bea2dc0e5667d92eae2e8013">calcNOON</a> (<a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">CheMPS2::DMRGSCFindices</a> *localIdx, double *eigenvecs, double *workmem, double *localDMRG1DM)</td></tr>
<tr class="memdesc:acbda4df2bea2dc0e5667d92eae2e8013"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the natural orbitals and their occupation numbers.  <a href="#acbda4df2bea2dc0e5667d92eae2e8013">More...</a><br/></td></tr>
<tr class="separator:acbda4df2bea2dc0e5667d92eae2e8013"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3b59817dede9833446eb513b12284db"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#ad3b59817dede9833446eb513b12284db">rotate2DMand1DM</a> (const int nDMRGelectrons, int totOrbDMRG, double *eigenvecs, double *work, double *localDMRG1DM, double *localDMRG2DM)</td></tr>
<tr class="memdesc:ad3b59817dede9833446eb513b12284db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> 1-RDM and 2-RDM to a new basis (to calculate the gradient and Hessian)  <a href="#ad3b59817dede9833446eb513b12284db">More...</a><br/></td></tr>
<tr class="separator:ad3b59817dede9833446eb513b12284db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a258f11f16c7790c6943589633203c7e3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a258f11f16c7790c6943589633203c7e3">fillLocalizedOrbitalRotations</a> (<a class="el" href="classCheMPS2_1_1DMRGSCFunitary.html">CheMPS2::DMRGSCFunitary</a> *unitary, <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">CheMPS2::DMRGSCFindices</a> *localIdx, double *eigenvecs)</td></tr>
<tr class="memdesc:a258f11f16c7790c6943589633203c7e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">From an Edmiston-Ruedenberg active space rotation, fetch the eigenvectors and store them in eigenvecs.  <a href="#a258f11f16c7790c6943589633203c7e3">More...</a><br/></td></tr>
<tr class="separator:a258f11f16c7790c6943589633203c7e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> class. </p>
<dl class="section author"><dt>Author</dt><dd>Sebastian Wouters <a href="#" onclick="location.href='mai'+'lto:'+'seb'+'as'+'tia'+'nw'+'out'+'er'+'s@g'+'ma'+'il.'+'co'+'m'; return false;">sebas<span style="display: none;">.nosp@m.</span>tian<span style="display: none;">.nosp@m.</span>woute<span style="display: none;">.nosp@m.</span>rs@g<span style="display: none;">.nosp@m.</span>mail.<span style="display: none;">.nosp@m.</span>com</a> </dd></dl>
<dl class="section date"><dt>Date</dt><dd>June 18, 2013</dd></dl>
<h1><a class="anchor" id="intro"></a>
Introduction</h1>
<p>In methods which use a <a class="el" href="classCheMPS2_1_1FCI.html">FCI</a> solver, this solver can be replaced by <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a>. <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> allows for an efficient extraction of the 2-RDM [CAS1, CAS2]. The 2-RDM of the active space is required in the complete active space self-consistent field (<a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a>) method to compute the gradient and the Hessian with respect to orbital rotations [CAS3]. It is therefore natural to introduce a <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> variant with <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> as active space solver, called DMRG-SCF [CAS2, CAS4, CAS5], which allows to treat static correlation in large active spaces. In CheMPS2, I have implemented the augmented Hessian Newton-Raphson DMRG-SCF method, with exact Hessian [CAS5, CAS6]. It can be called with the function <a class="el" href="classCheMPS2_1_1CASSCF.html#a2ab912e50eb821fed2089e88692ec0b1" title="Does the state-specific CASSCF cycle with the augmented Hessian Newton-Raphson method. ">CheMPS2::CASSCF::doCASSCFnewtonraphson</a>.</p>
<h1><a class="anchor" id="equations_2step_dmrgscf"></a>
Orbital gradient and Hessian</h1>
<p>The calculation of the orbital gradient and Hessian for DMRG-SCF is based on [CAS3]. The basic idea is to express the energy with the unitary group generators: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \hat{E}_{pq} &amp; = &amp; \sum\limits_{\sigma} \hat{a}^{\dagger}_{p \sigma} \hat{a}_{q \sigma} \\ \left[ \hat{E}_{pq} , \hat{E}_{rs} \right] &amp; = &amp; \delta_{qr} \hat{E}_{ps} - \delta_{ps} \hat{E}_{rq} \\ \hat{E}^{-}_{pq} &amp; = &amp; \hat{E}_{pq} - \hat{E}_{qp} \\ \hat{T} &amp; = &amp; \sum\limits_{p<q} x_{pq} \hat{E}^{-}_{pq} \\ E(\vec{x}) &amp; = &amp; \braket{0 | e^{\hat{T}} \hat{H} e^{-\hat{T}} | 0 } \\ \left. \frac{\partial E(\vec{x})}{\partial x_{ij}} \right|_{0} &amp; = &amp; \braket{ 0 | \left[ \hat{E}_{ij}^{-}, \hat{H} \right] | 0 } \\ \left. \frac{\partial^2 E(\vec{x})}{\partial x_{ij} \partial x_{kl}} \right|_{0} &amp; = &amp; \frac{1}{2} \braket{ 0 | \left[ \hat{E}_{ij}^{-}, \left[ \hat{E}_{kl}^{-}, \hat{H} \right] \right] | 0 } + \frac{1}{2} \braket{ 0 | \left[ \hat{E}_{kl}^{-}, \left[ \hat{E}_{ij}^{-}, \hat{H} \right] \right] | 0 } \end{eqnarray*}" src="form_0.png"/>
</p>
<p> The variables <img class="formulaInl" alt="$x_{pq}$" src="form_1.png"/> only connect orbitals with the same irrep ( <img class="formulaInl" alt="$I_p=I_q$" src="form_2.png"/>). Assuming that <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> is exact, <img class="formulaInl" alt="$x_{pq}$" src="form_1.png"/> in addition only connects orbitals when they belong to different occupation blocks: occupied, active, virtual. With some algebra, the derivatives can be rewritten. Real-valued symmetric one-electron integrals <img class="formulaInl" alt="$h_{ij}$" src="form_3.png"/> and real-valued eightfold permutation symmetric two-electron integrals <img class="formulaInl" alt="$(ij | kl)$" src="form_4.png"/> are assumed (chemical notation for the latter). </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \Gamma^{2A}_{ijkl} &amp; = &amp; \sum\limits_{\sigma \tau} \braket{ 0 | \hat{a}^{\dagger}_{i \sigma} \hat{a}_{j \tau}^{\dagger} \hat{a}_{l \tau} \hat{a}_{k \sigma} | 0} \\ \Gamma^1_{ij} &amp; = &amp; \sum\limits_{\sigma} \braket{ 0 | \hat{a}^{\dagger}_{i \sigma} \hat{a}_{j \sigma} | 0} \\ \left. \frac{\partial E(\vec{x})}{\partial x_{ij}} \right|_{0} &amp; = &amp; 2 \left( F_{ij} - F_{ji} \right) \\ F_{pq} &amp; = &amp; \sum\limits_{r} \Gamma_{pr}^{1} h_{qr} + \sum\limits_{rst} \Gamma^{2A}_{psrt} (qr | st) \\ \left. \frac{\partial^2 E(\vec{x})}{\partial x_{ij} \partial x_{kl}} \right|_{0} &amp; = &amp; w_{ijkl} - w_{jikl} - w_{ijlk} + w_{jilk} \\ w_{pqrs} &amp; = &amp; \delta_{qr} \left( F_{ps} + F_{sp} \right) + \tilde{w}_{pqrs} \\ \tilde{w}_{pqrs} &amp; = &amp; 2 \Gamma^1_{pr} h_{qs} + 2 \sum\limits_{\alpha \beta} \left( \Gamma^{2A}_{r \alpha p \beta} (qs | \alpha \beta ) + \left( \Gamma^{2A}_{r \alpha \beta p} + \Gamma^{2A}_{r p \beta \alpha} \right) (q \alpha | s \beta ) \right) \end{eqnarray*}" src="form_5.png"/>
</p>
<p> In the calculation of <img class="formulaInl" alt="$F_{pq}$" src="form_6.png"/>, the indices <img class="formulaInl" alt="$prst$" src="form_7.png"/> can only be occupied or active due to their appearance in the density matrices, and the only index which can be virtual is hence <img class="formulaInl" alt="$q$" src="form_8.png"/>. Moreover, due to the irrep symmetry of the integrals and density matrices, <img class="formulaInl" alt="$F_{pq}$" src="form_6.png"/> is diagonal in the irreps: <img class="formulaInl" alt="$I_p = I_q$" src="form_9.png"/>. Alternatively, this can be understood by the fact that <img class="formulaInl" alt="$x_{pq}$" src="form_1.png"/> only connects orbitals with the same irrep.</p>
<p>In the calculation of <img class="formulaInl" alt="$\tilde{w}_{pqrs}$" src="form_10.png"/>, the indices <img class="formulaInl" alt="$pr\alpha\beta$" src="form_11.png"/> can only be occupied or active due to their appearance in the density matrices, and the only indices which can be virtual are hence <img class="formulaInl" alt="$qs$" src="form_12.png"/>. Together with the remark for <img class="formulaInl" alt="$F_{pq}$" src="form_6.png"/>, this can save time for the two-electron integral rotation. Moreover, as <img class="formulaInl" alt="$x_{pq}$" src="form_1.png"/> only connects orbitals with the same irrep, <img class="formulaInl" alt="$I_p = I_q$" src="form_9.png"/> and <img class="formulaInl" alt="$I_r = I_s$" src="form_13.png"/> in <img class="formulaInl" alt="$\tilde{w}_{pqrs}$" src="form_10.png"/>.</p>
<p>By rewriting the density matrices, the calculation of <img class="formulaInl" alt="$F_{pq}$" src="form_6.png"/> and <img class="formulaInl" alt="$\tilde{w}_{pqrs}$" src="form_10.png"/> can be simplified. In the following, occ and act denote the doubly occupied and active orbital spaces, respectively. </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \Gamma^1_{ij} &amp; = &amp; 2 \delta_{ij}^{occ} + \Gamma^{1,act}_{ij} \\ \Gamma^{2A}_{ijkl} &amp; = &amp; \Gamma^{2A,act}_{ijkl} + 2 \delta_{ik}^{occ} \Gamma^{1,act}_{jl} - \delta_{il}^{occ} \Gamma^{1,act}_{jk} \\ &amp; + &amp; 2 \delta_{jl}^{occ} \Gamma^{1,act}_{ik} - \delta_{jk}^{occ} \Gamma^{1,act}_{il} + 4 \delta_{ik}^{occ} \delta_{jl}^{occ} - 2 \delta_{il}^{occ} \delta_{jk}^{occ} \end{eqnarray*}" src="form_14.png"/>
</p>
<p> Define the following symmetric charge (Coulomb + exchange) matrices: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} Q^{occ}_{ij} &amp; = &amp; \sum\limits_{s \in occ} \left[ 2 (ij | ss) - (is | js ) \right] \\ Q^{act}_{ij} &amp; = &amp; \sum\limits_{st \in act} \frac{1}{2} \Gamma^{1,act}_{st} \left[ 2 (ij | st) - (is | jt ) \right] \end{eqnarray*}" src="form_15.png"/>
</p>
<p> They can be calculated efficiently by (1) rotating the occupied and active density matrices from the current basis to the original basis, (2) contracting the rotated density matrices with the two-electron integrals in the original basis, and (3) rotating these contractions to the current basis. The constant part and the one-electron integrals of the active space <a class="el" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a> are: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \tilde{E}_{const} &amp; = &amp; E_{const} + \sum\limits_{s \in occ} \left( 2 h_{ss} + Q_{ss}^{occ} \right) \\ \tilde{h}_{ij} &amp; = &amp; h_{ij} + Q_{ij}^{occ} \end{eqnarray*}" src="form_16.png"/>
</p>
<p> The calculation of <img class="formulaInl" alt="$F_{pq}$" src="form_6.png"/> boils down to: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} p \in occ &amp; : &amp; F_{pq} = 2 \left( h_{qp} + Q^{occ}_{qp} + Q^{act}_{qp} \right) \\ p \in act &amp; : &amp; F_{pq} = \sum\limits_{r \in act} \Gamma^{1,act}_{pr} \left[ h_{qr} + Q^{occ}_{qr} \right] + \sum\limits_{rst \in act} \Gamma^{2A,act}_{psrt} (qr | st) \end{eqnarray*}" src="form_17.png"/>
</p>
<p> And the calculation of <img class="formulaInl" alt="$\tilde{w}_{pqrs}$" src="form_10.png"/> (remember that <img class="formulaInl" alt="$I_p = I_q$" src="form_9.png"/> and <img class="formulaInl" alt="$I_r = I_s$" src="form_13.png"/>): </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} (p,r) &amp; \in &amp; (occ,occ) : \tilde{w}_{pqrs} \\ &amp; = &amp; 4 \delta_{pr}^{occ} \left[ h_{qs} + Q^{occ}_{qs} + Q^{act}_{qs} \right] \\ &amp; + &amp; 4 \left[ 4 (qp | sr) - ( qs | pr ) - ( qr | sp ) \right] \\ (p,r) &amp; \in &amp; (act,act) : \tilde{w}_{pqrs} = 2 \Gamma^{1,act}_{rp} \left[ h_{qs} + Q^{occ}_{qs} \right] \\ &amp; + &amp; 2 \sum\limits_{\alpha\beta \in act} \left[ \Gamma^{2A,act}_{r \alpha p \beta} (qs | \alpha \beta ) + \left( \Gamma^{2A,act}_{r \alpha \beta p} + \Gamma^{2A,act}_{r p \beta \alpha} \right) (q \alpha | s \beta ) \right] \\ (p,r) &amp; \in &amp; (act,occ) : \tilde{w}_{pqrs} \\ &amp; = &amp; 2 \sum\limits_{\alpha \in act} \Gamma^{1,act}_{\alpha p} \left[ 4 (q \alpha | s r) - (qs | \alpha r) - (qr | s \alpha) \right] \\ (p,r) &amp; \in &amp; (occ,act) : \tilde{w}_{pqrs} \\ &amp; = &amp; 2 \sum\limits_{\beta \in act} \Gamma^{1,act}_{r \beta} \left[ 4 (q p | s \beta) - (qs | p \beta) - (q \beta | sp) \right] \end{eqnarray*}" src="form_18.png"/>
</p>
<h1><a class="anchor" id="origalgo"></a>
Augmented Hessian Newton-Raphson DMRG-SCF</h1>
<p>The <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> energy is a function of <img class="formulaInl" alt="$\vec{x}$" src="form_19.png"/>. Up to second order, the energy is given by </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ E(\vec{x}) = \braket{0 | e^{\hat{T}(\vec{x})} \hat{H} e^{-\hat{T}(\vec{x})} | 0 } \approx E(0) + \vec{x}^T \vec{g} + \frac{1}{2} \vec{x}^T \mathbf{H} \vec{x}. \]" src="form_20.png"/>
</p>
<p> The vector <img class="formulaInl" alt="$\vec{g}$" src="form_21.png"/> is the gradient and the matrix <img class="formulaInl" alt="$\mathbf{H}$" src="form_22.png"/> the Hessian for orbital rotations [CAS3]. They have been described in the previous section. The minimum of <img class="formulaInl" alt="$E(\vec{x})$" src="form_23.png"/> is found at <img class="formulaInl" alt="$\vec{x} = - \mathbf{H}^{-1} \vec{g}$" src="form_24.png"/>. The variables <img class="formulaInl" alt="$\vec{x}$" src="form_19.png"/> parametrize an additional orbital rotation <img class="formulaInl" alt="$\mathbf{U}_{add} = \exp(\mathbf{X}(\vec{x}))$" src="form_25.png"/>, with <img class="formulaInl" alt="$\mathbf{X}(\vec{x}) = -\mathbf{X}^T(\vec{x})$" src="form_26.png"/> a real-valued skew-symmetric matrix. The additional orbital rotation <img class="formulaInl" alt="$\mathbf{U}_{add}$" src="form_27.png"/> transforms the current orbitals <img class="formulaInl" alt="$\mathbf{U}(n)$" src="form_28.png"/> to the new orbitals </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathbf{U}(n+1) = \mathbf{U}_{add} \mathbf{U}(n) = \exp(\mathbf{X}(\vec{x}(n))) \mathbf{U}(n). \]" src="form_29.png"/>
</p>
<p> This updating scheme is called the Newton-Raphson method [CAS3]. If the Hessian is positive definite, these updates are stable. For saddle points in the energy landscape, the Hessian has negative eigenvalues, and these updates can be unstable. It is therefore better to use the augmented Hessian Newton-Raphson method [CAS7]: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left[ \begin{array}{cc} \mathbf{H} &amp; \vec{g} \\ \vec{g}^T &amp; 0 \end{array} \right] \left[ \begin{array}{c} \vec{x} \\ 1 \end{array} \right] = \alpha \left[ \begin{array}{c} \vec{x} \\ 1 \end{array} \right]. \]" src="form_30.png"/>
</p>
<p> The eigenvector with smallest algebraic eigenvalue determines a stable update <img class="formulaInl" alt="$\vec{x}$" src="form_19.png"/>, as is well explained in Ref. [CAS7].</p>
<p>As a final remark in this section, I would like to say that orbitals have gauge freedom. One can always multiply them with a phase factor. It is therefore possible to choose the orbital gauges so that all <img class="formulaInl" alt="$\mathbf{U}$" src="form_31.png"/> are always special orthogonal: <img class="formulaInl" alt="$\det(\mathbf{U})=+1$" src="form_32.png"/>.</p>
<h1><a class="anchor" id="diis"></a>
Direct inversion of the iterative subspace (DIIS)</h1>
<p>When the update norm <img class="formulaInl" alt="$\|\vec{x}\|_2$" src="form_33.png"/> is small enough, the convergence can be accelerated by the direct inversion of the iterative subspace (<a class="el" href="classCheMPS2_1_1DIIS.html">DIIS</a>) [CAS5, CAS8, CAS9, CAS10]. For a given set of orbitals <img class="formulaInl" alt="$\mathbf{U}(n)$" src="form_28.png"/>, the update <img class="formulaInl" alt="$\vec{x}(n)$" src="form_34.png"/> is calculated with the augmented Hessian Newton-Raphson method. This update defines the next set of orbitals: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathbf{U}(n+1) = \mathbf{U}_{add} \mathbf{U}(n) = \exp(\mathbf{X}(\vec{x}(n))) \mathbf{U}(n). \]" src="form_29.png"/>
</p>
<p> In <a class="el" href="classCheMPS2_1_1DIIS.html">DIIS</a>, the error vector <img class="formulaInl" alt="$\vec{x}(n)$" src="form_34.png"/> and the state vector <img class="formulaInl" alt="$\mathbf{Y}(n+1) = \log(\mathbf{U}(n+1))$" src="form_35.png"/> are added to a list. The error </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ e = \left\| \sum\limits_{i = 1}^{\kappa} c_i \vec{x}(n - \kappa + i) \right\|_2 \]" src="form_36.png"/>
</p>
<p> is minimized under the constraint <img class="formulaInl" alt="$\sum_{i} c_i = 1$" src="form_37.png"/>. <img class="formulaInl" alt="$\kappa$" src="form_38.png"/> is the size of the list memory, i.e. the number of retained vectors. The minimization of the error <img class="formulaInl" alt="$e$" src="form_39.png"/> can be performed with Lagrangian calculus: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left[ \begin{array}{cc} \mathbf{B} &amp; \vec{1} \\ \vec{1}^T &amp; 0 \end{array} \right] \left[ \begin{array}{c} \vec{c} \\ \lambda \end{array} \right] = \left[ \begin{array}{c} \vec{0} \\ 1 \end{array} \right], \]" src="form_40.png"/>
</p>
<p> where <img class="formulaInl" alt="$2\lambda$" src="form_41.png"/> is the Lagrangian multiplier and </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left[\mathbf{B}\right]_{ij} = \vec{x}^T(n - \kappa + i) \vec{x}(n - \kappa + j) = \left[\mathbf{B}\right]_{ji}. \]" src="form_42.png"/>
</p>
<p> The new state vector is then defined as </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathbf{Y}_{new} = \sum\limits_{i = 1}^{\kappa} c_i \mathbf{Y}(n+1 - \kappa + i). \]" src="form_43.png"/>
</p>
<p> The new state vector <img class="formulaInl" alt="$\mathbf{Y}_{new}$" src="form_44.png"/> is calculated by the function <a class="el" href="classCheMPS2_1_1DIIS.html#ad8f60dd3e52d1d8a59c155c25a7ce3f3" title="Calculate the new parameter vector, based on the just appended error and parameter vectors...">CheMPS2::DIIS::calculateParam</a>. The current orbitals are then set to <img class="formulaInl" alt="$\mathbf{U}(n+1) = \exp(\mathbf{Y}_{new})$" src="form_45.png"/>.</p>
<h1><a class="anchor" id="biblio"></a>
References</h1>
<p>[CAS1] D. Zgid and M. Nooijen, Journal of Chemical Physics 128, 144115 (2008). <a href="http://dx.doi.org/10.1063/1.2883980">http://dx.doi.org/10.1063/1.2883980</a> <br/>
[CAS2] D. Ghosh, J. Hachmann, T. Yanai and G.K.-L. Chan, Journal of Chemical Physics 128, 144117 (2008). <a href="http://dx.doi.org/10.1063/1.2883976">http://dx.doi.org/10.1063/1.2883976</a> <br/>
[CAS3] P.E.M. Siegbahn, J. Almlof, A. Heiberg and B.O. Roos, Journal of Chemical Physics 74, 2384-2396 (1981). <a href="http://dx.doi.org/10.1063/1.441359">http://dx.doi.org/10.1063/1.441359</a> <br/>
[CAS4] D. Zgid and M. Nooijen, Journal of Chemical Physics 128, 144116 (2008). <a href="http://dx.doi.org/10.1063/1.2883981">http://dx.doi.org/10.1063/1.2883981</a> <br/>
[CAS5] T. Yanai, Y. Kurashige, D. Ghosh and G.K.-L. Chan, International Journal of Quantum Chemistry 109, 2178-2190 (2009). <a href="http://dx.doi.org/10.1002/qua.22099">http://dx.doi.org/10.1002/qua.22099</a> <br/>
[CAS6] S. Wouters, W. Poelmans, P.W. Ayers and D. Van Neck, Computer Physics Communications 185, 1501-1514 (2014). <a href="http://dx.doi.org/10.1016/j.cpc.2014.01.019">http://dx.doi.org/10.1016/j.cpc.2014.01.019</a> <br/>
[CAS7] A. Banerjee, N. Adams, J. Simons and R. Shepard, Journal of Physical Chemistry 89, 52-57 (1985). <a href="http://dx.doi.org/10.1021/j100247a015">http://dx.doi.org/10.1021/j100247a015</a> <br/>
[CAS8] P. Pulay, Chemical Physics Letters 73, 393-398 (1980). <a href="http://dx.doi.org/10.1016/0009-2614(80)80396-4">http://dx.doi.org/10.1016/0009-2614(80)80396-4</a> <br/>
[CAS9] C.D. Sherrill, Programming <a class="el" href="classCheMPS2_1_1DIIS.html">DIIS</a>, <a href="http://vergil.chemistry.gatech.edu/notes/diis/node3.html">http://vergil.chemistry.gatech.edu/notes/diis/node3.html</a> (2000). <br/>
[CAS10] T. Rohwedder and R. Schneider, Journal of Mathematical Chemistry 49, 1889-1914 (2011). <a href="http://dx.doi.org/10.1007/s10910-011-9863-y">http://dx.doi.org/10.1007/s10910-011-9863-y</a> <br/>
</p>

<p>Definition at line <a class="el" href="CASSCF_8h_source.html#l00162">162</a> of file <a class="el" href="CASSCF_8h_source.html">CASSCF.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aee2071ba5914ed3a6e7120e6d1656144"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CheMPS2::CASSCF::CASSCF </td>
          <td>(</td>
          <td class="paramtype">const string&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>The file containing the Psi4 <a class="el" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a> text dump (mointegrals.so_PRINT) output to start the DMRGSCF calculations. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00034">34</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_aee2071ba5914ed3a6e7120e6d1656144_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_aee2071ba5914ed3a6e7120e6d1656144_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_aee2071ba5914ed3a6e7120e6d1656144_cgraph" id="classCheMPS2_1_1CASSCF_aee2071ba5914ed3a6e7120e6d1656144_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1Hamiltonian.html#a101963cfa8f06abe798a7ae79faab618" title="Get the number of orbitals. " alt="" coords="279,5,438,46"/><area shape="rect" id="node3" href="classCheMPS2_1_1Irreps.html#aca6fdd79557f9189153258daad5fbe8c" title="Set the group. " alt="" coords="267,71,451,97"/><area shape="rect" id="node4" href="classCheMPS2_1_1Hamiltonian.html#a8c18f51ded63810e316f1834853dce21" title="Get the group number. " alt="" coords="279,122,438,163"/><area shape="rect" id="node5" href="classCheMPS2_1_1Irreps.html#afd3d1b65e870aad920125c05606c4a7d" title="Get the number of irreps for the currently activated group. " alt="" coords="261,187,456,229"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9c0aeea016f892a6b4a72cee8a37bd96"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CheMPS2::CASSCF::CASSCF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a> *&#160;</td>
          <td class="paramname"><em>HamIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>DOCCin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>SOCCin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">HamIn</td><td><a class="el" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a> containing the matrix elements of the <a class="el" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a> for which a <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> calculation is desired </td></tr>
    <tr><td class="paramname">DOCCin</td><td>Array containing the number of doubly occupied HF orbitals per irrep </td></tr>
    <tr><td class="paramname">SOCCin</td><td>Array containing the number of singly occupied HF orbitals per irrep </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00048">48</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a9c0aeea016f892a6b4a72cee8a37bd96_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a9c0aeea016f892a6b4a72cee8a37bd96_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a9c0aeea016f892a6b4a72cee8a37bd96_cgraph" id="classCheMPS2_1_1CASSCF_a9c0aeea016f892a6b4a72cee8a37bd96_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1Hamiltonian.html#a101963cfa8f06abe798a7ae79faab618" title="Get the number of orbitals. " alt="" coords="262,5,421,46"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="abf34a3243a38979439e7aa2d9e60c4dd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::augmentedHessianNR </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localFmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFwtilde.html">DMRGSCFwtilde</a> *&#160;</td>
          <td class="paramname"><em>localwtilde</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>localIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFunitary.html">DMRGSCFunitary</a> *&#160;</td>
          <td class="paramname"><em>localUmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>theupdate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>updateNorm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>gradNorm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the augmented Hessian Newton-Raphson update for the orthogonal orbital rotation matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">localFmat</td><td>Matrix which contains the Fock operator (Eq. (11) in the Siegbahn paper [CAS3]) </td></tr>
    <tr><td class="paramname">localwtilde</td><td>Object which contains the second order derivative of the energy with respect to the unitary (Eq. (20b) in the Siegbahn paper [CAS3]) </td></tr>
    <tr><td class="paramname">localIdx</td><td>Orbital index bookkeeper for the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> calculations </td></tr>
    <tr><td class="paramname">localUmat</td><td>The unitary matrix for <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> calculations (in this function it is used to fetch the orbital ordering convention of the skew-symmetric parametrization) </td></tr>
    <tr><td class="paramname">theupdate</td><td>Where the augmented Hessian Newton-Raphson update will be stored </td></tr>
    <tr><td class="paramname">updateNorm</td><td>Pointer to one double to store the update norm </td></tr>
    <tr><td class="paramname">gradNorm</td><td>Pointer to one double to store the gradient norm </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCFnewtonraphson_8cpp_source.html#l00233">233</a> of file <a class="el" href="CASSCFnewtonraphson_8cpp_source.html">CASSCFnewtonraphson.cpp</a>.</p>

<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_abf34a3243a38979439e7aa2d9e60c4dd_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_abf34a3243a38979439e7aa2d9e60c4dd_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_abf34a3243a38979439e7aa2d9e60c4dd_cgraph" id="classCheMPS2_1_1CASSCF_abf34a3243a38979439e7aa2d9e60c4dd_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFunitary.html#a725cdfa70964b24914436fc40bba90b4" title="Get the number of variables in the x&#45;parametrization of the unitary update. " alt="" coords="272,5,469,46"/><area shape="rect" id="node3" href="classCheMPS2_1_1Davidson.html#a2ae39a55a30271ae6f5d46b52df3d991" title="The iterator to converge the ground state vector. " alt="" coords="294,70,447,111"/><area shape="rect" id="node4" href="classCheMPS2_1_1Davidson.html#a0a9f07122a47a4ec24e6add4b8b30797" title="Get the number of matrix vector multiplications which have been performed. " alt="" coords="293,135,448,177"/></map>
</div>
</p>

<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_abf34a3243a38979439e7aa2d9e60c4dd_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_abf34a3243a38979439e7aa2d9e60c4dd_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_abf34a3243a38979439e7aa2d9e60c4dd_icgraph" id="classCheMPS2_1_1CASSCF_abf34a3243a38979439e7aa2d9e60c4dd_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#a2ab912e50eb821fed2089e88692ec0b1" title="Does the state&#45;specific CASSCF cycle with the augmented Hessian Newton&#45;Raphson method. " alt="" coords="273,12,583,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0210ff118bab44593aef7c6ec9f31a56"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::buildFmat </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localFmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localTmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localJKocc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localJKact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>localIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFintegrals.html">DMRGSCFintegrals</a> *&#160;</td>
          <td class="paramname"><em>theInts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>local2DM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>local1DM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build the F-matrix (Eq. (11) in the Siegbahn paper [CAS3]) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">localFmat</td><td>Matrix where the result should be stored </td></tr>
    <tr><td class="paramname">localTmat</td><td>Matrix which contains the one-electron integrals </td></tr>
    <tr><td class="paramname">localJKocc</td><td>Matrix which contains the Coulomb and exchange interaction due to the frozen core orbitals </td></tr>
    <tr><td class="paramname">localJKact</td><td>Matrix which contains the Coulomb and exchange interaction due to the active space </td></tr>
    <tr><td class="paramname">localIdx</td><td>Orbital index bookkeeper for the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> calculations </td></tr>
    <tr><td class="paramname">theInts</td><td>The rotated two-electron integrals (at most 2 virtual indices) </td></tr>
    <tr><td class="paramname">local2DM</td><td>The <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 2-RDM </td></tr>
    <tr><td class="paramname">local1DM</td><td>The <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 1-RDM </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCFnewtonraphson_8cpp_source.html#l00591">591</a> of file <a class="el" href="CASSCFnewtonraphson_8cpp_source.html">CASSCFnewtonraphson.cpp</a>.</p>

<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_cgraph" id="classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFmatrix.html#a0729b05fef0cb96eaf26e7c8d6017931" title="Clear the matrix. " alt="" coords="277,5,472,46"/><area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="275,70,474,111"/><area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="275,135,474,177"/><area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="275,201,474,242"/><area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="275,266,474,307"/><area shape="rect" id="node7" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="275,331,474,373"/><area shape="rect" id="node8" href="classCheMPS2_1_1DMRGSCFmatrix.html#a3660ff17cbeb278c265b6461450b1a24" title="Set an element. " alt="" coords="265,397,485,424"/><area shape="rect" id="node9" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9" title="Get an element. " alt="" coords="265,448,485,475"/><area shape="rect" id="node10" href="classCheMPS2_1_1DMRGSCFmatrix.html#a230d9fa54109d0754a054868611177c5" title="Get a matrix block. " alt="" coords="277,499,472,541"/><area shape="rect" id="node11" href="classCheMPS2_1_1Irreps.html#a1d86c7a8b3c3a7b9215c0e298f0ae047" title="Get the direct product of the irreps with numbers Irrep1 and Irrep2: a bitwise XOR for psi4&#39;s convent..." alt="" coords="534,595,725,621"/><area shape="rect" id="node12" href="classCheMPS2_1_1DMRGSCFintegrals.html#ad462dfa92d77f1f02371f12e91cac429" title="Get a two&#45;body matrix element with at most 2 virtual indices, using the FourIndex API..." alt="" coords="271,617,478,658"/></map>
</div>
</p>

<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_icgraph" id="classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#a2ab912e50eb821fed2089e88692ec0b1" title="Does the state&#45;specific CASSCF cycle with the augmented Hessian Newton&#45;Raphson method. " alt="" coords="265,5,575,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a21471f166b873029b5e51dda4a6907c4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::buildWtilde </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFwtilde.html">DMRGSCFwtilde</a> *&#160;</td>
          <td class="paramname"><em>localwtilde</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localTmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localJKocc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localJKact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>localIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFintegrals.html">DMRGSCFintegrals</a> *&#160;</td>
          <td class="paramname"><em>theInts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>local2DM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>local1DM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build the Wtilde-matrix (Eq. (20b) in the Siegbahn paper [CAS3]) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">localwtilde</td><td>Where the result should be stored </td></tr>
    <tr><td class="paramname">localTmat</td><td>Matrix which contains the one-electron integrals </td></tr>
    <tr><td class="paramname">localJKocc</td><td>Matrix which contains the Coulomb and exchange interaction due to the frozen core orbitals </td></tr>
    <tr><td class="paramname">localJKact</td><td>Matrix which contains the Coulomb and exchange interaction due to the active space </td></tr>
    <tr><td class="paramname">localIdx</td><td>Orbital index bookkeeper for the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> calculations </td></tr>
    <tr><td class="paramname">theInts</td><td>The rotated two-electron integrals (at most 2 virtual indices) </td></tr>
    <tr><td class="paramname">local2DM</td><td>The <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 2-RDM </td></tr>
    <tr><td class="paramname">local1DM</td><td>The <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 1-RDM </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCFnewtonraphson_8cpp_source.html#l00379">379</a> of file <a class="el" href="CASSCFnewtonraphson_8cpp_source.html">CASSCFnewtonraphson.cpp</a>.</p>

<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_cgraph" id="classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFwtilde.html#a939e077b9fcc8ffafd9a168056991795" title="Clear. " alt="" coords="287,5,479,46"/><area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="283,70,482,111"/><area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="283,135,482,177"/><area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="283,201,482,242"/><area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="283,266,482,307"/><area shape="rect" id="node7" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="283,331,482,373"/><area shape="rect" id="node8" href="classCheMPS2_1_1DMRGSCFwtilde.html#a1315dead44fb4c153c1e93758f048378" title="Get the (pr) subblock of w_tilde_pqrs, which is stored as w_tilde[ I_pq ][ I_rs ][ p + ( Nocc[I_pq] +..." alt="" coords="287,397,479,438"/><area shape="rect" id="node9" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9" title="Get an element. " alt="" coords="273,463,493,489"/><area shape="rect" id="node10" href="classCheMPS2_1_1Irreps.html#a1d86c7a8b3c3a7b9215c0e298f0ae047" title="Get the direct product of the irreps with numbers Irrep1 and Irrep2: a bitwise XOR for psi4&#39;s convent..." alt="" coords="542,543,733,569"/><area shape="rect" id="node11" href="classCheMPS2_1_1DMRGSCFintegrals.html#ad462dfa92d77f1f02371f12e91cac429" title="Get a two&#45;body matrix element with at most 2 virtual indices, using the FourIndex API..." alt="" coords="279,565,486,606"/></map>
</div>
</p>

<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_icgraph" id="classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#a2ab912e50eb821fed2089e88692ec0b1" title="Does the state&#45;specific CASSCF cycle with the augmented Hessian Newton&#45;Raphson method. " alt="" coords="273,5,583,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acbda4df2bea2dc0e5667d92eae2e8013"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::calcNOON </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">CheMPS2::DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>localIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>eigenvecs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>workmem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>localDMRG1DM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the natural orbitals and their occupation numbers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">localIdx</td><td>Object which handles the index conventions for <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> </td></tr>
    <tr><td class="paramname">eigenvecs</td><td>Where to store the natural orbitals </td></tr>
    <tr><td class="paramname">workmem</td><td>Work memory </td></tr>
    <tr><td class="paramname">localDMRG1DM</td><td>The <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> 1-RDM </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00153">153</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_acbda4df2bea2dc0e5667d92eae2e8013_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_acbda4df2bea2dc0e5667d92eae2e8013_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_acbda4df2bea2dc0e5667d92eae2e8013_cgraph" id="classCheMPS2_1_1CASSCF_acbda4df2bea2dc0e5667d92eae2e8013_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="273,5,471,46"/><area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="273,70,471,111"/><area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="273,135,471,177"/></map>
</div>
</p>

<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_acbda4df2bea2dc0e5667d92eae2e8013_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_acbda4df2bea2dc0e5667d92eae2e8013_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_acbda4df2bea2dc0e5667d92eae2e8013_icgraph" id="classCheMPS2_1_1CASSCF_acbda4df2bea2dc0e5667d92eae2e8013_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#a2ab912e50eb821fed2089e88692ec0b1" title="Does the state&#45;specific CASSCF cycle with the augmented Hessian Newton&#45;Raphson method. " alt="" coords="273,5,583,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae8305d7f87c340f9001e497aaf7ba93f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::copy2DMover </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1TwoDM.html">TwoDM</a> *&#160;</td>
          <td class="paramname"><em>theDMRG2DM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>totOrbDMRG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>localDMRG2DM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy over the <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 2-RDM. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">theDMRG2DM</td><td>The 2-RDM from the <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> object </td></tr>
    <tr><td class="paramname">totOrbDMRG</td><td>The total number of <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> orbitals </td></tr>
    <tr><td class="paramname">localDMRG2DM</td><td>The <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> 2-RDM </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00094">94</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_ae8305d7f87c340f9001e497aaf7ba93f_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_ae8305d7f87c340f9001e497aaf7ba93f_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_ae8305d7f87c340f9001e497aaf7ba93f_cgraph" id="classCheMPS2_1_1CASSCF_ae8305d7f87c340f9001e497aaf7ba93f_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1TwoDM.html#a40c2181006aaf66b8dad2e545e3d8186" title="Get a 2DM_A term, using the HAM indices. " alt="" coords="289,5,543,32"/></map>
</div>
</p>

<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_ae8305d7f87c340f9001e497aaf7ba93f_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_ae8305d7f87c340f9001e497aaf7ba93f_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_ae8305d7f87c340f9001e497aaf7ba93f_icgraph" id="classCheMPS2_1_1CASSCF_ae8305d7f87c340f9001e497aaf7ba93f_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#a2ab912e50eb821fed2089e88692ec0b1" title="Does the state&#45;specific CASSCF cycle with the augmented Hessian Newton&#45;Raphson method. " alt="" coords="289,5,599,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2ab912e50eb821fed2089e88692ec0b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CheMPS2::CASSCF::doCASSCFnewtonraphson </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nelectrons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>TwoS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Irrep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1ConvergenceScheme.html">ConvergenceScheme</a> *&#160;</td>
          <td class="paramname"><em>OptScheme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rootNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFoptions.html">DMRGSCFoptions</a> *&#160;</td>
          <td class="paramname"><em>theDMRGSCFoptions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does the state-specific <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> cycle with the augmented Hessian Newton-Raphson method. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Nelectrons</td><td>Total number of electrons in the system: occupied HF orbitals + active space </td></tr>
    <tr><td class="paramname">TwoS</td><td>Twice the targeted spin </td></tr>
    <tr><td class="paramname">Irrep</td><td>Desired wave-function irrep </td></tr>
    <tr><td class="paramname">OptScheme</td><td>The optimization scheme to run the inner <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> loop </td></tr>
    <tr><td class="paramname">rootNum</td><td>Denotes the targeted state in state-specific <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a>; 1 means ground state, 2 first excited state etc. </td></tr>
    <tr><td class="paramname">theDMRGSCFoptions</td><td>Contains the DMRGSCF options </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The converged DMRGSCF energy </dd></dl>

<p>Definition at line <a class="el" href="CASSCFnewtonraphson_8cpp_source.html#l00040">40</a> of file <a class="el" href="CASSCFnewtonraphson_8cpp_source.html">CASSCFnewtonraphson.cpp</a>.</p>

<p><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a2ab912e50eb821fed2089e88692ec0b1_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a2ab912e50eb821fed2089e88692ec0b1_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a2ab912e50eb821fed2089e88692ec0b1_cgraph" id="classCheMPS2_1_1CASSCF_a2ab912e50eb821fed2089e88692ec0b1_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFunitary.html#a725cdfa70964b24914436fc40bba90b4" title="Get the number of variables in the x&#45;parametrization of the unitary update. " alt="" coords="693,5,891,46"/><area shape="rect" id="node3" href="classCheMPS2_1_1Irreps.html#a9813550797b0557cf22d2bca5f3e07b0" title="Get the group number. " alt="" coords="399,211,583,253"/><area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFindices.html#ae04eb205d9aa13edaae834e535c3396d" title="Get an array with the irreps of each DMRG orbital. " alt="" coords="391,277,590,318"/><area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="693,969,891,1010"/><area shape="rect" id="node6" href="classCheMPS2_1_1Problem.html#ace8f96e419792f829198e96b897da0a9" title="Reorder the orbitals, so that they form irrep blocks, with order of irreps Ag B1u B3u B2g B2u B3g B1g..." alt="" coords="365,2183,616,2209"/><area shape="rect" id="node7" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="693,1151,891,1193"/><area shape="rect" id="node8" href="classCheMPS2_1_1DMRGSCFoptions.html#a9f81d7a089fc4a239638d95d93c24099" title="Get which active space should be considered in the DMRG routine. " alt="" coords="391,2234,591,2275"/><area shape="rect" id="node9" href="classCheMPS2_1_1DMRGSCFoptions.html#acea3d3f5a5abf8a4bdd509fc13a1a275" title="Get whether the Orbital Rotation checkpoint should be stored to disk. " alt="" coords="391,2299,591,2341"/><area shape="rect" id="node10" href="classCheMPS2_1_1DMRGSCFoptions.html#a45fb0323c73651fb83f6856af5145e83" title="Get the Orbital Rotation checkpoint filename. " alt="" coords="391,2365,591,2406"/><area shape="rect" id="node11" href="classCheMPS2_1_1DMRGSCFunitary.html#a867a52da2ca19a581d9c8476fab61246" title="Load the unitary from disk. " alt="" coords="392,2430,589,2471"/><area shape="rect" id="node12" href="classCheMPS2_1_1DMRGSCFoptions.html#a208fba2b1dbb95bec171867d39917fc8" title="Get whether DIIS should be performed. " alt="" coords="391,2495,591,2537"/><area shape="rect" id="node13" href="classCheMPS2_1_1DMRGSCFoptions.html#a59cdddf8451651c980aa49957c2897b5" title="Get whether the DIIS checkpoint should be stored to disk. " alt="" coords="391,2561,591,2602"/><area shape="rect" id="node14" href="classCheMPS2_1_1DMRGSCFoptions.html#ae4f2901cf992d1a4100367f002af786c" title="Get the DIIS checkpoint filename. " alt="" coords="391,2626,591,2667"/><area shape="rect" id="node15" href="classCheMPS2_1_1DMRGSCFoptions.html#a57ed7e22a351ad6fc1621ff95106040a" title="Get the number of DIIS update vectors which should be kept. " alt="" coords="391,2691,591,2733"/><area shape="rect" id="node16" href="classCheMPS2_1_1DIIS.html#a9a18331523e2455812e808f83072f3d8" title="Load the DIIS object from disk. " alt="" coords="403,2757,579,2784"/><area shape="rect" id="node17" href="classCheMPS2_1_1DMRGSCFoptions.html#a55ce3e1a48b8d977e53db9874c8fd7c6" title="Get the threshold for DMRGSCF convergence. " alt="" coords="391,2809,591,2850"/><area shape="rect" id="node18" href="classCheMPS2_1_1DMRGSCFunitary.html#a0b7e14e83dd48b97dcd791509bddc630" title="Update the unitary transformation. " alt="" coords="693,449,891,490"/><area shape="rect" id="node19" href="classCheMPS2_1_1DMRGSCFunitary.html#a661342a71c1ee032e9c2bf0efaa8e799" title="Orbitals are defined up to a phase factor. Make sure that the logarithm of each block of the unitary ..." alt="" coords="392,2874,589,2915"/><area shape="rect" id="node20" href="classCheMPS2_1_1DMRGSCFunitary.html#a4fc1da7a1ee20da577495f0f0c6d5100" title="Obtain the logarithm of the unitary matrix. " alt="" coords="392,575,589,617"/><area shape="rect" id="node22" href="classCheMPS2_1_1DIIS.html#ae08b4931a1ed04490fecb06618d26432" title="Append a new error and parameter vector. " alt="" coords="393,2940,588,2967"/><area shape="rect" id="node23" href="classCheMPS2_1_1DIIS.html#ad8f60dd3e52d1d8a59c155c25a7ce3f3" title="Calculate the new parameter vector, based on the just appended error and parameter vectors..." alt="" coords="402,2991,579,3033"/><area shape="rect" id="node24" href="classCheMPS2_1_1DMRGSCFunitary.html#a11ad63632a4a368db38a383366847c06" title="Save the unitary to disk. " alt="" coords="392,3057,589,3098"/><area shape="rect" id="node25" href="classCheMPS2_1_1DIIS.html#aa7e7da7574b2936c681e6f652f14ae37" title="Save the DIIS object to disk. " alt="" coords="401,3123,581,3149"/><area shape="rect" id="node26" href="classCheMPS2_1_1DMRGSCFVmatRotations.html#a1d27c8247099602644c423e8dc4f073a" title="Fill the rotated two&#45;body matrix elements of HamDMRG, based on HamOrig and unitary. Cut the blocks into chunks with linear size maxBlockSize. " alt="" coords="368,693,613,734"/><area shape="rect" id="node30" href="classCheMPS2_1_1DMRGSCFVmatRotations.html#a1a3bd9b8094b6dc6a274c02bc8caf835" title="Fill the rotated two&#45;body matrix elements of HamDMRG, based on HamOrig and unitary. Do entire blocks at once. " alt="" coords="368,775,613,817"/><area shape="rect" id="node31" href="classCheMPS2_1_1EdmistonRuedenberg.html#af52e7bc01e8f31e9b605ec4130f0337c" title="Maximize the Edmiston&#45;Ruedenberg cost function. " alt="" coords="383,445,598,486"/><area shape="rect" id="node34" href="classCheMPS2_1_1DMRGSCFoptions.html#a874f361f6567bebf376a4d35095b4a98" title="Get whether the localization procedure should start from a random unitary. " alt="" coords="391,3174,591,3215"/><area shape="rect" id="node35" href="classCheMPS2_1_1EdmistonRuedenberg.html#ad73febba415f3bcbef367b587d5bcc0d" title="Permute the orbitals so that the bandwidth of the exchange matrix is (approximately) minimized (per i..." alt="" coords="383,510,598,551"/><area shape="rect" id="node36" href="classCheMPS2_1_1CASSCF.html#a258f11f16c7790c6943589633203c7e3" title="From an Edmiston&#45;Ruedenberg active space rotation, fetch the eigenvectors and store them in eigenvecs..." alt="" coords="380,1647,601,1689"/><area shape="rect" id="node40" href="classCheMPS2_1_1EdmistonRuedenberg.html#af02cbffdb428682c4d53cf6c862fdb02" title="Get the pointer to the unitary to use in DMRGSCF. " alt="" coords="383,3239,598,3281"/><area shape="rect" id="node41" href="classCheMPS2_1_1DMRGSCFunitary.html#a2fb26346f9c7a15af27b459f7d5b0d3b" title="Rotate the unitary matrix. " alt="" coords="392,3305,589,3346"/><area shape="rect" id="node42" href="classCheMPS2_1_1DMRG.html#acfb3123c72e3503f2d6c77dcf9eb141a" title="Push back current calculation and set everything up to calculate a (new) excitation. " alt="" coords="380,2132,601,2159"/><area shape="rect" id="node44" href="classCheMPS2_1_1DMRG.html#ab6d80dde8b71171ee969a6b7b86193d2" title="Solver. " alt="" coords="405,2081,577,2108"/><area shape="rect" id="node45" href="classCheMPS2_1_1DMRGSCFoptions.html#a82add836b4de5c8ef97dda33553f2c64" title="Get whether state&#45;averaging or state&#45;specific DMRGSCF should be performed. " alt="" coords="391,3370,591,3411"/><area shape="rect" id="node46" href="classCheMPS2_1_1DMRG.html#aea1ffffbf2e12b56d602e5b692dd3a79" title="Calculate the 2DM. Note that the DMRG class cannot be used for further updates anymore !!! ..." alt="" coords="385,2015,597,2057"/><area shape="rect" id="node77" href="classCheMPS2_1_1CASSCF.html#ae8305d7f87c340f9001e497aaf7ba93f" title="Copy over the DMRG 2&#45;RDM. " alt="" coords="373,3436,608,3463"/><area shape="rect" id="node79" href="classCheMPS2_1_1DMRG.html#a0b471ea7ea19f7a49e6e1412f443d5ac" title="Get the pointer to the 2DM. " alt="" coords="398,3487,583,3513"/><area shape="rect" id="node80" href="classCheMPS2_1_1DMRG.html#ab442cbc43e2e5d877660859578849133" title="Activate the necessary storage and machinery to handle excitations. " alt="" coords="365,3537,616,3564"/><area shape="rect" id="node81" href="classCheMPS2_1_1DMRGSCFoptions.html#acb3c7d12b054befbe92d704d6746f4be" title="Get whether the correlations and two&#45;orbital mutual information should be printed. " alt="" coords="391,3589,591,3630"/><area shape="rect" id="node82" href="classCheMPS2_1_1DMRG.html#a13008f80dbfd8312ef4aa3990cbbc436" title="Get the pointer to the Correlations. " alt="" coords="377,3655,604,3681"/><area shape="rect" id="node83" href="classCheMPS2_1_1Correlations.html#a9e99dc1d7c2d571e2743ff6b472c50f6" title="Print the correlation functions and two&#45;orbital mutual information. " alt="" coords="411,3706,571,3747"/><area shape="rect" id="node84" href="classCheMPS2_1_1DMRG.html#a0f4e487c40f522846288fe1b3d55e66c" title="Call &quot;rm &quot; + CheMPS2::DMRG_MPS_storage_prefix + &quot;*.h5&quot;. " alt="" coords="370,3772,611,3799"/><area shape="rect" id="node85" href="classCheMPS2_1_1DMRG.html#a2254cc31b5d9497694ea2229226b7bd6" title="Call &quot;rm &quot; + tempfolder + &quot;/&quot; + CheMPS2::DMRG_OPERATOR_storage_prefix + string(thePID) + &quot;*..." alt="" coords="385,3823,597,3865"/><area shape="rect" id="node86" href="classCheMPS2_1_1CASSCF.html#a56b332538d87b477c036385b0b7c371e" title="Construct the 1&#45;RDM from the 2&#45;RDM. " alt="" coords="371,3889,611,3916"/><area shape="rect" id="node87" href="classCheMPS2_1_1CASSCF.html#acbda4df2bea2dc0e5667d92eae2e8013" title="Calculate the natural orbitals and their occupation numbers. " alt="" coords="382,1592,599,1619"/><area shape="rect" id="node88" href="classCheMPS2_1_1CASSCF.html#ad3b59817dede9833446eb513b12284db" title="Rotate the CASSCF 1&#45;RDM and 2&#45;RDM to a new basis (to calculate the gradient and Hessian) ..." alt="" coords="394,3941,587,3982"/><area shape="rect" id="node89" href="classCheMPS2_1_1DMRGSCFVmatRotations.html#ae8773f07770b03db7c70dc51fc78958e" title="Fill the rotated two&#45;body matrix elements with max. two virtual indices, based on HamOrig and unitary..." alt="" coords="669,201,915,242"/><area shape="rect" id="node94" href="classCheMPS2_1_1DMRGSCFVmatRotations.html#a86092727e466bea078911da301567093" title="Fill the rotated two&#45;body matrix elements with max. two virtual indices, based on HamOrig and unitary..." alt="" coords="669,266,915,307"/><area shape="rect" id="node95" href="classCheMPS2_1_1CASSCF.html#a0210ff118bab44593aef7c6ec9f31a56" title="Build the F&#45;matrix (Eq. (11) in the Siegbahn paper [CAS3]) " alt="" coords="385,1188,596,1215"/><area shape="rect" id="node101" href="classCheMPS2_1_1CASSCF.html#a21471f166b873029b5e51dda4a6907c4" title="Build the Wtilde&#45;matrix (Eq. (20b) in the Siegbahn paper [CAS3]) " alt="" coords="382,1393,599,1420"/><area shape="rect" id="node104" href="classCheMPS2_1_1CASSCF.html#abf34a3243a38979439e7aa2d9e60c4dd" title="Calculate the augmented Hessian Newton&#45;Raphson update for the orthogonal orbital rotation matrix..." alt="" coords="382,117,599,158"/><area shape="rect" id="node21" href="classCheMPS2_1_1DMRGSCFunitary.html#a7ca4dead16809cd2a896c1a05b92fc0b" title="Get the unitary rotation for block irrep. " alt="" coords="973,390,1171,431"/><area shape="rect" id="node27" href="classCheMPS2_1_1Irreps.html#a1d86c7a8b3c3a7b9215c0e298f0ae047" title="Get the direct product of the irreps with numbers Irrep1 and Irrep2: a bitwise XOR for psi4&#39;s convent..." alt="" coords="977,1100,1167,1127"/><area shape="rect" id="node28" href="classCheMPS2_1_1Hamiltonian.html#a2ddb391c8a20c50bdd2c775cffd8fbb1" title="Set a Vmat element. " alt="" coords="713,734,871,775"/><area shape="rect" id="node29" href="classCheMPS2_1_1Hamiltonian.html#ab6147d890404000374bb96baba0b1f82" title="Add to Vmat element. " alt="" coords="713,617,871,658"/><area shape="rect" id="node32" href="classCheMPS2_1_1DMRGSCFVmatRotations.html#a5471bb0feb5a00c8619cb9ff25978b16" title="Fill the rotated two&#45;body matrix elements, based on HamOrig and unitary. Do entire blocks at once..." alt="" coords="669,331,915,373"/><area shape="rect" id="node33" href="classCheMPS2_1_1FourIndex.html#a8733c4fd0064bcd845786157f7d9b26f" title="Set an element. " alt="" coords="985,339,1159,365"/><area shape="rect" id="node37" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="693,1582,891,1623"/><area shape="rect" id="node38" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="693,1647,891,1689"/><area shape="rect" id="node39" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="693,1517,891,1558"/><area shape="rect" id="node43" href="classCheMPS2_1_1MPIchemps2.html#a6732ae60b5b4c8a4f1b063f9db304bf5" title="Get the rank of this MPI process. " alt="" coords="989,3067,1155,3109"/><area shape="rect" id="node47" href="classCheMPS2_1_1SyBookkeeper.html#ab06fa32f4e352d248ebfe67d850a574a" title="Get an orbital irrep. " alt="" coords="705,2929,879,2970"/><area shape="rect" id="node48" href="classCheMPS2_1_1Sobject.html#a687a29eab89ef3763af8c630b48e3bf6" title="Join two sites to form a composite S&#45;object. " alt="" coords="709,1997,875,2024"/><area shape="rect" id="node50" href="classCheMPS2_1_1Heff.html#ab8ccd23cc035ed40e13705c3f2e581a3" title="Davidson Solver. " alt="" coords="679,3096,905,3123"/><area shape="rect" id="node51" href="classCheMPS2_1_1Problem.html#a6c6f133286114da1666965c8048e47a1" title="Get the constant part of the Hamiltonian. " alt="" coords="695,3264,889,3291"/><area shape="rect" id="node53" href="classCheMPS2_1_1Sobject.html#a34983e86ae9f19de0be6b923479c13df" title="SVD an S&#45;object into 2 TensorT&#39;s. " alt="" coords="708,2995,876,3021"/><area shape="rect" id="node55" href="classCheMPS2_1_1ConvergenceScheme.html#abb766295f71d3c1e3b9edc875504b317" title="Get the number of renormalized states for a particular instruction. " alt="" coords="685,3147,899,3189"/><area shape="rect" id="node56" href="classCheMPS2_1_1ConvergenceScheme.html#ab8c98d5388c415c42115084c5817e1dc" title="Get the number of instructions. " alt="" coords="685,1815,899,1857"/><area shape="rect" id="node57" href="classCheMPS2_1_1TensorT.html#af21d5300f20c3baf88edf9ec3d3bd943" title="Left&#45;normalization. " alt="" coords="709,1764,875,1791"/><area shape="rect" id="node59" href="classCheMPS2_1_1TwoDM.html#a5c5bf12b31aa9cb4b0b31bd53dad1ed3" title="Fill the 2DM terms with as second site index denT&#45;&gt;gIndex() " alt="" coords="700,2877,884,2904"/><area shape="rect" id="node61" href="classCheMPS2_1_1TensorT.html#afea87f0a1be6ed05fb668528f2f8bf30" title="Right&#45;normalization. " alt="" coords="711,2048,873,2075"/><area shape="rect" id="node62" href="classCheMPS2_1_1TensorT.html#ad53db81f1f1bf33512f93a23abc0ed50" title="Multiply at the right with a TensorDiag. " alt="" coords="681,2099,903,2125"/><area shape="rect" id="node63" href="classCheMPS2_1_1TwoDM.html#a520ebec8dd2e56a475105e651a98fec3" title="Add the 2&#45;RDM elements of all MPI processes. " alt="" coords="709,2266,875,2307"/><area shape="rect" id="node64" href="classCheMPS2_1_1TwoDM.html#a3970c2fccf52e6e653e2866fabcd3d04" title="Return the double trace of 2DM&#45;A (should be N(N&#45;1)) " alt="" coords="668,2332,916,2359"/><area shape="rect" id="node65" href="classCheMPS2_1_1SyBookkeeper.html#af39babd5df4cb5eeb84ffc017af841c3" title="Get the targeted particle number. " alt="" coords="692,2383,892,2409"/><area shape="rect" id="node66" href="classCheMPS2_1_1TwoDM.html#a1e1714c5e2d9cd7bf756ea9263f4711d" title="Calculate the energy based on the 2DM&#45;A. " alt="" coords="687,2433,897,2460"/><area shape="rect" id="node67" href="classCheMPS2_1_1TensorT.html#a6048e242ad6c3b1798ead44f7256fe31" title="Multiply at the left with a TensorDiag. " alt="" coords="685,2149,899,2176"/><area shape="rect" id="node68" href="classCheMPS2_1_1SyBookkeeper.html#ad52f6f852f6f2f88c286579054c1886f" title="Get the max. virtual dimension at a certain boundary. Useful function to preallocate memory when cons..." alt="" coords="705,2485,879,2526"/><area shape="rect" id="node69" href="classCheMPS2_1_1TensorGYZ.html#a3f06f0df3e52b3b67bf5e63faaaa2a55" title="Update the TensorGYZ. " alt="" coords="713,2550,871,2591"/><area shape="rect" id="node70" href="classCheMPS2_1_1TensorSwap.html#aecb02bc029d2cdd0d7a754bdf3ac491c" title="Clear and update. " alt="" coords="711,2615,873,2657"/><area shape="rect" id="node71" href="classCheMPS2_1_1TensorGYZ.html#a8470ec48e82ff7d002a1b248afc98787" title="Construct a new TensorGYZ. " alt="" coords="713,1881,871,1922"/><area shape="rect" id="node72" href="classCheMPS2_1_1TensorK.html#af50dfd56702742ce0d0642e28413a893" title="CheMPS2::TensorK::construct" alt="" coords="691,1947,893,1973"/><area shape="rect" id="node73" href="classCheMPS2_1_1Correlations.html#a5fa2dd8712c0b9359e5e8a14de50c105" title="Fill at the current step of the iterations the two&#45;orbital mutual information and the remaining part ..." alt="" coords="712,2201,872,2242"/><area shape="rect" id="node74" href="classCheMPS2_1_1Correlations.html#ae175e3599bab50c3fe334e3a98c41f23" title="Broadcast the diradical correlation function and the two&#45;orbital mutual information. " alt="" coords="712,2681,872,2722"/><area shape="rect" id="node75" href="classCheMPS2_1_1Correlations.html#a1cf618a098e75511dda2fb0d010dab2e" title="Get the single&#45;orbital entropy for a certain site, using hte HAM indices. " alt="" coords="699,2746,885,2787"/><area shape="rect" id="node76" href="classCheMPS2_1_1Correlations.html#a3e4a935011b95ad18b28b88ac56990fc" title="Return Idistance(power) (see return for definition) " alt="" coords="699,2811,885,2853"/><area shape="rect" id="node49" href="classCheMPS2_1_1TensorT.html#aafb4d43ad6178437b47a32a24c375fa3" title="Get the pointer to the storage. " alt="" coords="973,1972,1171,1999"/><area shape="rect" id="node52" href="classCheMPS2_1_1Hamiltonian.html#a031fa6987b304e3a7f6114b9f2e1f2ab" title="Get the constant energy. " alt="" coords="993,3257,1151,3298"/><area shape="rect" id="node54" href="classCheMPS2_1_1TensorT.html#a1f0830b0e729573fe19a3327462f7e7e" title="Reset the TensorT (if virtual dimensions are changed) " alt="" coords="981,2995,1163,3021"/><area shape="rect" id="node58" href="classCheMPS2_1_1TensorDiag.html#a7fb7bbec47e601be89ffba3ad3736ca7" title="Get the pointer to the storage. " alt="" coords="993,2066,1151,2107"/><area shape="rect" id="node60" href="classCheMPS2_1_1TensorT.html#a279b51f0616ab58f2a2893681b4cab71" title="Get the location index. " alt="" coords="979,2543,1165,2569"/><area shape="rect" id="node78" href="classCheMPS2_1_1TwoDM.html#a40c2181006aaf66b8dad2e545e3d8186" title="Get a 2DM_A term, using the HAM indices. " alt="" coords="665,3436,919,3463"/><area shape="rect" id="node90" href="classCheMPS2_1_1DMRGSCFintegrals.html#ac9c1b2d0d67b2beb246ce3c59b193177" title="Set an element of the Coulomb object ( c1 c2 | a1 a2 ) " alt="" coords="969,205,1175,246"/><area shape="rect" id="node91" href="classCheMPS2_1_1DMRGSCFintegrals.html#ab3a4b266923e8188ac73d49aa2acb90a" title="Add a double to an element of the Coulomb object ( c1 c2 | a1 a2 ) " alt="" coords="969,139,1175,181"/><area shape="rect" id="node92" href="classCheMPS2_1_1DMRGSCFintegrals.html#af910b76a44cdbde6cdffc1750705fdb9" title="Set an element of the Exchange object ( c1 v1 | c2 v2 ) " alt="" coords="969,270,1175,311"/><area shape="rect" id="node93" href="classCheMPS2_1_1DMRGSCFintegrals.html#a57d2abf30dfa50a715d7fffcb3987674" title="Add a double to an element of the Exchange object ( c1 v1 | c2 v2 ) " alt="" coords="969,74,1175,115"/><area shape="rect" id="node96" href="classCheMPS2_1_1DMRGSCFmatrix.html#a0729b05fef0cb96eaf26e7c8d6017931" title="Clear the matrix. " alt="" coords="695,851,889,893"/><area shape="rect" id="node97" href="classCheMPS2_1_1DMRGSCFmatrix.html#a3660ff17cbeb278c265b6461450b1a24" title="Set an element. " alt="" coords="682,917,902,944"/><area shape="rect" id="node98" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9" title="Get an element. " alt="" coords="682,1217,902,1244"/><area shape="rect" id="node99" href="classCheMPS2_1_1DMRGSCFmatrix.html#a230d9fa54109d0754a054868611177c5" title="Get a matrix block. " alt="" coords="695,1034,889,1075"/><area shape="rect" id="node100" href="classCheMPS2_1_1DMRGSCFintegrals.html#ad462dfa92d77f1f02371f12e91cac429" title="Get a two&#45;body matrix element with at most 2 virtual indices, using the FourIndex API..." alt="" coords="689,1269,895,1310"/><area shape="rect" id="node102" href="classCheMPS2_1_1DMRGSCFwtilde.html#a939e077b9fcc8ffafd9a168056991795" title="Clear. " alt="" coords="696,1451,888,1493"/><area shape="rect" id="node103" href="classCheMPS2_1_1DMRGSCFwtilde.html#a1315dead44fb4c153c1e93758f048378" title="Get the (pr) subblock of w_tilde_pqrs, which is stored as w_tilde[ I_pq ][ I_rs ][ p + ( Nocc[I_pq] +..." alt="" coords="696,1386,888,1427"/><area shape="rect" id="node105" href="classCheMPS2_1_1Davidson.html#a2ae39a55a30271ae6f5d46b52df3d991" title="The iterator to converge the ground state vector. " alt="" coords="715,70,869,111"/><area shape="rect" id="node106" href="classCheMPS2_1_1Davidson.html#a0a9f07122a47a4ec24e6add4b8b30797" title="Get the number of matrix vector multiplications which have been performed. " alt="" coords="715,135,869,177"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a258f11f16c7790c6943589633203c7e3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::fillLocalizedOrbitalRotations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFunitary.html">CheMPS2::DMRGSCFunitary</a> *&#160;</td>
          <td class="paramname"><em>unitary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">CheMPS2::DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>localIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>eigenvecs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>From an Edmiston-Ruedenberg active space rotation, fetch the eigenvectors and store them in eigenvecs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">unitary</td><td>The Edmiston-Ruedenberg active space rotation </td></tr>
    <tr><td class="paramname">localIdx</td><td>Object which handles the index conventions for <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> </td></tr>
    <tr><td class="paramname">eigenvecs</td><td>Where the eigenvectors are stored </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00124">124</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a258f11f16c7790c6943589633203c7e3_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a258f11f16c7790c6943589633203c7e3_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a258f11f16c7790c6943589633203c7e3_cgraph" id="classCheMPS2_1_1CASSCF_a258f11f16c7790c6943589633203c7e3_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="275,5,474,46"/><area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="275,70,474,111"/><area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="275,135,474,177"/><area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFunitary.html#a7ca4dead16809cd2a896c1a05b92fc0b" title="Get the unitary rotation for block irrep. " alt="" coords="276,201,473,242"/></map>
</div>
</p>

<p><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a258f11f16c7790c6943589633203c7e3_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a258f11f16c7790c6943589633203c7e3_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a258f11f16c7790c6943589633203c7e3_icgraph" id="classCheMPS2_1_1CASSCF_a258f11f16c7790c6943589633203c7e3_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#a2ab912e50eb821fed2089e88692ec0b1" title="Does the state&#45;specific CASSCF cycle with the augmented Hessian Newton&#45;Raphson method. " alt="" coords="275,12,586,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afba8add72828a26c426f47a790511bf1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CheMPS2::CASSCF::getNumberOfIrreps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the number of irreps. </p>
<dl class="section return"><dt>Returns</dt><dd>The number of irreps </dd></dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00092">92</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad3b59817dede9833446eb513b12284db"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::rotate2DMand1DM </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nDMRGelectrons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>totOrbDMRG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>eigenvecs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>work</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>localDMRG1DM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>localDMRG2DM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rotate the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> 1-RDM and 2-RDM to a new basis (to calculate the gradient and Hessian) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nDMRGelectrons</td><td>The number of <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> active space electrons </td></tr>
    <tr><td class="paramname">totOrbDMRG</td><td>The total number of <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> orbitals </td></tr>
    <tr><td class="paramname">eigenvecs</td><td>Where the eigenvectors are stored </td></tr>
    <tr><td class="paramname">work</td><td>Work memory </td></tr>
    <tr><td class="paramname">localDMRG1DM</td><td>The <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> 1-RDM </td></tr>
    <tr><td class="paramname">localDMRG2DM</td><td>The <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> 2-RDM </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00198">198</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_ad3b59817dede9833446eb513b12284db_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_ad3b59817dede9833446eb513b12284db_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_ad3b59817dede9833446eb513b12284db_icgraph" id="classCheMPS2_1_1CASSCF_ad3b59817dede9833446eb513b12284db_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#a2ab912e50eb821fed2089e88692ec0b1" title="Does the state&#45;specific CASSCF cycle with the augmented Hessian Newton&#45;Raphson method. " alt="" coords="249,12,559,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a56b332538d87b477c036385b0b7c371e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::setDMRG1DM </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nDMRGelectrons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>totOrbDMRG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>localDMRG1DM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>localDMRG2DM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct the 1-RDM from the 2-RDM. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nDMRGelectrons</td><td>The number of <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> active space electrons </td></tr>
    <tr><td class="paramname">totOrbDMRG</td><td>The total number of <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> orbitals </td></tr>
    <tr><td class="paramname">localDMRG1DM</td><td>The <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> 1-RDM </td></tr>
    <tr><td class="paramname">localDMRG2DM</td><td>The <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> 2-RDM </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00109">109</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a56b332538d87b477c036385b0b7c371e_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a56b332538d87b477c036385b0b7c371e_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a56b332538d87b477c036385b0b7c371e_icgraph" id="classCheMPS2_1_1CASSCF_a56b332538d87b477c036385b0b7c371e_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#a2ab912e50eb821fed2089e88692ec0b1" title="Does the state&#45;specific CASSCF cycle with the augmented Hessian Newton&#45;Raphson method. " alt="" coords="294,5,605,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a701bdaa40881168d6b386683eaa01cea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::setupStart </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>NoccIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>NDMRGIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>NvirtIn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the start of the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> calculation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">NoccIn</td><td>Array of length numberOfIrreps containing the number of double occupied HF orbitals per irrep for the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> loop. </td></tr>
    <tr><td class="paramname">NDMRGIn</td><td>Array of length numberOfIrreps containing the number of active orbitals per irrep for the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> loop. </td></tr>
    <tr><td class="paramname">NvirtIn</td><td>Array of length numberOfIrreps containing the number of empty orbitals per irrep for the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> loop. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00466">466</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="CASSCF_8h_source.html">CASSCF.h</a></li>
<li><a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a></li>
<li><a class="el" href="CASSCFdebug_8cpp_source.html">CASSCFdebug.cpp</a></li>
<li><a class="el" href="CASSCFnewtonraphson_8cpp_source.html">CASSCFnewtonraphson.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>CheMPS2</b></li><li class="navelem"><a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a></li>
    <li class="footer">Generated on Fri May 29 2015 20:43:19 for CheMPS2 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
