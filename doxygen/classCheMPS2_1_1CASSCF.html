<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>CheMPS2: CheMPS2::CASSCF Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="CheMPS2logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">CheMPS2
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classCheMPS2_1_1CASSCF.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classCheMPS2_1_1CASSCF-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CheMPS2::CASSCF Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="CASSCF_8h_source.html">CASSCF.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad2d958c7b1ca60b43f7aa5eaabeeb0b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#ad2d958c7b1ca60b43f7aa5eaabeeb0b1">CASSCF</a> (<a class="el" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a> *ham_in, int *docc_in, int *socc_in, int *nocc_in, int *ndmrg_in, int *nvirt_in)</td></tr>
<tr class="memdesc:ad2d958c7b1ca60b43f7aa5eaabeeb0b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#ad2d958c7b1ca60b43f7aa5eaabeeb0b1">More...</a><br /></td></tr>
<tr class="separator:ad2d958c7b1ca60b43f7aa5eaabeeb0b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20937fd3dbc5c5f3fa2e7ffd4f751900"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a20937fd3dbc5c5f3fa2e7ffd4f751900"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a20937fd3dbc5c5f3fa2e7ffd4f751900">~CASSCF</a> ()</td></tr>
<tr class="memdesc:a20937fd3dbc5c5f3fa2e7ffd4f751900"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:a20937fd3dbc5c5f3fa2e7ffd4f751900"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ecba3101fed76c3ce03c23c6446a3f8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a4ecba3101fed76c3ce03c23c6446a3f8">get_num_irreps</a> ()</td></tr>
<tr class="memdesc:a4ecba3101fed76c3ce03c23c6446a3f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of irreps.  <a href="#a4ecba3101fed76c3ce03c23c6446a3f8">More...</a><br /></td></tr>
<tr class="separator:a4ecba3101fed76c3ce03c23c6446a3f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad05bfb6ca9c76338ae436083e285cfa6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#ad05bfb6ca9c76338ae436083e285cfa6">solve</a> (const int Nelectrons, const int TwoS, const int Irrep, <a class="el" href="classCheMPS2_1_1ConvergenceScheme.html">ConvergenceScheme</a> *OptScheme, const int rootNum, <a class="el" href="classCheMPS2_1_1DMRGSCFoptions.html">DMRGSCFoptions</a> *theDMRGSCFoptions)</td></tr>
<tr class="memdesc:ad05bfb6ca9c76338ae436083e285cfa6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> cycles with the augmented Hessian Newton-Raphson method.  <a href="#ad05bfb6ca9c76338ae436083e285cfa6">More...</a><br /></td></tr>
<tr class="separator:ad05bfb6ca9c76338ae436083e285cfa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afabb84cda6961978c846fa8f18799a5e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#afabb84cda6961978c846fa8f18799a5e">caspt2</a> (const int Nelectrons, const int TwoS, const int Irrep, <a class="el" href="classCheMPS2_1_1ConvergenceScheme.html">ConvergenceScheme</a> *OptScheme, const int rootNum, <a class="el" href="classCheMPS2_1_1DMRGSCFoptions.html">DMRGSCFoptions</a> *theDMRGSCFoptions, const double IPEA, const double IMAG)</td></tr>
<tr class="memdesc:afabb84cda6961978c846fa8f18799a5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the caspt2 correction energy for a converged casscf wavefunction.  <a href="#afabb84cda6961978c846fa8f18799a5e">More...</a><br /></td></tr>
<tr class="separator:afabb84cda6961978c846fa8f18799a5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe585ea6f4777137d2bbdd2b475caa6a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afe585ea6f4777137d2bbdd2b475caa6a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#afe585ea6f4777137d2bbdd2b475caa6a">deleteStoredUnitary</a> (const string filename=CheMPS2::DMRGSCF_unitaryStorageName)</td></tr>
<tr class="memdesc:afe585ea6f4777137d2bbdd2b475caa6a"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> unitary rotation remove call. <br /></td></tr>
<tr class="separator:afe585ea6f4777137d2bbdd2b475caa6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd8799e175329933a246dfee97e5dfb7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abd8799e175329933a246dfee97e5dfb7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#abd8799e175329933a246dfee97e5dfb7">deleteStoredDIIS</a> (const string filename=CheMPS2::DMRGSCF_DIISstorageName)</td></tr>
<tr class="memdesc:abd8799e175329933a246dfee97e5dfb7"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> <a class="el" href="classCheMPS2_1_1DIIS.html">DIIS</a> vectors remove call. <br /></td></tr>
<tr class="separator:abd8799e175329933a246dfee97e5dfb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a0210ff118bab44593aef7c6ec9f31a56"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a0210ff118bab44593aef7c6ec9f31a56">buildFmat</a> (<a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localFmat, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localTmat, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localJKocc, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localJKact, const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *localIdx, const <a class="el" href="classCheMPS2_1_1DMRGSCFintegrals.html">DMRGSCFintegrals</a> *theInts, double *local2DM, double *local1DM)</td></tr>
<tr class="memdesc:a0210ff118bab44593aef7c6ec9f31a56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the F-matrix (Eq. (11) in the Siegbahn paper [CAS3])  <a href="#a0210ff118bab44593aef7c6ec9f31a56">More...</a><br /></td></tr>
<tr class="separator:a0210ff118bab44593aef7c6ec9f31a56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21471f166b873029b5e51dda4a6907c4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a21471f166b873029b5e51dda4a6907c4">buildWtilde</a> (<a class="el" href="classCheMPS2_1_1DMRGSCFwtilde.html">DMRGSCFwtilde</a> *localwtilde, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localTmat, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localJKocc, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localJKact, const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *localIdx, const <a class="el" href="classCheMPS2_1_1DMRGSCFintegrals.html">DMRGSCFintegrals</a> *theInts, double *local2DM, double *local1DM)</td></tr>
<tr class="memdesc:a21471f166b873029b5e51dda4a6907c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the Wtilde-matrix (Eq. (20b) in the Siegbahn paper [CAS3])  <a href="#a21471f166b873029b5e51dda4a6907c4">More...</a><br /></td></tr>
<tr class="separator:a21471f166b873029b5e51dda4a6907c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf34a3243a38979439e7aa2d9e60c4dd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#abf34a3243a38979439e7aa2d9e60c4dd">augmentedHessianNR</a> (const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localFmat, const <a class="el" href="classCheMPS2_1_1DMRGSCFwtilde.html">DMRGSCFwtilde</a> *localwtilde, const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *localIdx, const <a class="el" href="classCheMPS2_1_1DMRGSCFunitary.html">DMRGSCFunitary</a> *localUmat, double *theupdate, double *updateNorm, double *gradNorm)</td></tr>
<tr class="memdesc:abf34a3243a38979439e7aa2d9e60c4dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the augmented Hessian Newton-Raphson update for the orthogonal orbital rotation matrix.  <a href="#abf34a3243a38979439e7aa2d9e60c4dd">More...</a><br /></td></tr>
<tr class="separator:abf34a3243a38979439e7aa2d9e60c4dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8305d7f87c340f9001e497aaf7ba93f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#ae8305d7f87c340f9001e497aaf7ba93f">copy2DMover</a> (<a class="el" href="classCheMPS2_1_1TwoDM.html">TwoDM</a> *theDMRG2DM, const int totOrbDMRG, double *localDMRG2DM)</td></tr>
<tr class="memdesc:ae8305d7f87c340f9001e497aaf7ba93f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy over the <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 2-RDM.  <a href="#ae8305d7f87c340f9001e497aaf7ba93f">More...</a><br /></td></tr>
<tr class="separator:ae8305d7f87c340f9001e497aaf7ba93f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac78aeef75d0a83c75030080c8d1033e7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#ac78aeef75d0a83c75030080c8d1033e7">copy3DMover</a> (<a class="el" href="classCheMPS2_1_1ThreeDM.html">ThreeDM</a> *theDMRG3DM, const int numL, double *three_dm)</td></tr>
<tr class="memdesc:ac78aeef75d0a83c75030080c8d1033e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy over the <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 3-RDM.  <a href="#ac78aeef75d0a83c75030080c8d1033e7">More...</a><br /></td></tr>
<tr class="separator:ac78aeef75d0a83c75030080c8d1033e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94cd26ccbe91c6549d64735ee2c75beb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a94cd26ccbe91c6549d64735ee2c75beb">setDMRG1DM</a> (const int num_elec, const int numL, double *localDMRG1DM, double *localDMRG2DM)</td></tr>
<tr class="memdesc:a94cd26ccbe91c6549d64735ee2c75beb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct the 1-RDM from the 2-RDM.  <a href="#a94cd26ccbe91c6549d64735ee2c75beb">More...</a><br /></td></tr>
<tr class="separator:a94cd26ccbe91c6549d64735ee2c75beb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f20d25b94c1d821f22f95a6bab0ebc7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a3f20d25b94c1d821f22f95a6bab0ebc7">copy_active</a> (double *origin, <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *result, const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *idx, const bool one_rdm)</td></tr>
<tr class="memdesc:a3f20d25b94c1d821f22f95a6bab0ebc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy a one-orbital quantity from array format to <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> format.  <a href="#a3f20d25b94c1d821f22f95a6bab0ebc7">More...</a><br /></td></tr>
<tr class="separator:a3f20d25b94c1d821f22f95a6bab0ebc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53a0c4f5043fd2494f8825cb43578fa7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a53a0c4f5043fd2494f8825cb43578fa7">copy_active</a> (const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *origin, double *result, const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *idx)</td></tr>
<tr class="memdesc:a53a0c4f5043fd2494f8825cb43578fa7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy a one-orbital quantity from <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> format to array format.  <a href="#a53a0c4f5043fd2494f8825cb43578fa7">More...</a><br /></td></tr>
<tr class="separator:a53a0c4f5043fd2494f8825cb43578fa7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a258f11f16c7790c6943589633203c7e3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a258f11f16c7790c6943589633203c7e3">fillLocalizedOrbitalRotations</a> (<a class="el" href="classCheMPS2_1_1DMRGSCFunitary.html">CheMPS2::DMRGSCFunitary</a> *unitary, <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">CheMPS2::DMRGSCFindices</a> *localIdx, double *eigenvecs)</td></tr>
<tr class="memdesc:a258f11f16c7790c6943589633203c7e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">From an Edmiston-Ruedenberg active space rotation, fetch the eigenvectors and store them in eigenvecs.  <a href="#a258f11f16c7790c6943589633203c7e3">More...</a><br /></td></tr>
<tr class="separator:a258f11f16c7790c6943589633203c7e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06428c029b80277b00a735ea673c147f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a06428c029b80277b00a735ea673c147f">block_diagonalize</a> (const char space, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *Mat, <a class="el" href="classCheMPS2_1_1DMRGSCFunitary.html">DMRGSCFunitary</a> *Umat, double *work1, double *work2, const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *idx, const bool invert, double *localDMRG2RDM)</td></tr>
<tr class="memdesc:a06428c029b80277b00a735ea673c147f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Block-diagonalize Mat.  <a href="#a06428c029b80277b00a735ea673c147f">More...</a><br /></td></tr>
<tr class="separator:a06428c029b80277b00a735ea673c147f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10b37b294f7573005a6b49b669e734ca"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a10b37b294f7573005a6b49b669e734ca">construct_fock</a> (<a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *Fock, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *Tmat, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *Qocc, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *Qact, const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *idx)</td></tr>
<tr class="memdesc:a10b37b294f7573005a6b49b669e734ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct the Fock matrix.  <a href="#a10b37b294f7573005a6b49b669e734ca">More...</a><br /></td></tr>
<tr class="separator:a10b37b294f7573005a6b49b669e734ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4c00cd4c21dc402ad5e966232b199d3"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#ad4c00cd4c21dc402ad5e966232b199d3">deviation_from_blockdiag</a> (<a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *matrix, const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *idx)</td></tr>
<tr class="memdesc:ad4c00cd4c21dc402ad5e966232b199d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the RMS deviation from block-diagonal.  <a href="#ad4c00cd4c21dc402ad5e966232b199d3">More...</a><br /></td></tr>
<tr class="separator:ad4c00cd4c21dc402ad5e966232b199d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> class. </p><dl class="section author"><dt>Author</dt><dd>Sebastian Wouters <a href="#" onclick="location.href='mai'+'lto:'+'seb'+'as'+'tia'+'nw'+'out'+'er'+'s@g'+'ma'+'il.'+'co'+'m'; return false;">sebas<span style="display: none;">.nosp@m.</span>tian<span style="display: none;">.nosp@m.</span>woute<span style="display: none;">.nosp@m.</span>rs@g<span style="display: none;">.nosp@m.</span>mail.<span style="display: none;">.nosp@m.</span>com</a> </dd></dl>
<dl class="section date"><dt>Date</dt><dd>June 18, 2013</dd></dl>
<h1><a class="anchor" id="intro"></a>
Introduction</h1>
<p>In methods which use a <a class="el" href="classCheMPS2_1_1FCI.html">FCI</a> solver, this solver can be replaced by <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a>. <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> allows for an efficient extraction of the 2-RDM [CAS1, CAS2]. The 2-RDM of the active space is required in the complete active space self-consistent field (<a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a>) method to compute the gradient and the Hessian with respect to orbital rotations [CAS3]. It is therefore natural to introduce a <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> variant with <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> as active space solver, called DMRG-SCF [CAS2, CAS4, CAS5], which allows to treat static correlation in large active spaces. In CheMPS2, I have implemented the augmented Hessian Newton-Raphson DMRG-SCF method, with exact Hessian [CAS5, CAS6]. It can be called with the function CheMPS2::CASSCF::doCASSCFnewtonraphson.</p>
<h1><a class="anchor" id="equations_2step_dmrgscf"></a>
Orbital gradient and Hessian</h1>
<p>The calculation of the orbital gradient and Hessian for DMRG-SCF is based on [CAS3]. The basic idea is to express the energy with the unitary group generators: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \hat{E}_{pq} &amp; = &amp; \sum\limits_{\sigma} \hat{a}^{\dagger}_{p \sigma} \hat{a}_{q \sigma} \\ \left[ \hat{E}_{pq} , \hat{E}_{rs} \right] &amp; = &amp; \delta_{qr} \hat{E}_{ps} - \delta_{ps} \hat{E}_{rq} \\ \hat{E}^{-}_{pq} &amp; = &amp; \hat{E}_{pq} - \hat{E}_{qp} \\ \hat{T} &amp; = &amp; \sum\limits_{p<q} x_{pq} \hat{E}^{-}_{pq} \\ E(\vec{x}) &amp; = &amp; \braket{0 | e^{\hat{T}} \hat{H} e^{-\hat{T}} | 0 } \\ \left. \frac{\partial E(\vec{x})}{\partial x_{ij}} \right|_{0} &amp; = &amp; \braket{ 0 | \left[ \hat{E}_{ij}^{-}, \hat{H} \right] | 0 } \\ \left. \frac{\partial^2 E(\vec{x})}{\partial x_{ij} \partial x_{kl}} \right|_{0} &amp; = &amp; \frac{1}{2} \braket{ 0 | \left[ \hat{E}_{ij}^{-}, \left[ \hat{E}_{kl}^{-}, \hat{H} \right] \right] | 0 } + \frac{1}{2} \braket{ 0 | \left[ \hat{E}_{kl}^{-}, \left[ \hat{E}_{ij}^{-}, \hat{H} \right] \right] | 0 } \end{eqnarray*}" src="form_0.png"/>
</p>
<p> The variables <img class="formulaInl" alt="$x_{pq}$" src="form_1.png"/> only connect orbitals with the same irrep ( <img class="formulaInl" alt="$I_p=I_q$" src="form_2.png"/>). Assuming that <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> is exact, <img class="formulaInl" alt="$x_{pq}$" src="form_1.png"/> in addition only connects orbitals when they belong to different occupation blocks: occupied, active, virtual. With some algebra, the derivatives can be rewritten. Real-valued symmetric one-electron integrals <img class="formulaInl" alt="$h_{ij}$" src="form_3.png"/> and real-valued eightfold permutation symmetric two-electron integrals <img class="formulaInl" alt="$(ij | kl)$" src="form_4.png"/> are assumed (chemical notation for the latter). </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \Gamma^{2A}_{ijkl} &amp; = &amp; \sum\limits_{\sigma \tau} \braket{ 0 | \hat{a}^{\dagger}_{i \sigma} \hat{a}_{j \tau}^{\dagger} \hat{a}_{l \tau} \hat{a}_{k \sigma} | 0} \\ \Gamma^1_{ij} &amp; = &amp; \sum\limits_{\sigma} \braket{ 0 | \hat{a}^{\dagger}_{i \sigma} \hat{a}_{j \sigma} | 0} \\ \left. \frac{\partial E(\vec{x})}{\partial x_{ij}} \right|_{0} &amp; = &amp; 2 \left( F_{ij} - F_{ji} \right) \\ F_{pq} &amp; = &amp; \sum\limits_{r} \Gamma_{pr}^{1} h_{qr} + \sum\limits_{rst} \Gamma^{2A}_{psrt} (qr | st) \\ \left. \frac{\partial^2 E(\vec{x})}{\partial x_{ij} \partial x_{kl}} \right|_{0} &amp; = &amp; w_{ijkl} - w_{jikl} - w_{ijlk} + w_{jilk} \\ w_{pqrs} &amp; = &amp; \delta_{qr} \left( F_{ps} + F_{sp} \right) + \tilde{w}_{pqrs} \\ \tilde{w}_{pqrs} &amp; = &amp; 2 \Gamma^1_{pr} h_{qs} + 2 \sum\limits_{\alpha \beta} \left( \Gamma^{2A}_{r \alpha p \beta} (qs | \alpha \beta ) + \left( \Gamma^{2A}_{r \alpha \beta p} + \Gamma^{2A}_{r p \beta \alpha} \right) (q \alpha | s \beta ) \right) \end{eqnarray*}" src="form_5.png"/>
</p>
<p> In the calculation of <img class="formulaInl" alt="$F_{pq}$" src="form_6.png"/>, the indices <img class="formulaInl" alt="$prst$" src="form_7.png"/> can only be occupied or active due to their appearance in the density matrices, and the only index which can be virtual is hence <img class="formulaInl" alt="$q$" src="form_8.png"/>. Moreover, due to the irrep symmetry of the integrals and density matrices, <img class="formulaInl" alt="$F_{pq}$" src="form_6.png"/> is diagonal in the irreps: <img class="formulaInl" alt="$I_p = I_q$" src="form_9.png"/>. Alternatively, this can be understood by the fact that <img class="formulaInl" alt="$x_{pq}$" src="form_1.png"/> only connects orbitals with the same irrep.</p>
<p>In the calculation of <img class="formulaInl" alt="$\tilde{w}_{pqrs}$" src="form_10.png"/>, the indices <img class="formulaInl" alt="$pr\alpha\beta$" src="form_11.png"/> can only be occupied or active due to their appearance in the density matrices, and the only indices which can be virtual are hence <img class="formulaInl" alt="$qs$" src="form_12.png"/>. Together with the remark for <img class="formulaInl" alt="$F_{pq}$" src="form_6.png"/>, this can save time for the two-electron integral rotation. Moreover, as <img class="formulaInl" alt="$x_{pq}$" src="form_1.png"/> only connects orbitals with the same irrep, <img class="formulaInl" alt="$I_p = I_q$" src="form_9.png"/> and <img class="formulaInl" alt="$I_r = I_s$" src="form_13.png"/> in <img class="formulaInl" alt="$\tilde{w}_{pqrs}$" src="form_10.png"/>.</p>
<p>By rewriting the density matrices, the calculation of <img class="formulaInl" alt="$F_{pq}$" src="form_6.png"/> and <img class="formulaInl" alt="$\tilde{w}_{pqrs}$" src="form_10.png"/> can be simplified. In the following, occ and act denote the doubly occupied and active orbital spaces, respectively. </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \Gamma^1_{ij} &amp; = &amp; 2 \delta_{ij}^{occ} + \Gamma^{1,act}_{ij} \\ \Gamma^{2A}_{ijkl} &amp; = &amp; \Gamma^{2A,act}_{ijkl} + 2 \delta_{ik}^{occ} \Gamma^{1,act}_{jl} - \delta_{il}^{occ} \Gamma^{1,act}_{jk} \\ &amp; + &amp; 2 \delta_{jl}^{occ} \Gamma^{1,act}_{ik} - \delta_{jk}^{occ} \Gamma^{1,act}_{il} + 4 \delta_{ik}^{occ} \delta_{jl}^{occ} - 2 \delta_{il}^{occ} \delta_{jk}^{occ} \end{eqnarray*}" src="form_14.png"/>
</p>
<p> Define the following symmetric charge (Coulomb + exchange) matrices: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} Q^{occ}_{ij} &amp; = &amp; \sum\limits_{s \in occ} \left[ 2 (ij | ss) - (is | js ) \right] \\ Q^{act}_{ij} &amp; = &amp; \sum\limits_{st \in act} \frac{1}{2} \Gamma^{1,act}_{st} \left[ 2 (ij | st) - (is | jt ) \right] \end{eqnarray*}" src="form_15.png"/>
</p>
<p> They can be calculated efficiently by (1) rotating the occupied and active density matrices from the current basis to the original basis, (2) contracting the rotated density matrices with the two-electron integrals in the original basis, and (3) rotating these contractions to the current basis. The constant part and the one-electron integrals of the active space <a class="el" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a> are: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \tilde{E}_{const} &amp; = &amp; E_{const} + \sum\limits_{s \in occ} \left( 2 h_{ss} + Q_{ss}^{occ} \right) \\ \tilde{h}_{ij} &amp; = &amp; h_{ij} + Q_{ij}^{occ} \end{eqnarray*}" src="form_16.png"/>
</p>
<p> The calculation of <img class="formulaInl" alt="$F_{pq}$" src="form_6.png"/> boils down to: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} p \in occ &amp; : &amp; F_{pq} = 2 \left( h_{qp} + Q^{occ}_{qp} + Q^{act}_{qp} \right) \\ p \in act &amp; : &amp; F_{pq} = \sum\limits_{r \in act} \Gamma^{1,act}_{pr} \left[ h_{qr} + Q^{occ}_{qr} \right] + \sum\limits_{rst \in act} \Gamma^{2A,act}_{psrt} (qr | st) \end{eqnarray*}" src="form_17.png"/>
</p>
<p> And the calculation of <img class="formulaInl" alt="$\tilde{w}_{pqrs}$" src="form_10.png"/> (remember that <img class="formulaInl" alt="$I_p = I_q$" src="form_9.png"/> and <img class="formulaInl" alt="$I_r = I_s$" src="form_13.png"/>): </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} (p,r) &amp; \in &amp; (occ,occ) : \tilde{w}_{pqrs} \\ &amp; = &amp; 4 \delta_{pr}^{occ} \left[ h_{qs} + Q^{occ}_{qs} + Q^{act}_{qs} \right] \\ &amp; + &amp; 4 \left[ 4 (qp | sr) - ( qs | pr ) - ( qr | sp ) \right] \\ (p,r) &amp; \in &amp; (act,act) : \tilde{w}_{pqrs} = 2 \Gamma^{1,act}_{rp} \left[ h_{qs} + Q^{occ}_{qs} \right] \\ &amp; + &amp; 2 \sum\limits_{\alpha\beta \in act} \left[ \Gamma^{2A,act}_{r \alpha p \beta} (qs | \alpha \beta ) + \left( \Gamma^{2A,act}_{r \alpha \beta p} + \Gamma^{2A,act}_{r p \beta \alpha} \right) (q \alpha | s \beta ) \right] \\ (p,r) &amp; \in &amp; (act,occ) : \tilde{w}_{pqrs} \\ &amp; = &amp; 2 \sum\limits_{\alpha \in act} \Gamma^{1,act}_{\alpha p} \left[ 4 (q \alpha | s r) - (qs | \alpha r) - (qr | s \alpha) \right] \\ (p,r) &amp; \in &amp; (occ,act) : \tilde{w}_{pqrs} \\ &amp; = &amp; 2 \sum\limits_{\beta \in act} \Gamma^{1,act}_{r \beta} \left[ 4 (q p | s \beta) - (qs | p \beta) - (q \beta | sp) \right] \end{eqnarray*}" src="form_18.png"/>
</p>
<h1><a class="anchor" id="origalgo"></a>
Augmented Hessian Newton-Raphson DMRG-SCF</h1>
<p>The <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> energy is a function of <img class="formulaInl" alt="$\vec{x}$" src="form_19.png"/>. Up to second order, the energy is given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ E(\vec{x}) = \braket{0 | e^{\hat{T}(\vec{x})} \hat{H} e^{-\hat{T}(\vec{x})} | 0 } \approx E(0) + \vec{x}^T \vec{g} + \frac{1}{2} \vec{x}^T \mathbf{H} \vec{x}. \]" src="form_20.png"/>
</p>
<p> The vector <img class="formulaInl" alt="$\vec{g}$" src="form_21.png"/> is the gradient and the matrix <img class="formulaInl" alt="$\mathbf{H}$" src="form_22.png"/> the Hessian for orbital rotations [CAS3]. They have been described in the previous section. The minimum of <img class="formulaInl" alt="$E(\vec{x})$" src="form_23.png"/> is found at <img class="formulaInl" alt="$\vec{x} = - \mathbf{H}^{-1} \vec{g}$" src="form_24.png"/>. The variables <img class="formulaInl" alt="$\vec{x}$" src="form_19.png"/> parametrize an additional orbital rotation <img class="formulaInl" alt="$\mathbf{U}_{add} = \exp(\mathbf{X}(\vec{x}))$" src="form_25.png"/>, with <img class="formulaInl" alt="$\mathbf{X}(\vec{x}) = -\mathbf{X}^T(\vec{x})$" src="form_26.png"/> a real-valued skew-symmetric matrix. The additional orbital rotation <img class="formulaInl" alt="$\mathbf{U}_{add}$" src="form_27.png"/> transforms the current orbitals <img class="formulaInl" alt="$\mathbf{U}(n)$" src="form_28.png"/> to the new orbitals </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathbf{U}(n+1) = \mathbf{U}_{add} \mathbf{U}(n) = \exp(\mathbf{X}(\vec{x}(n))) \mathbf{U}(n). \]" src="form_29.png"/>
</p>
<p> This updating scheme is called the Newton-Raphson method [CAS3]. If the Hessian is positive definite, these updates are stable. For saddle points in the energy landscape, the Hessian has negative eigenvalues, and these updates can be unstable. It is therefore better to use the augmented Hessian Newton-Raphson method [CAS7]: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left[ \begin{array}{cc} \mathbf{H} &amp; \vec{g} \\ \vec{g}^T &amp; 0 \end{array} \right] \left[ \begin{array}{c} \vec{x} \\ 1 \end{array} \right] = \alpha \left[ \begin{array}{c} \vec{x} \\ 1 \end{array} \right]. \]" src="form_30.png"/>
</p>
<p> The eigenvector with smallest algebraic eigenvalue determines a stable update <img class="formulaInl" alt="$\vec{x}$" src="form_19.png"/>, as is well explained in Ref. [CAS7].</p>
<p>As a final remark in this section, I would like to say that orbitals have gauge freedom. One can always multiply them with a phase factor. It is therefore possible to choose the orbital gauges so that all <img class="formulaInl" alt="$\mathbf{U}$" src="form_31.png"/> are always special orthogonal: <img class="formulaInl" alt="$\det(\mathbf{U})=+1$" src="form_32.png"/>.</p>
<h1><a class="anchor" id="diis"></a>
Direct inversion of the iterative subspace (DIIS)</h1>
<p>When the update norm <img class="formulaInl" alt="$\|\vec{x}\|_2$" src="form_33.png"/> is small enough, the convergence can be accelerated by the direct inversion of the iterative subspace (<a class="el" href="classCheMPS2_1_1DIIS.html">DIIS</a>) [CAS5, CAS8, CAS9, CAS10]. For a given set of orbitals <img class="formulaInl" alt="$\mathbf{U}(n)$" src="form_28.png"/>, the update <img class="formulaInl" alt="$\vec{x}(n)$" src="form_34.png"/> is calculated with the augmented Hessian Newton-Raphson method. This update defines the next set of orbitals: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathbf{U}(n+1) = \mathbf{U}_{add} \mathbf{U}(n) = \exp(\mathbf{X}(\vec{x}(n))) \mathbf{U}(n). \]" src="form_29.png"/>
</p>
<p> In <a class="el" href="classCheMPS2_1_1DIIS.html">DIIS</a>, the error vector <img class="formulaInl" alt="$\vec{x}(n)$" src="form_34.png"/> and the state vector <img class="formulaInl" alt="$\mathbf{Y}(n+1) = \log(\mathbf{U}(n+1))$" src="form_35.png"/> are added to a list. The error </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ e = \left\| \sum\limits_{i = 1}^{\kappa} c_i \vec{x}(n - \kappa + i) \right\|_2 \]" src="form_36.png"/>
</p>
<p> is minimized under the constraint <img class="formulaInl" alt="$\sum_{i} c_i = 1$" src="form_37.png"/>. <img class="formulaInl" alt="$\kappa$" src="form_38.png"/> is the size of the list memory, i.e. the number of retained vectors. The minimization of the error <img class="formulaInl" alt="$e$" src="form_39.png"/> can be performed with Lagrangian calculus: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left[ \begin{array}{cc} \mathbf{B} &amp; \vec{1} \\ \vec{1}^T &amp; 0 \end{array} \right] \left[ \begin{array}{c} \vec{c} \\ \lambda \end{array} \right] = \left[ \begin{array}{c} \vec{0} \\ 1 \end{array} \right], \]" src="form_40.png"/>
</p>
<p> where <img class="formulaInl" alt="$2\lambda$" src="form_41.png"/> is the Lagrangian multiplier and </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left[\mathbf{B}\right]_{ij} = \vec{x}^T(n - \kappa + i) \vec{x}(n - \kappa + j) = \left[\mathbf{B}\right]_{ji}. \]" src="form_42.png"/>
</p>
<p> The new state vector is then defined as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathbf{Y}_{new} = \sum\limits_{i = 1}^{\kappa} c_i \mathbf{Y}(n+1 - \kappa + i). \]" src="form_43.png"/>
</p>
<p> The new state vector <img class="formulaInl" alt="$\mathbf{Y}_{new}$" src="form_44.png"/> is calculated by the function <a class="el" href="classCheMPS2_1_1DIIS.html#ad8f60dd3e52d1d8a59c155c25a7ce3f3" title="Calculate the new parameter vector, based on the just appended error and parameter vectors...">CheMPS2::DIIS::calculateParam</a>. The current orbitals are then set to <img class="formulaInl" alt="$\mathbf{U}(n+1) = \exp(\mathbf{Y}_{new})$" src="form_45.png"/>.</p>
<h1><a class="anchor" id="biblio"></a>
References</h1>
<p>[CAS1] D. Zgid and M. Nooijen, Journal of Chemical Physics 128, 144115 (2008). <a href="http://dx.doi.org/10.1063/1.2883980">http://dx.doi.org/10.1063/1.2883980</a> <br />
[CAS2] D. Ghosh, J. Hachmann, T. Yanai and G.K.-L. Chan, Journal of Chemical Physics 128, 144117 (2008). <a href="http://dx.doi.org/10.1063/1.2883976">http://dx.doi.org/10.1063/1.2883976</a> <br />
[CAS3] P.E.M. Siegbahn, J. Almlof, A. Heiberg and B.O. Roos, Journal of Chemical Physics 74, 2384-2396 (1981). <a href="http://dx.doi.org/10.1063/1.441359">http://dx.doi.org/10.1063/1.441359</a> <br />
[CAS4] D. Zgid and M. Nooijen, Journal of Chemical Physics 128, 144116 (2008). <a href="http://dx.doi.org/10.1063/1.2883981">http://dx.doi.org/10.1063/1.2883981</a> <br />
[CAS5] T. Yanai, Y. Kurashige, D. Ghosh and G.K.-L. Chan, International Journal of Quantum Chemistry 109, 2178-2190 (2009). <a href="http://dx.doi.org/10.1002/qua.22099">http://dx.doi.org/10.1002/qua.22099</a> <br />
[CAS6] S. Wouters, W. Poelmans, P.W. Ayers and D. Van Neck, Computer Physics Communications 185, 1501-1514 (2014). <a href="http://dx.doi.org/10.1016/j.cpc.2014.01.019">http://dx.doi.org/10.1016/j.cpc.2014.01.019</a> <br />
[CAS7] A. Banerjee, N. Adams, J. Simons and R. Shepard, Journal of Physical Chemistry 89, 52-57 (1985). <a href="http://dx.doi.org/10.1021/j100247a015">http://dx.doi.org/10.1021/j100247a015</a> <br />
[CAS8] P. Pulay, Chemical Physics Letters 73, 393-398 (1980). <a href="http://dx.doi.org/10.1016/0009-2614(80)80396-4">http://dx.doi.org/10.1016/0009-2614(80)80396-4</a> <br />
[CAS9] C.D. Sherrill, Programming <a class="el" href="classCheMPS2_1_1DIIS.html">DIIS</a>, <a href="http://vergil.chemistry.gatech.edu/notes/diis/node3.html">http://vergil.chemistry.gatech.edu/notes/diis/node3.html</a> (2000). <br />
[CAS10] T. Rohwedder and R. Schneider, Journal of Mathematical Chemistry 49, 1889-1914 (2011). <a href="http://dx.doi.org/10.1007/s10910-011-9863-y">http://dx.doi.org/10.1007/s10910-011-9863-y</a> <br />
</p>

<p>Definition at line <a class="el" href="CASSCF_8h_source.html#l00163">163</a> of file <a class="el" href="CASSCF_8h_source.html">CASSCF.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ad2d958c7b1ca60b43f7aa5eaabeeb0b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CheMPS2::CASSCF::CASSCF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a> *&#160;</td>
          <td class="paramname"><em>ham_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>docc_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>socc_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nocc_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ndmrg_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nvirt_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ham_in</td><td><a class="el" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a> containing the matrix elements of the <a class="el" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a> for which a <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> calculation is desired </td></tr>
    <tr><td class="paramname">docc_in</td><td>Array containing the number of doubly occupied HF orbitals per irrep </td></tr>
    <tr><td class="paramname">socc_in</td><td>Array containing the number of singly occupied HF orbitals per irrep </td></tr>
    <tr><td class="paramname">nocc_in</td><td>Array containing the number of doubly occupied (inactive) orbitals per irrep </td></tr>
    <tr><td class="paramname">ndmrg_in</td><td>Array containing the number of active orbitals per irrep </td></tr>
    <tr><td class="paramname">nvirt_in</td><td>Array containing the number of virtual (secondary) orbitals per irrep </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00037">37</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_ad2d958c7b1ca60b43f7aa5eaabeeb0b1_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_ad2d958c7b1ca60b43f7aa5eaabeeb0b1_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_ad2d958c7b1ca60b43f7aa5eaabeeb0b1_cgraph" id="classCheMPS2_1_1CASSCF_ad2d958c7b1ca60b43f7aa5eaabeeb0b1_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1Hamiltonian.html#a101963cfa8f06abe798a7ae79faab618" title="Get the number of orbitals. " alt="" coords="281,5,440,47"/><area shape="rect" id="node3" href="classCheMPS2_1_1Irreps.html#aca6fdd79557f9189153258daad5fbe8c" title="Set the group. " alt="" coords="269,71,453,98"/><area shape="rect" id="node4" href="classCheMPS2_1_1Hamiltonian.html#a8c18f51ded63810e316f1834853dce21" title="Get the group number. " alt="" coords="281,123,440,164"/><area shape="rect" id="node5" href="classCheMPS2_1_1Irreps.html#afd3d1b65e870aad920125c05606c4a7d" title="Get the number of irreps for the currently activated group. " alt="" coords="263,188,458,229"/><area shape="rect" id="node6" href="classCheMPS2_1_1Irreps.html#a9813550797b0557cf22d2bca5f3e07b0" title="Get the group number. " alt="" coords="269,253,453,295"/><area shape="rect" id="node7" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="261,319,460,360"/><area shape="rect" id="node8" href="classCheMPS2_1_1DMRGSCFmatrix.html#a0729b05fef0cb96eaf26e7c8d6017931" title="Clear the matrix. " alt="" coords="263,384,458,425"/><area shape="rect" id="node9" href="classCheMPS2_1_1DMRGSCFindices.html#a9e59260eecdb760a58464e330b313928" title="Print my contents. " alt="" coords="261,449,460,491"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="abf34a3243a38979439e7aa2d9e60c4dd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::augmentedHessianNR </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localFmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFwtilde.html">DMRGSCFwtilde</a> *&#160;</td>
          <td class="paramname"><em>localwtilde</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>localIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFunitary.html">DMRGSCFunitary</a> *&#160;</td>
          <td class="paramname"><em>localUmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>theupdate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>updateNorm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>gradNorm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the augmented Hessian Newton-Raphson update for the orthogonal orbital rotation matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">localFmat</td><td>Matrix which contains the Fock operator (Eq. (11) in the Siegbahn paper [CAS3]) </td></tr>
    <tr><td class="paramname">localwtilde</td><td>Object which contains the second order derivative of the energy with respect to the unitary (Eq. (20b) in the Siegbahn paper [CAS3]) </td></tr>
    <tr><td class="paramname">localIdx</td><td>Orbital index bookkeeper for the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> calculations </td></tr>
    <tr><td class="paramname">localUmat</td><td>The unitary matrix for <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> calculations (in this function it is used to fetch the orbital ordering convention of the skew-symmetric parametrization) </td></tr>
    <tr><td class="paramname">theupdate</td><td>Where the augmented Hessian Newton-Raphson update will be stored </td></tr>
    <tr><td class="paramname">updateNorm</td><td>Pointer to one double to store the update norm </td></tr>
    <tr><td class="paramname">gradNorm</td><td>Pointer to one double to store the gradient norm </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCFnewtonraphson_8cpp_source.html#l00260">260</a> of file <a class="el" href="CASSCFnewtonraphson_8cpp_source.html">CASSCFnewtonraphson.cpp</a>.</p>

<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_abf34a3243a38979439e7aa2d9e60c4dd_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_abf34a3243a38979439e7aa2d9e60c4dd_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_abf34a3243a38979439e7aa2d9e60c4dd_cgraph" id="classCheMPS2_1_1CASSCF_abf34a3243a38979439e7aa2d9e60c4dd_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFunitary.html#a725cdfa70964b24914436fc40bba90b4" title="Get the number of variables in the x&#45;parametrization of the unitary update. " alt="" coords="271,5,468,47"/><area shape="rect" id="node3" href="classCheMPS2_1_1Davidson.html#a2ae39a55a30271ae6f5d46b52df3d991" title="The iterator to converge the ground state vector. " alt="" coords="293,71,446,112"/><area shape="rect" id="node4" href="classCheMPS2_1_1Davidson.html#a0a9f07122a47a4ec24e6add4b8b30797" title="Get the number of matrix vector multiplications which have been performed. " alt="" coords="292,136,447,177"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a06428c029b80277b00a735ea673c147f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::block_diagonalize </td>
          <td>(</td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>space</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>Mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFunitary.html">DMRGSCFunitary</a> *&#160;</td>
          <td class="paramname"><em>Umat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>work1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>work2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>invert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>localDMRG2RDM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Block-diagonalize Mat. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">space</td><td>Can be 'O', 'A', or 'V' and denotes which block of Mat should be considered </td></tr>
    <tr><td class="paramname">Mat</td><td>Matrix to block-diagonalize </td></tr>
    <tr><td class="paramname">Umat</td><td>The unitary rotation will be updated so that Mat is block-diagonal in the orbitals 'space' </td></tr>
    <tr><td class="paramname">work1</td><td>Workspace </td></tr>
    <tr><td class="paramname">work2</td><td>Workspace </td></tr>
    <tr><td class="paramname">idx</td><td>Object which handles the index conventions for <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> </td></tr>
    <tr><td class="paramname">invert</td><td>If true, the eigenvectors are sorted from large to small instead of the other way around </td></tr>
    <tr><td class="paramname">localDMRG2RDM</td><td>If not NULL, this 2-RDM-type array will be rotated to the new eigenvecs </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00404">404</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a06428c029b80277b00a735ea673c147f_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a06428c029b80277b00a735ea673c147f_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a06428c029b80277b00a735ea673c147f_cgraph" id="classCheMPS2_1_1CASSCF_a06428c029b80277b00a735ea673c147f_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="248,5,447,47"/><area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="248,71,447,112"/><area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="248,136,447,177"/><area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="248,201,447,243"/><area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="248,267,447,308"/><area shape="rect" id="node7" href="classCheMPS2_1_1DMRGSCFindices.html#afdbe42f60924d9fb705cce44426d72d0" title="Get the number of virtual orbitals for an irrep. " alt="" coords="248,332,447,373"/><area shape="rect" id="node8" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9" title="Get an element. " alt="" coords="237,398,457,425"/><area shape="rect" id="node9" href="classCheMPS2_1_1DMRGSCFunitary.html#a7ca4dead16809cd2a896c1a05b92fc0b" title="Get the unitary rotation for block irrep. " alt="" coords="249,449,446,491"/></map>
</div>
</p>

<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a06428c029b80277b00a735ea673c147f_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a06428c029b80277b00a735ea673c147f_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a06428c029b80277b00a735ea673c147f_icgraph" id="classCheMPS2_1_1CASSCF_a06428c029b80277b00a735ea673c147f_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#afabb84cda6961978c846fa8f18799a5e" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="237,13,429,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0210ff118bab44593aef7c6ec9f31a56"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::buildFmat </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localFmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localTmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localJKocc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localJKact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>localIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFintegrals.html">DMRGSCFintegrals</a> *&#160;</td>
          <td class="paramname"><em>theInts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>local2DM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>local1DM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build the F-matrix (Eq. (11) in the Siegbahn paper [CAS3]) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">localFmat</td><td>Matrix where the result should be stored </td></tr>
    <tr><td class="paramname">localTmat</td><td>Matrix which contains the one-electron integrals </td></tr>
    <tr><td class="paramname">localJKocc</td><td>Matrix which contains the Coulomb and exchange interaction due to the frozen core orbitals </td></tr>
    <tr><td class="paramname">localJKact</td><td>Matrix which contains the Coulomb and exchange interaction due to the active space </td></tr>
    <tr><td class="paramname">localIdx</td><td>Orbital index bookkeeper for the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> calculations </td></tr>
    <tr><td class="paramname">theInts</td><td>The rotated two-electron integrals (at most 2 virtual indices) </td></tr>
    <tr><td class="paramname">local2DM</td><td>The <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 2-RDM </td></tr>
    <tr><td class="paramname">local1DM</td><td>The <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 1-RDM </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCFnewtonraphson_8cpp_source.html#l00620">620</a> of file <a class="el" href="CASSCFnewtonraphson_8cpp_source.html">CASSCFnewtonraphson.cpp</a>.</p>

<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_cgraph" id="classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFmatrix.html#a0729b05fef0cb96eaf26e7c8d6017931" title="Clear the matrix. " alt="" coords="277,5,471,47"/><area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="275,71,473,112"/><area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="275,136,473,177"/><area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="275,201,473,243"/><area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="275,267,473,308"/><area shape="rect" id="node7" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="275,332,473,373"/><area shape="rect" id="node8" href="classCheMPS2_1_1DMRGSCFmatrix.html#a3660ff17cbeb278c265b6461450b1a24" title="Set an element. " alt="" coords="264,398,484,425"/><area shape="rect" id="node9" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9" title="Get an element. " alt="" coords="264,449,484,475"/><area shape="rect" id="node10" href="classCheMPS2_1_1DMRGSCFmatrix.html#a230d9fa54109d0754a054868611177c5" title="Get a matrix block. " alt="" coords="277,500,471,541"/><area shape="rect" id="node11" href="classCheMPS2_1_1Irreps.html#a1d86c7a8b3c3a7b9215c0e298f0ae047" title="Get the direct product of the irreps with numbers Irrep1 and Irrep2: a bitwise XOR for psi4&#39;s convent..." alt="" coords="532,595,723,622"/><area shape="rect" id="node12" href="classCheMPS2_1_1DMRGSCFintegrals.html#ad462dfa92d77f1f02371f12e91cac429" title="Get a two&#45;body matrix element with at most 2 virtual indices, using the FourIndex API..." alt="" coords="271,617,477,659"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a21471f166b873029b5e51dda4a6907c4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::buildWtilde </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFwtilde.html">DMRGSCFwtilde</a> *&#160;</td>
          <td class="paramname"><em>localwtilde</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localTmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localJKocc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localJKact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>localIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFintegrals.html">DMRGSCFintegrals</a> *&#160;</td>
          <td class="paramname"><em>theInts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>local2DM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>local1DM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build the Wtilde-matrix (Eq. (20b) in the Siegbahn paper [CAS3]) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">localwtilde</td><td>Where the result should be stored </td></tr>
    <tr><td class="paramname">localTmat</td><td>Matrix which contains the one-electron integrals </td></tr>
    <tr><td class="paramname">localJKocc</td><td>Matrix which contains the Coulomb and exchange interaction due to the frozen core orbitals </td></tr>
    <tr><td class="paramname">localJKact</td><td>Matrix which contains the Coulomb and exchange interaction due to the active space </td></tr>
    <tr><td class="paramname">localIdx</td><td>Orbital index bookkeeper for the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> calculations </td></tr>
    <tr><td class="paramname">theInts</td><td>The rotated two-electron integrals (at most 2 virtual indices) </td></tr>
    <tr><td class="paramname">local2DM</td><td>The <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 2-RDM </td></tr>
    <tr><td class="paramname">local1DM</td><td>The <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 1-RDM </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCFnewtonraphson_8cpp_source.html#l00408">408</a> of file <a class="el" href="CASSCFnewtonraphson_8cpp_source.html">CASSCFnewtonraphson.cpp</a>.</p>

<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_cgraph" id="classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFwtilde.html#a939e077b9fcc8ffafd9a168056991795" title="Clear. " alt="" coords="285,5,477,47"/><area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="281,71,480,112"/><area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="281,136,480,177"/><area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="281,201,480,243"/><area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="281,267,480,308"/><area shape="rect" id="node7" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="281,332,480,373"/><area shape="rect" id="node8" href="classCheMPS2_1_1DMRGSCFwtilde.html#a1315dead44fb4c153c1e93758f048378" title="Get the (pr) subblock of w_tilde_pqrs, which is stored as w_tilde[ I_pq ][ I_rs ][ p + ( Nocc[I_pq] +..." alt="" coords="285,397,477,439"/><area shape="rect" id="node9" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9" title="Get an element. " alt="" coords="271,463,491,490"/><area shape="rect" id="node10" href="classCheMPS2_1_1Irreps.html#a1d86c7a8b3c3a7b9215c0e298f0ae047" title="Get the direct product of the irreps with numbers Irrep1 and Irrep2: a bitwise XOR for psi4&#39;s convent..." alt="" coords="539,543,729,570"/><area shape="rect" id="node11" href="classCheMPS2_1_1DMRGSCFintegrals.html#ad462dfa92d77f1f02371f12e91cac429" title="Get a two&#45;body matrix element with at most 2 virtual indices, using the FourIndex API..." alt="" coords="277,565,484,607"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afabb84cda6961978c846fa8f18799a5e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CheMPS2::CASSCF::caspt2 </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nelectrons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>TwoS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Irrep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1ConvergenceScheme.html">ConvergenceScheme</a> *&#160;</td>
          <td class="paramname"><em>OptScheme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rootNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFoptions.html">DMRGSCFoptions</a> *&#160;</td>
          <td class="paramname"><em>theDMRGSCFoptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>IPEA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>IMAG</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the caspt2 correction energy for a converged casscf wavefunction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Nelectrons</td><td>Total number of electrons in the system: occupied HF orbitals + active space </td></tr>
    <tr><td class="paramname">TwoS</td><td>Twice the targeted spin </td></tr>
    <tr><td class="paramname">Irrep</td><td>Desired wave-function irrep </td></tr>
    <tr><td class="paramname">OptScheme</td><td>The optimization scheme to run the inner <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> loop. If NULL: use <a class="el" href="classCheMPS2_1_1FCI.html">FCI</a> instead of <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a>. </td></tr>
    <tr><td class="paramname">rootNum</td><td>Denotes the targeted state in state-specific <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a>; 1 means ground state, 2 first excited state etc. </td></tr>
    <tr><td class="paramname">theDMRGSCFoptions</td><td>Contains the DMRGSCF options </td></tr>
    <tr><td class="paramname">IPEA</td><td>The <a class="el" href="classCheMPS2_1_1CASPT2.html">CASPT2</a> IPEA shift from Ghigo, Roos and Malmqvist, Chemical Physics Letters 396, 142-149 (2004) </td></tr>
    <tr><td class="paramname">IMAG</td><td>The <a class="el" href="classCheMPS2_1_1CASPT2.html">CASPT2</a> imaginary shift from Forsberg and Malmqvist, Chemical Physics Letters 274, 196-204 (1997) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The <a class="el" href="classCheMPS2_1_1CASPT2.html">CASPT2</a> variational correction energy </dd></dl>

<p>Definition at line <a class="el" href="CASSCFpt2_8cpp_source.html#l00042">42</a> of file <a class="el" href="CASSCFpt2_8cpp_source.html">CASSCFpt2.cpp</a>.</p>

<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_afabb84cda6961978c846fa8f18799a5e_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_afabb84cda6961978c846fa8f18799a5e_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_afabb84cda6961978c846fa8f18799a5e_cgraph" id="classCheMPS2_1_1CASSCF_afabb84cda6961978c846fa8f18799a5e_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFindices.html#a2cb6c31a775d6f155942dc127eee2218" title="Get the total number of occupied orbitals. " alt="" coords="271,72,470,113"/><area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#ade657fa7e0ebf49098f5d22172a0dc01" title="Get the maximum NORB. " alt="" coords="271,137,470,179"/><area shape="rect" id="node4" href="classCheMPS2_1_1CASSCF.html#a10b37b294f7573005a6b49b669e734ca" title="Construct the Fock matrix. " alt="" coords="251,254,490,281"/><area shape="rect" id="node9" href="classCheMPS2_1_1CASSCF.html#a06428c029b80277b00a735ea673c147f" title="Block&#45;diagonalize Mat. " alt="" coords="279,371,463,412"/><area shape="rect" id="node15" href="classCheMPS2_1_1Irreps.html#a9813550797b0557cf22d2bca5f3e07b0" title="Get the group number. " alt="" coords="279,1684,463,1725"/><area shape="rect" id="node16" href="classCheMPS2_1_1DMRGSCFindices.html#ae04eb205d9aa13edaae834e535c3396d" title="Get an array with the irreps of each DMRG orbital. " alt="" coords="271,1749,470,1791"/><area shape="rect" id="node17" href="classCheMPS2_1_1DMRGSCFVmatRotations.html#a1d27c8247099602644c423e8dc4f073a" title="Fill the rotated two&#45;body matrix elements of HamDMRG, based on HamOrig and unitary. Cut the blocks into chunks with linear size maxBlockSize. " alt="" coords="549,5,794,47"/><area shape="rect" id="node21" href="classCheMPS2_1_1DMRGSCFVmatRotations.html#a1a3bd9b8094b6dc6a274c02bc8caf835" title="Fill the rotated two&#45;body matrix elements of HamDMRG, based on HamOrig and unitary. Do entire blocks at once. " alt="" coords="549,684,794,725"/><area shape="rect" id="node22" href="classCheMPS2_1_1FCI.html#a6e153d335d6500f4758212e203f7d682" title="Getter for the number of variables in the vector &quot; E_ij | FCI vector &gt; &quot; ; where irrep_center = I_i x..." alt="" coords="271,1815,471,1842"/><area shape="rect" id="node23" href="classCheMPS2_1_1FCI.html#a030bc8d72d2f0c1fcaf570ab397c49a9" title="Set the entries of a vector to zero. " alt="" coords="276,1866,465,1893"/><area shape="rect" id="node24" href="classCheMPS2_1_1FCI.html#a748644c42be72710e38631e169b642cc" title="Return the global counter of the Slater determinant with the lowest energy. " alt="" coords="269,1917,472,1959"/><area shape="rect" id="node25" href="classCheMPS2_1_1FCI.html#a9fba49f1eba2366bd5a26d6d5521c8e8" title="Calculates the FCI ground state with Davidson&#39;s algorithm. " alt="" coords="273,1983,468,2010"/><area shape="rect" id="node28" href="classCheMPS2_1_1FCI.html#a36e81090d6d9c12eb8e86f65ce1e66b4" title="Construct the (spin&#45;summed) 2&#45;RDM of a FCI vector: Gamma^2(i,j,k,l) = sum_sigma,tau &lt; a^+_i..." alt="" coords="283,2034,458,2061"/><area shape="rect" id="node29" href="classCheMPS2_1_1FCI.html#a46c8a713121b5554e76ffdd640450e2d" title="Construct the (spin&#45;summed) 3&#45;RDM of a FCI vector: Gamma^3(i,j,k,l,m,n) = sum_sigma,tau,s &lt; a^+_{i,sigma} a^+_{j,tau} a^+_{k,s} a_{n,s} a_{m,tau} a_{l,sigma} &gt; = ThreeRDM[ i + L * ( j + L * ( k + L * ( l + L * ( m + L * n ) ) ) ) ]. " alt="" coords="283,2085,458,2111"/><area shape="rect" id="node30" href="classCheMPS2_1_1CASSCF.html#a94cd26ccbe91c6549d64735ee2c75beb" title="Construct the 1&#45;RDM from the 2&#45;RDM. " alt="" coords="251,2135,491,2162"/><area shape="rect" id="node31" href="classCheMPS2_1_1CASSCF.html#a3f20d25b94c1d821f22f95a6bab0ebc7" title="Copy a one&#45;orbital quantity from array format to DMRGSCFmatrix format. " alt="" coords="280,488,461,529"/><area shape="rect" id="node33" href="classCheMPS2_1_1FCI.html#a91869efdf5f581c444c69627bd3b593a" title="Construct the (spin&#45;summed) contraction of the 4&#45;RDM with the Fock operator: output(i,j,k,p,q,r) = sum_{l,t} Fock(l,t) * Gamma^4(i,j,k,l,p,q,r,t) " alt="" coords="277,2186,464,2213"/><area shape="rect" id="node34" href="classCheMPS2_1_1DMRG.html#acfb3123c72e3503f2d6c77dcf9eb141a" title="Push back current calculation and set everything up to calculate a (new) excitation. " alt="" coords="260,1582,481,1609"/><area shape="rect" id="node36" href="classCheMPS2_1_1DMRG.html#ab6d80dde8b71171ee969a6b7b86193d2" title="Solver. " alt="" coords="285,1633,457,1659"/><area shape="rect" id="node37" href="classCheMPS2_1_1DMRG.html#ab442cbc43e2e5d877660859578849133" title="Activate the necessary storage and machinery to handle excitations. " alt="" coords="245,2237,496,2263"/><area shape="rect" id="node38" href="classCheMPS2_1_1DMRG.html#a2f30a27d6a9acd3abe2c1092d6a4defb" title="Calculate the reduced density matrices and correlations. Afterwards the MPS is again in LLLLLLLC gaug..." alt="" coords="289,1516,452,1557"/><area shape="rect" id="node72" href="classCheMPS2_1_1CASSCF.html#ae8305d7f87c340f9001e497aaf7ba93f" title="Copy over the DMRG 2&#45;RDM. " alt="" coords="253,2287,488,2314"/><area shape="rect" id="node74" href="classCheMPS2_1_1DMRG.html#a0b471ea7ea19f7a49e6e1412f443d5ac" title="Get the pointer to the 2&#45;RDM. " alt="" coords="278,2338,463,2365"/><area shape="rect" id="node75" href="classCheMPS2_1_1DMRG.html#a99a945eeb2a338a4d1a87dcbcad576ee" title="After the 3&#45;RDM has been calculated, the 4&#45;RDM terms Gamma4_ijkz,pqrz (with z fixed) can be obtained..." alt="" coords="269,2389,473,2415"/><area shape="rect" id="node76" href="classCheMPS2_1_1CASSCF.html#ac78aeef75d0a83c75030080c8d1033e7" title="Copy over the DMRG 3&#45;RDM. " alt="" coords="253,2439,488,2466"/><area shape="rect" id="node78" href="classCheMPS2_1_1DMRG.html#ae87028e0d13f774aa31d5b41978e6aa4" title="Get the pointer to the 3&#45;RDM. " alt="" coords="278,2490,463,2517"/><area shape="rect" id="node79" href="classCheMPS2_1_1DMRG.html#a0f4e487c40f522846288fe1b3d55e66c" title="Call &quot;rm &quot; + CheMPS2::DMRG_MPS_storage_prefix + &quot;*.h5&quot;. " alt="" coords="250,2541,491,2567"/><area shape="rect" id="node80" href="classCheMPS2_1_1DMRG.html#a2254cc31b5d9497694ea2229226b7bd6" title="Call &quot;rm &quot; + tempfolder + &quot;/&quot; + CheMPS2::DMRG_OPERATOR_storage_prefix + string(thePID) + &quot;*..." alt="" coords="265,2592,477,2633"/><area shape="rect" id="node81" href="classCheMPS2_1_1DMRGSCFVmatRotations.html#ae8773f07770b03db7c70dc51fc78958e" title="Fill the rotated two&#45;body matrix elements with max. two virtual indices, based on HamOrig and unitary..." alt="" coords="549,749,794,791"/><area shape="rect" id="node86" href="classCheMPS2_1_1DMRGSCFVmatRotations.html#a86092727e466bea078911da301567093" title="Fill the rotated two&#45;body matrix elements with max. two virtual indices, based on HamOrig and unitary..." alt="" coords="549,815,794,856"/><area shape="rect" id="node87" href="classCheMPS2_1_1CASSCF.html#ad4c00cd4c21dc402ad5e966232b199d3" title="Return the RMS deviation from block&#45;diagonal. " alt="" coords="268,305,473,347"/><area shape="rect" id="node88" href="classCheMPS2_1_1CASPT2.html#aa0fce9d99059c2336e06180160de7bd2" title="Solve for the CASPT2 energy (note that the IPEA shift has been set in the constructor) ..." alt="" coords="280,2774,461,2801"/><area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="572,188,771,229"/><area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="572,71,771,112"/><area shape="rect" id="node7" href="classCheMPS2_1_1DMRGSCFmatrix.html#a3660ff17cbeb278c265b6461450b1a24" title="Set an element. " alt="" coords="561,254,781,281"/><area shape="rect" id="node8" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9" title="Get an element. " alt="" coords="561,137,781,163"/><area shape="rect" id="node10" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="572,553,771,595"/><area shape="rect" id="node11" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="572,371,771,412"/><area shape="rect" id="node12" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="572,488,771,529"/><area shape="rect" id="node13" href="classCheMPS2_1_1DMRGSCFindices.html#afdbe42f60924d9fb705cce44426d72d0" title="Get the number of virtual orbitals for an irrep. " alt="" coords="572,305,771,347"/><area shape="rect" id="node14" href="classCheMPS2_1_1DMRGSCFunitary.html#a7ca4dead16809cd2a896c1a05b92fc0b" title="Get the unitary rotation for block irrep. " alt="" coords="851,619,1049,660"/><area shape="rect" id="node18" href="classCheMPS2_1_1Irreps.html#a1d86c7a8b3c3a7b9215c0e298f0ae047" title="Get the direct product of the irreps with numbers Irrep1 and Irrep2: a bitwise XOR for psi4&#39;s convent..." alt="" coords="1101,998,1292,1025"/><area shape="rect" id="node19" href="classCheMPS2_1_1Hamiltonian.html#a2ddb391c8a20c50bdd2c775cffd8fbb1" title="Set a Vmat element. " alt="" coords="871,501,1029,543"/><area shape="rect" id="node20" href="classCheMPS2_1_1Hamiltonian.html#ab6147d890404000374bb96baba0b1f82" title="Add to Vmat element. " alt="" coords="871,251,1029,292"/><area shape="rect" id="node26" href="classCheMPS2_1_1Davidson.html#a2ae39a55a30271ae6f5d46b52df3d991" title="The iterator to converge the ground state vector. " alt="" coords="595,2519,748,2560"/><area shape="rect" id="node27" href="classCheMPS2_1_1Davidson.html#a0a9f07122a47a4ec24e6add4b8b30797" title="Get the number of matrix vector multiplications which have been performed. " alt="" coords="594,2584,749,2625"/><area shape="rect" id="node32" href="classCheMPS2_1_1DMRGSCFmatrix.html#a0729b05fef0cb96eaf26e7c8d6017931" title="Clear the matrix. " alt="" coords="574,619,769,660"/><area shape="rect" id="node35" href="classCheMPS2_1_1MPIchemps2.html#a6732ae60b5b4c8a4f1b063f9db304bf5" title="Get the rank of this MPI process. " alt="" coords="867,2241,1033,2283"/><area shape="rect" id="node39" href="classCheMPS2_1_1SyBookkeeper.html#ab06fa32f4e352d248ebfe67d850a574a" title="Get an orbital irrep. " alt="" coords="584,2183,759,2224"/><area shape="rect" id="node40" href="classCheMPS2_1_1Sobject.html#a687a29eab89ef3763af8c630b48e3bf6" title="Join two sites to form a composite S&#45;object. " alt="" coords="588,1731,755,1758"/><area shape="rect" id="node42" href="classCheMPS2_1_1Heff.html#a1075e481d1a1d12f09f791be7389d2f4" title="Davidson Solver. " alt="" coords="558,2249,785,2275"/><area shape="rect" id="node43" href="classCheMPS2_1_1Problem.html#a6c6f133286114da1666965c8048e47a1" title="Get the constant part of the Hamiltonian. " alt="" coords="574,2030,769,2057"/><area shape="rect" id="node45" href="classCheMPS2_1_1Sobject.html#a34983e86ae9f19de0be6b923479c13df" title="SVD an S&#45;object into 2 TensorT&#39;s. " alt="" coords="587,1214,755,1241"/><area shape="rect" id="node47" href="classCheMPS2_1_1ConvergenceScheme.html#abb766295f71d3c1e3b9edc875504b317" title="Get the number of renormalized states for a particular instruction. " alt="" coords="564,880,779,921"/><area shape="rect" id="node48" href="classCheMPS2_1_1ConvergenceScheme.html#ab8c98d5388c415c42115084c5817e1dc" title="Get the number of instructions. " alt="" coords="564,945,779,987"/><area shape="rect" id="node49" href="classCheMPS2_1_1TensorT.html#a1ee5bb57153170fc200acea0859a5ef9" title="Left&#45;normalization. " alt="" coords="588,1062,755,1089"/><area shape="rect" id="node51" href="classCheMPS2_1_1TwoDM.html#a5c5bf12b31aa9cb4b0b31bd53dad1ed3" title="Fill the 2DM terms with as second site index denT&#45;&gt;gIndex() " alt="" coords="579,2081,763,2107"/><area shape="rect" id="node53" href="classCheMPS2_1_1TensorT.html#abc507af3cebe59f0800c12db47bd9752" title="Right&#45;normalization. " alt="" coords="590,1113,753,1139"/><area shape="rect" id="node54" href="classCheMPS2_1_1TensorT.html#a06f61e76a7a6d46c1899141c75678aa8" title="Multiply at the right with a diagonal TensorOperator. " alt="" coords="560,1163,783,1190"/><area shape="rect" id="node55" href="classCheMPS2_1_1TwoDM.html#a520ebec8dd2e56a475105e651a98fec3" title="Add the 2&#45;RDM elements of all MPI processes. " alt="" coords="589,1265,754,1307"/><area shape="rect" id="node56" href="classCheMPS2_1_1TwoDM.html#a09eb9e2471fe7fb19659b611e3e4550b" title="After the whole 2&#45;RDM is filled, a prefactor for higher multiplicities should be applied. " alt="" coords="579,1331,763,1372"/><area shape="rect" id="node57" href="classCheMPS2_1_1SyBookkeeper.html#af39babd5df4cb5eeb84ffc017af841c3" title="Get the targeted particle number. " alt="" coords="571,1397,771,1423"/><area shape="rect" id="node58" href="classCheMPS2_1_1TwoDM.html#a5ea664bc3b45270494e3d6e9f8d52619" title="Return the double trace of 2DM&#45;A (should be N(N&#45;1)) " alt="" coords="585,1447,758,1474"/><area shape="rect" id="node59" href="classCheMPS2_1_1TwoDM.html#ab35662dd77d8ae32f5b28bbe04239e79" title="Calculate the energy based on the 2DM&#45;A. " alt="" coords="580,1498,763,1525"/><area shape="rect" id="node60" href="classCheMPS2_1_1TwoDM.html#ac24a417e0cd64e7c3a82c94ba1d9d71c" title="Print the natural orbital occupation numbers. " alt="" coords="569,1549,773,1575"/><area shape="rect" id="node61" href="classCheMPS2_1_1ThreeDM.html#a41f377c3636898276dcb6c2f30dbf3ad" title="Fill the 3&#45;RDM terms corresponding to site denT&#45;&gt;gIndex() " alt="" coords="575,2467,768,2494"/><area shape="rect" id="node64" href="classCheMPS2_1_1TensorT.html#a88c0e7491c53ff6ba5a737a380df188b" title="Multiply at the left with a diagonal TensorOperator. " alt="" coords="565,1011,778,1038"/><area shape="rect" id="node65" href="classCheMPS2_1_1Correlations.html#ad0628c1674123410d212401e14812964" title="Fill at the current step of the iterations the two&#45;orbital mutual information and the remaining part ..." alt="" coords="591,2300,751,2341"/><area shape="rect" id="node66" href="classCheMPS2_1_1Correlations.html#ae175e3599bab50c3fe334e3a98c41f23" title="Broadcast the diradical correlation function and the two&#45;orbital mutual information. " alt="" coords="591,1600,751,1641"/><area shape="rect" id="node67" href="classCheMPS2_1_1ThreeDM.html#acceb29cbf3244a2fee196f36c87589a7" title="Add the 3&#45;RDM elements of all MPI processes. " alt="" coords="585,1665,758,1707"/><area shape="rect" id="node68" href="classCheMPS2_1_1ThreeDM.html#a0a3de81e9881218690e26094be30b749" title="After the whole 3&#45;RDM is filled, a prefactor for higher multiplicities should be applied. " alt="" coords="575,1783,767,1824"/><area shape="rect" id="node69" href="classCheMPS2_1_1Correlations.html#a1cf618a098e75511dda2fb0d010dab2e" title="Get the single&#45;orbital entropy for a certain site, using hte HAM indices. " alt="" coords="578,1848,765,1889"/><area shape="rect" id="node70" href="classCheMPS2_1_1Correlations.html#a3e4a935011b95ad18b28b88ac56990fc" title="Return Idistance(power) (see return for definition) " alt="" coords="578,1913,765,1955"/><area shape="rect" id="node71" href="classCheMPS2_1_1ThreeDM.html#a425345a7f5aa3a635e4a6eb7d1b3cec4" title="Return the trace (should be N(N&#45;1)(N&#45;2)) " alt="" coords="581,1979,762,2006"/><area shape="rect" id="node41" href="classCheMPS2_1_1TensorT.html#aafb4d43ad6178437b47a32a24c375fa3" title="Get the pointer to the storage. " alt="" coords="851,1369,1049,1395"/><area shape="rect" id="node44" href="classCheMPS2_1_1Hamiltonian.html#a031fa6987b304e3a7f6114b9f2e1f2ab" title="Get the constant energy. " alt="" coords="871,2015,1029,2056"/><area shape="rect" id="node46" href="classCheMPS2_1_1TensorT.html#a1f0830b0e729573fe19a3327462f7e7e" title="Reset the TensorT (if virtual dimensions are changed) " alt="" coords="859,1163,1041,1190"/><area shape="rect" id="node50" href="classCheMPS2_1_1Tensor.html#a2f17a5413447e77ad3f128d49b3ca676" title="Get the pointer to the storage. " alt="" coords="855,1087,1045,1114"/><area shape="rect" id="node52" href="classCheMPS2_1_1TensorT.html#a279b51f0616ab58f2a2893681b4cab71" title="Get the location index. " alt="" coords="857,2307,1043,2334"/><area shape="rect" id="node62" href="classCheMPS2_1_1TensorOperator.html#a0c347c3df77117eb3e6340ce032fb3b7" title="Make the in&#45;product of two TensorOperator. " alt="" coords="860,2476,1040,2517"/><area shape="rect" id="node63" href="classCheMPS2_1_1Tensor3RDM.html#abce2935d5e3293bbfbd39c7b78b4705e" title="Make the in&#45;product of two Tensor3RDMs. " alt="" coords="866,2359,1034,2400"/><area shape="rect" id="node73" href="classCheMPS2_1_1TwoDM.html#a40c2181006aaf66b8dad2e545e3d8186" title="Get a 2DM_A term, using the HAM indices. " alt="" coords="544,2650,799,2677"/><area shape="rect" id="node77" href="classCheMPS2_1_1ThreeDM.html#ae3a0de0da6659adca36ea0cdae16da0e" title="Get a 3&#45;RDM, using the HAM indices. " alt="" coords="586,2701,757,2743"/><area shape="rect" id="node82" href="classCheMPS2_1_1DMRGSCFintegrals.html#ac9c1b2d0d67b2beb246ce3c59b193177" title="Set an element of the Coulomb object ( c1 c2 | a1 a2 ) " alt="" coords="847,867,1053,908"/><area shape="rect" id="node83" href="classCheMPS2_1_1DMRGSCFintegrals.html#ab3a4b266923e8188ac73d49aa2acb90a" title="Add a double to an element of the Coulomb object ( c1 c2 | a1 a2 ) " alt="" coords="847,749,1053,791"/><area shape="rect" id="node84" href="classCheMPS2_1_1DMRGSCFintegrals.html#af910b76a44cdbde6cdffc1750705fdb9" title="Set an element of the Exchange object ( c1 v1 | c2 v2 ) " alt="" coords="847,932,1053,973"/><area shape="rect" id="node85" href="classCheMPS2_1_1DMRGSCFintegrals.html#a57d2abf30dfa50a715d7fffcb3987674" title="Add a double to an element of the Exchange object ( c1 v1 | c2 v2 ) " alt="" coords="847,684,1053,725"/><area shape="rect" id="node89" href="classCheMPS2_1_1ConjugateGradient.html#a37f5465c918d5d922fc5b108ab29f6ea" title="The iterator to converge the ground state vector. " alt="" coords="572,2767,771,2808"/><area shape="rect" id="node90" href="classCheMPS2_1_1ConjugateGradient.html#afe8c8a3af798ce7a300cbb88dc57e3f4" title="Get the number of matrix vector multiplications which have been performed. " alt="" coords="572,2832,771,2873"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a10b37b294f7573005a6b49b669e734ca"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::construct_fock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>Fock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>Tmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>Qocc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>Qact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct the Fock matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Fock</td><td>Matrix to store the Fock operator in </td></tr>
    <tr><td class="paramname">Tmat</td><td>Matrix with the one-electron integrals </td></tr>
    <tr><td class="paramname">Qocc</td><td>Matrix with the Coulomb and exchange contributions of the occupied (inactive) orbitals </td></tr>
    <tr><td class="paramname">Qact</td><td>Matrix with the Coulomb and exchange contributions of the active space orbitals </td></tr>
    <tr><td class="paramname">idx</td><td>Object which handles the index conventions for <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCFpt2_8cpp_source.html#l00161">161</a> of file <a class="el" href="CASSCFpt2_8cpp_source.html">CASSCFpt2.cpp</a>.</p>

<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a10b37b294f7573005a6b49b669e734ca_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a10b37b294f7573005a6b49b669e734ca_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a10b37b294f7573005a6b49b669e734ca_cgraph" id="classCheMPS2_1_1CASSCF_a10b37b294f7573005a6b49b669e734ca_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="303,5,501,47"/><area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="303,71,501,112"/><area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFmatrix.html#a3660ff17cbeb278c265b6461450b1a24" title="Set an element. " alt="" coords="292,137,512,163"/><area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9" title="Get an element. " alt="" coords="292,187,512,214"/></map>
</div>
</p>

<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a10b37b294f7573005a6b49b669e734ca_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a10b37b294f7573005a6b49b669e734ca_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a10b37b294f7573005a6b49b669e734ca_icgraph" id="classCheMPS2_1_1CASSCF_a10b37b294f7573005a6b49b669e734ca_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#afabb84cda6961978c846fa8f18799a5e" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="292,5,484,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae8305d7f87c340f9001e497aaf7ba93f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::copy2DMover </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1TwoDM.html">TwoDM</a> *&#160;</td>
          <td class="paramname"><em>theDMRG2DM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>totOrbDMRG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>localDMRG2DM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy over the <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 2-RDM. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">theDMRG2DM</td><td>The 2-RDM from the <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> object </td></tr>
    <tr><td class="paramname">totOrbDMRG</td><td>The total number of <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> orbitals </td></tr>
    <tr><td class="paramname">localDMRG2DM</td><td>The <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> 2-RDM </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00116">116</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_ae8305d7f87c340f9001e497aaf7ba93f_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_ae8305d7f87c340f9001e497aaf7ba93f_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_ae8305d7f87c340f9001e497aaf7ba93f_cgraph" id="classCheMPS2_1_1CASSCF_ae8305d7f87c340f9001e497aaf7ba93f_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1TwoDM.html#a40c2181006aaf66b8dad2e545e3d8186" title="Get a 2DM_A term, using the HAM indices. " alt="" coords="288,5,543,32"/></map>
</div>
</p>

<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_ae8305d7f87c340f9001e497aaf7ba93f_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_ae8305d7f87c340f9001e497aaf7ba93f_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_ae8305d7f87c340f9001e497aaf7ba93f_icgraph" id="classCheMPS2_1_1CASSCF_ae8305d7f87c340f9001e497aaf7ba93f_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#afabb84cda6961978c846fa8f18799a5e" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="288,5,480,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac78aeef75d0a83c75030080c8d1033e7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::copy3DMover </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1ThreeDM.html">ThreeDM</a> *&#160;</td>
          <td class="paramname"><em>theDMRG3DM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>numL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>three_dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy over the <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 3-RDM. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">theDMRG3DM</td><td>The 3-RDM from the <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> object </td></tr>
    <tr><td class="paramname">numL</td><td>The total number of <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> orbitals </td></tr>
    <tr><td class="paramname">three_dm</td><td>The <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> 3-RDM </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00131">131</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_ac78aeef75d0a83c75030080c8d1033e7_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_ac78aeef75d0a83c75030080c8d1033e7_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_ac78aeef75d0a83c75030080c8d1033e7_cgraph" id="classCheMPS2_1_1CASSCF_ac78aeef75d0a83c75030080c8d1033e7_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1ThreeDM.html#ae3a0de0da6659adca36ea0cdae16da0e" title="Get a 3&#45;RDM, using the HAM indices. " alt="" coords="288,5,459,47"/></map>
</div>
</p>

<p><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_ac78aeef75d0a83c75030080c8d1033e7_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_ac78aeef75d0a83c75030080c8d1033e7_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_ac78aeef75d0a83c75030080c8d1033e7_icgraph" id="classCheMPS2_1_1CASSCF_ac78aeef75d0a83c75030080c8d1033e7_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#afabb84cda6961978c846fa8f18799a5e" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="288,5,480,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3f20d25b94c1d821f22f95a6bab0ebc7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::copy_active </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>one_rdm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy a one-orbital quantity from array format to <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">origin</td><td>Array to copy </td></tr>
    <tr><td class="paramname">result</td><td><a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> to store the copy </td></tr>
    <tr><td class="paramname">idx</td><td>Object which handles the index conventions for <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> </td></tr>
    <tr><td class="paramname">one_rdm</td><td>If true, the occupied orbitals get occupation 2 </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00346">346</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a3f20d25b94c1d821f22f95a6bab0ebc7_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a3f20d25b94c1d821f22f95a6bab0ebc7_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a3f20d25b94c1d821f22f95a6bab0ebc7_cgraph" id="classCheMPS2_1_1CASSCF_a3f20d25b94c1d821f22f95a6bab0ebc7_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFmatrix.html#a0729b05fef0cb96eaf26e7c8d6017931" title="Clear the matrix. " alt="" coords="247,5,442,47"/><area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="245,71,444,112"/><area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="245,136,444,177"/><area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="245,201,444,243"/><area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="245,267,444,308"/><area shape="rect" id="node7" href="classCheMPS2_1_1DMRGSCFmatrix.html#a3660ff17cbeb278c265b6461450b1a24" title="Set an element. " alt="" coords="235,333,455,359"/></map>
</div>
</p>

<p><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a3f20d25b94c1d821f22f95a6bab0ebc7_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a3f20d25b94c1d821f22f95a6bab0ebc7_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a3f20d25b94c1d821f22f95a6bab0ebc7_icgraph" id="classCheMPS2_1_1CASSCF_a3f20d25b94c1d821f22f95a6bab0ebc7_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#afabb84cda6961978c846fa8f18799a5e" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="235,13,427,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a53a0c4f5043fd2494f8825cb43578fa7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::copy_active </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy a one-orbital quantity from <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> format to array format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">origin</td><td><a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> to copy </td></tr>
    <tr><td class="paramname">result</td><td>Array to store the copy </td></tr>
    <tr><td class="paramname">idx</td><td>Object which handles the index conventions for <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00378">378</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a53a0c4f5043fd2494f8825cb43578fa7_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a53a0c4f5043fd2494f8825cb43578fa7_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a53a0c4f5043fd2494f8825cb43578fa7_cgraph" id="classCheMPS2_1_1CASSCF_a53a0c4f5043fd2494f8825cb43578fa7_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="245,5,444,47"/><area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="245,71,444,112"/><area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="245,136,444,177"/><area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="245,201,444,243"/><area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9" title="Get an element. " alt="" coords="235,267,455,294"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad4c00cd4c21dc402ad5e966232b199d3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double CheMPS2::CASSCF::deviation_from_blockdiag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the RMS deviation from block-diagonal. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>Matrix to be assessed </td></tr>
    <tr><td class="paramname">idx</td><td>Object which handles the index conventions for <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>RMS deviation from block-diagonal </dd></dl>

<p>Definition at line <a class="el" href="CASSCFpt2_8cpp_source.html#l00177">177</a> of file <a class="el" href="CASSCFpt2_8cpp_source.html">CASSCFpt2.cpp</a>.</p>

<p><div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_ad4c00cd4c21dc402ad5e966232b199d3_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_ad4c00cd4c21dc402ad5e966232b199d3_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_ad4c00cd4c21dc402ad5e966232b199d3_cgraph" id="classCheMPS2_1_1CASSCF_ad4c00cd4c21dc402ad5e966232b199d3_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="269,5,468,47"/><area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="269,71,468,112"/><area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9" title="Get an element. " alt="" coords="259,137,479,163"/><area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="269,188,468,229"/><area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFindices.html#afdbe42f60924d9fb705cce44426d72d0" title="Get the number of virtual orbitals for an irrep. " alt="" coords="269,253,468,295"/></map>
</div>
</p>

<p><div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_ad4c00cd4c21dc402ad5e966232b199d3_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_ad4c00cd4c21dc402ad5e966232b199d3_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_ad4c00cd4c21dc402ad5e966232b199d3_icgraph" id="classCheMPS2_1_1CASSCF_ad4c00cd4c21dc402ad5e966232b199d3_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#afabb84cda6961978c846fa8f18799a5e" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="259,13,451,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a258f11f16c7790c6943589633203c7e3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::fillLocalizedOrbitalRotations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFunitary.html">CheMPS2::DMRGSCFunitary</a> *&#160;</td>
          <td class="paramname"><em>unitary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">CheMPS2::DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>localIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>eigenvecs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>From an Edmiston-Ruedenberg active space rotation, fetch the eigenvectors and store them in eigenvecs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">unitary</td><td>The Edmiston-Ruedenberg active space rotation </td></tr>
    <tr><td class="paramname">localIdx</td><td>Object which handles the index conventions for <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> </td></tr>
    <tr><td class="paramname">eigenvecs</td><td>Where the eigenvectors are stored </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00164">164</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-18" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a258f11f16c7790c6943589633203c7e3_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a258f11f16c7790c6943589633203c7e3_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a258f11f16c7790c6943589633203c7e3_cgraph" id="classCheMPS2_1_1CASSCF_a258f11f16c7790c6943589633203c7e3_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="275,5,473,47"/><area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="275,71,473,112"/><area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="275,136,473,177"/><area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFunitary.html#a7ca4dead16809cd2a896c1a05b92fc0b" title="Get the unitary rotation for block irrep. " alt="" coords="275,201,473,243"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4ecba3101fed76c3ce03c23c6446a3f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CheMPS2::CASSCF::get_num_irreps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the number of irreps. </p>
<dl class="section return"><dt>Returns</dt><dd>The number of irreps </dd></dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00114">114</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a94cd26ccbe91c6549d64735ee2c75beb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::setDMRG1DM </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>num_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>numL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>localDMRG1DM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>localDMRG2DM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct the 1-RDM from the 2-RDM. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num_elec</td><td>The number of <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> active space electrons </td></tr>
    <tr><td class="paramname">numL</td><td>The total number of <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> orbitals </td></tr>
    <tr><td class="paramname">localDMRG1DM</td><td>The <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> 1-RDM </td></tr>
    <tr><td class="paramname">localDMRG2DM</td><td>The <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> 2-RDM </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00149">149</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-19" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a94cd26ccbe91c6549d64735ee2c75beb_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a94cd26ccbe91c6549d64735ee2c75beb_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a94cd26ccbe91c6549d64735ee2c75beb_icgraph" id="classCheMPS2_1_1CASSCF_a94cd26ccbe91c6549d64735ee2c75beb_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#afabb84cda6961978c846fa8f18799a5e" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="293,5,485,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad05bfb6ca9c76338ae436083e285cfa6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CheMPS2::CASSCF::solve </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nelectrons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>TwoS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Irrep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1ConvergenceScheme.html">ConvergenceScheme</a> *&#160;</td>
          <td class="paramname"><em>OptScheme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rootNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFoptions.html">DMRGSCFoptions</a> *&#160;</td>
          <td class="paramname"><em>theDMRGSCFoptions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Do the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> cycles with the augmented Hessian Newton-Raphson method. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Nelectrons</td><td>Total number of electrons in the system: occupied HF orbitals + active space </td></tr>
    <tr><td class="paramname">TwoS</td><td>Twice the targeted spin </td></tr>
    <tr><td class="paramname">Irrep</td><td>Desired wave-function irrep </td></tr>
    <tr><td class="paramname">OptScheme</td><td>The optimization scheme to run the inner <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> loop. If NULL: use <a class="el" href="classCheMPS2_1_1FCI.html">FCI</a> instead of <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a>. </td></tr>
    <tr><td class="paramname">rootNum</td><td>Denotes the targeted state in state-specific <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a>; 1 means ground state, 2 first excited state etc. </td></tr>
    <tr><td class="paramname">theDMRGSCFoptions</td><td>Contains the DMRGSCF options </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The converged DMRGSCF energy </dd></dl>

<p>Definition at line <a class="el" href="CASSCFnewtonraphson_8cpp_source.html#l00065">65</a> of file <a class="el" href="CASSCFnewtonraphson_8cpp_source.html">CASSCFnewtonraphson.cpp</a>.</p>

<p><div id="dynsection-20" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_ad05bfb6ca9c76338ae436083e285cfa6_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_ad05bfb6ca9c76338ae436083e285cfa6_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_ad05bfb6ca9c76338ae436083e285cfa6_cgraph" id="classCheMPS2_1_1CASSCF_ad05bfb6ca9c76338ae436083e285cfa6_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFoptions.html#a9f81d7a089fc4a239638d95d93c24099" title="Get which active space should be considered in the DMRG routine. " alt="" coords="263,5,463,47"/><area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFoptions.html#acea3d3f5a5abf8a4bdd509fc13a1a275" title="Get whether the Orbital Rotation checkpoint should be stored to disk. " alt="" coords="263,71,463,112"/><area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFoptions.html#a45fb0323c73651fb83f6856af5145e83" title="Get the Orbital Rotation checkpoint filename. " alt="" coords="263,136,463,177"/><area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFoptions.html#a208fba2b1dbb95bec171867d39917fc8" title="Get whether DIIS should be performed. " alt="" coords="263,201,463,243"/><area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFoptions.html#a59cdddf8451651c980aa49957c2897b5" title="Get whether the DIIS checkpoint should be stored to disk. " alt="" coords="263,267,463,308"/><area shape="rect" id="node7" href="classCheMPS2_1_1DMRGSCFoptions.html#ae4f2901cf992d1a4100367f002af786c" title="Get the DIIS checkpoint filename. " alt="" coords="263,332,463,373"/><area shape="rect" id="node8" href="classCheMPS2_1_1DMRGSCFoptions.html#a57ed7e22a351ad6fc1621ff95106040a" title="Get the number of DIIS update vectors which should be kept. " alt="" coords="263,397,463,439"/><area shape="rect" id="node9" href="classCheMPS2_1_1DIIS.html#a9a18331523e2455812e808f83072f3d8" title="Load the DIIS object from disk. " alt="" coords="275,463,451,490"/><area shape="rect" id="node10" href="classCheMPS2_1_1DMRGSCFoptions.html#a55ce3e1a48b8d977e53db9874c8fd7c6" title="Get the threshold for DMRGSCF convergence. " alt="" coords="263,515,463,556"/><area shape="rect" id="node11" href="classCheMPS2_1_1DIIS.html#ae08b4931a1ed04490fecb06618d26432" title="Append a new error and parameter vector. " alt="" coords="265,581,460,607"/><area shape="rect" id="node12" href="classCheMPS2_1_1DMRGSCFVmatRotations.html#a1d27c8247099602644c423e8dc4f073a" title="Fill the rotated two&#45;body matrix elements of HamDMRG, based on HamOrig and unitary. Cut the blocks into chunks with linear size maxBlockSize. " alt="" coords="536,473,781,515"/><area shape="rect" id="node17" href="classCheMPS2_1_1DMRGSCFVmatRotations.html#a1a3bd9b8094b6dc6a274c02bc8caf835" title="Fill the rotated two&#45;body matrix elements of HamDMRG, based on HamOrig and unitary. Do entire blocks at once. " alt="" coords="536,565,781,607"/><area shape="rect" id="node18" href="classCheMPS2_1_1EdmistonRuedenberg.html#af52e7bc01e8f31e9b605ec4130f0337c" title="Maximize the Edmiston&#45;Ruedenberg cost function. " alt="" coords="255,733,470,775"/><area shape="rect" id="node21" href="classCheMPS2_1_1DMRGSCFoptions.html#a874f361f6567bebf376a4d35095b4a98" title="Get whether the localization procedure should start from a random unitary. " alt="" coords="263,1135,463,1176"/><area shape="rect" id="node22" href="classCheMPS2_1_1EdmistonRuedenberg.html#ad73febba415f3bcbef367b587d5bcc0d" title="Permute the orbitals so that the bandwidth of the exchange matrix is (approximately) minimized (per i..." alt="" coords="255,799,470,840"/><area shape="rect" id="node23" href="classCheMPS2_1_1EdmistonRuedenberg.html#af02cbffdb428682c4d53cf6c862fdb02" title="Get the pointer to the unitary to use in DMRGSCF. " alt="" coords="255,1200,470,1241"/><area shape="rect" id="node24" href="classCheMPS2_1_1FCI.html#a6e153d335d6500f4758212e203f7d682" title="Getter for the number of variables in the vector &quot; E_ij | FCI vector &gt; &quot; ; where irrep_center = I_i x..." alt="" coords="263,1266,463,1293"/><area shape="rect" id="node25" href="classCheMPS2_1_1FCI.html#a030bc8d72d2f0c1fcaf570ab397c49a9" title="Set the entries of a vector to zero. " alt="" coords="268,1317,457,1343"/><area shape="rect" id="node26" href="classCheMPS2_1_1FCI.html#a748644c42be72710e38631e169b642cc" title="Return the global counter of the Slater determinant with the lowest energy. " alt="" coords="261,1368,464,1409"/><area shape="rect" id="node27" href="classCheMPS2_1_1FCI.html#a9fba49f1eba2366bd5a26d6d5521c8e8" title="Calculates the FCI ground state with Davidson&#39;s algorithm. " alt="" coords="265,1434,460,1461"/><area shape="rect" id="node30" href="classCheMPS2_1_1FCI.html#a36e81090d6d9c12eb8e86f65ce1e66b4" title="Construct the (spin&#45;summed) 2&#45;RDM of a FCI vector: Gamma^2(i,j,k,l) = sum_sigma,tau &lt; a^+_i..." alt="" coords="275,1485,450,1511"/><area shape="rect" id="node31" href="classCheMPS2_1_1DMRG.html#acfb3123c72e3503f2d6c77dcf9eb141a" title="Push back current calculation and set everything up to calculate a (new) excitation. " alt="" coords="548,1855,769,1882"/><area shape="rect" id="node33" href="classCheMPS2_1_1DMRG.html#ab6d80dde8b71171ee969a6b7b86193d2" title="Solver. " alt="" coords="573,1906,745,1933"/><area shape="rect" id="node34" href="classCheMPS2_1_1DMRGSCFoptions.html#a82add836b4de5c8ef97dda33553f2c64" title="Get whether state&#45;averaging or state&#45;specific DMRGSCF should be performed. " alt="" coords="263,1536,463,1577"/><area shape="rect" id="node35" href="classCheMPS2_1_1DMRG.html#aea1ffffbf2e12b56d602e5b692dd3a79" title="Calculate the 2&#45;RDM and correlations. Afterwards the MPS is again in LLLLLLLC gauge. " alt="" coords="257,967,469,1008"/><area shape="rect" id="node63" href="classCheMPS2_1_1DMRG.html#a0b471ea7ea19f7a49e6e1412f443d5ac" title="Get the pointer to the 2&#45;RDM. " alt="" coords="270,1602,455,1629"/><area shape="rect" id="node64" href="classCheMPS2_1_1DMRG.html#ab442cbc43e2e5d877660859578849133" title="Activate the necessary storage and machinery to handle excitations. " alt="" coords="237,1653,488,1679"/><area shape="rect" id="node65" href="classCheMPS2_1_1DMRGSCFoptions.html#acb3c7d12b054befbe92d704d6746f4be" title="Get whether the correlations and two&#45;orbital mutual information should be printed. " alt="" coords="263,1704,463,1745"/><area shape="rect" id="node66" href="classCheMPS2_1_1DMRG.html#a13008f80dbfd8312ef4aa3990cbbc436" title="Get the pointer to the Correlations. " alt="" coords="249,1770,476,1797"/><area shape="rect" id="node67" href="classCheMPS2_1_1Correlations.html#a9e99dc1d7c2d571e2743ff6b472c50f6" title="Print the correlation functions and two&#45;orbital mutual information. " alt="" coords="283,1821,443,1863"/><area shape="rect" id="node68" href="classCheMPS2_1_1DMRG.html#a0f4e487c40f522846288fe1b3d55e66c" title="Call &quot;rm &quot; + CheMPS2::DMRG_MPS_storage_prefix + &quot;*.h5&quot;. " alt="" coords="242,1887,483,1914"/><area shape="rect" id="node69" href="classCheMPS2_1_1DMRG.html#a2254cc31b5d9497694ea2229226b7bd6" title="Call &quot;rm &quot; + tempfolder + &quot;/&quot; + CheMPS2::DMRG_OPERATOR_storage_prefix + string(thePID) + &quot;*..." alt="" coords="257,1939,469,1980"/><area shape="rect" id="node70" href="classCheMPS2_1_1DMRGSCFVmatRotations.html#ae8773f07770b03db7c70dc51fc78958e" title="Fill the rotated two&#45;body matrix elements with max. two virtual indices, based on HamOrig and unitary..." alt="" coords="536,908,781,949"/><area shape="rect" id="node75" href="classCheMPS2_1_1DMRGSCFVmatRotations.html#a86092727e466bea078911da301567093" title="Fill the rotated two&#45;body matrix elements with max. two virtual indices, based on HamOrig and unitary..." alt="" coords="536,809,781,851"/><area shape="rect" id="node13" href="classCheMPS2_1_1Irreps.html#a1d86c7a8b3c3a7b9215c0e298f0ae047" title="Get the direct product of the irreps with numbers Irrep1 and Irrep2: a bitwise XOR for psi4&#39;s convent..." alt="" coords="1104,758,1295,785"/><area shape="rect" id="node14" href="classCheMPS2_1_1Hamiltonian.html#a2ddb391c8a20c50bdd2c775cffd8fbb1" title="Set a Vmat element. " alt="" coords="863,473,1022,515"/><area shape="rect" id="node15" href="classCheMPS2_1_1DMRGSCFunitary.html#a7ca4dead16809cd2a896c1a05b92fc0b" title="Get the unitary rotation for block irrep. " alt="" coords="844,591,1041,632"/><area shape="rect" id="node16" href="classCheMPS2_1_1Hamiltonian.html#ab6147d890404000374bb96baba0b1f82" title="Add to Vmat element. " alt="" coords="863,408,1022,449"/><area shape="rect" id="node19" href="classCheMPS2_1_1DMRGSCFVmatRotations.html#a5471bb0feb5a00c8619cb9ff25978b16" title="Fill the rotated two&#45;body matrix elements, based on HamOrig and unitary. Do entire blocks at once..." alt="" coords="536,700,781,741"/><area shape="rect" id="node20" href="classCheMPS2_1_1FourIndex.html#a8733c4fd0064bcd845786157f7d9b26f" title="Set an element. " alt="" coords="855,657,1030,683"/><area shape="rect" id="node28" href="classCheMPS2_1_1Davidson.html#a2ae39a55a30271ae6f5d46b52df3d991" title="The iterator to converge the ground state vector. " alt="" coords="582,1957,735,1999"/><area shape="rect" id="node29" href="classCheMPS2_1_1Davidson.html#a0a9f07122a47a4ec24e6add4b8b30797" title="Get the number of matrix vector multiplications which have been performed. " alt="" coords="581,2023,736,2064"/><area shape="rect" id="node32" href="classCheMPS2_1_1MPIchemps2.html#a6732ae60b5b4c8a4f1b063f9db304bf5" title="Get the rank of this MPI process. " alt="" coords="1116,1983,1283,2024"/><area shape="rect" id="node36" href="classCheMPS2_1_1DMRG.html#a2f30a27d6a9acd3abe2c1092d6a4defb" title="Calculate the reduced density matrices and correlations. Afterwards the MPS is again in LLLLLLLC gaug..." alt="" coords="577,1789,740,1831"/><area shape="rect" id="node37" href="classCheMPS2_1_1SyBookkeeper.html#ab06fa32f4e352d248ebfe67d850a574a" title="Get an orbital irrep. " alt="" coords="855,1640,1030,1681"/><area shape="rect" id="node38" href="classCheMPS2_1_1Sobject.html#a687a29eab89ef3763af8c630b48e3bf6" title="Join two sites to form a composite S&#45;object. " alt="" coords="859,1122,1026,1149"/><area shape="rect" id="node39" href="classCheMPS2_1_1Heff.html#a1075e481d1a1d12f09f791be7389d2f4" title="Davidson Solver. " alt="" coords="829,2041,1056,2067"/><area shape="rect" id="node40" href="classCheMPS2_1_1Problem.html#a6c6f133286114da1666965c8048e47a1" title="Get the constant part of the Hamiltonian. " alt="" coords="845,1706,1040,1733"/><area shape="rect" id="node41" href="classCheMPS2_1_1Sobject.html#a34983e86ae9f19de0be6b923479c13df" title="SVD an S&#45;object into 2 TensorT&#39;s. " alt="" coords="859,1370,1027,1397"/><area shape="rect" id="node42" href="classCheMPS2_1_1ConvergenceScheme.html#abb766295f71d3c1e3b9edc875504b317" title="Get the number of renormalized states for a particular instruction. " alt="" coords="835,1757,1050,1799"/><area shape="rect" id="node43" href="classCheMPS2_1_1ConvergenceScheme.html#ab8c98d5388c415c42115084c5817e1dc" title="Get the number of instructions. " alt="" coords="835,1823,1050,1864"/><area shape="rect" id="node44" href="classCheMPS2_1_1TensorT.html#a1ee5bb57153170fc200acea0859a5ef9" title="Left&#45;normalization. " alt="" coords="859,1889,1026,1915"/><area shape="rect" id="node45" href="classCheMPS2_1_1TwoDM.html#a5c5bf12b31aa9cb4b0b31bd53dad1ed3" title="Fill the 2DM terms with as second site index denT&#45;&gt;gIndex() " alt="" coords="851,1421,1035,1447"/><area shape="rect" id="node46" href="classCheMPS2_1_1TensorT.html#abc507af3cebe59f0800c12db47bd9752" title="Right&#45;normalization. " alt="" coords="861,1939,1024,1966"/><area shape="rect" id="node47" href="classCheMPS2_1_1TensorT.html#a06f61e76a7a6d46c1899141c75678aa8" title="Multiply at the right with a diagonal TensorOperator. " alt="" coords="831,2091,1054,2118"/><area shape="rect" id="node48" href="classCheMPS2_1_1TwoDM.html#a520ebec8dd2e56a475105e651a98fec3" title="Add the 2&#45;RDM elements of all MPI processes. " alt="" coords="860,2143,1025,2184"/><area shape="rect" id="node49" href="classCheMPS2_1_1TwoDM.html#a09eb9e2471fe7fb19659b611e3e4550b" title="After the whole 2&#45;RDM is filled, a prefactor for higher multiplicities should be applied. " alt="" coords="851,2208,1035,2249"/><area shape="rect" id="node50" href="classCheMPS2_1_1SyBookkeeper.html#af39babd5df4cb5eeb84ffc017af841c3" title="Get the targeted particle number. " alt="" coords="843,2274,1043,2301"/><area shape="rect" id="node51" href="classCheMPS2_1_1TwoDM.html#a5ea664bc3b45270494e3d6e9f8d52619" title="Return the double trace of 2DM&#45;A (should be N(N&#45;1)) " alt="" coords="856,2325,1029,2351"/><area shape="rect" id="node52" href="classCheMPS2_1_1TwoDM.html#ab35662dd77d8ae32f5b28bbe04239e79" title="Calculate the energy based on the 2DM&#45;A. " alt="" coords="851,2375,1034,2402"/><area shape="rect" id="node53" href="classCheMPS2_1_1TwoDM.html#ac24a417e0cd64e7c3a82c94ba1d9d71c" title="Print the natural orbital occupation numbers. " alt="" coords="841,2426,1045,2453"/><area shape="rect" id="node54" href="classCheMPS2_1_1ThreeDM.html#a41f377c3636898276dcb6c2f30dbf3ad" title="Fill the 3&#45;RDM terms corresponding to site denT&#45;&gt;gIndex() " alt="" coords="846,1471,1039,1498"/><area shape="rect" id="node55" href="classCheMPS2_1_1TensorT.html#a88c0e7491c53ff6ba5a737a380df188b" title="Multiply at the left with a diagonal TensorOperator. " alt="" coords="836,2477,1049,2503"/><area shape="rect" id="node56" href="classCheMPS2_1_1Correlations.html#ad0628c1674123410d212401e14812964" title="Fill at the current step of the iterations the two&#45;orbital mutual information and the remaining part ..." alt="" coords="863,2528,1023,2569"/><area shape="rect" id="node57" href="classCheMPS2_1_1Correlations.html#ae175e3599bab50c3fe334e3a98c41f23" title="Broadcast the diradical correlation function and the two&#45;orbital mutual information. " alt="" coords="863,2593,1023,2635"/><area shape="rect" id="node58" href="classCheMPS2_1_1ThreeDM.html#acceb29cbf3244a2fee196f36c87589a7" title="Add the 3&#45;RDM elements of all MPI processes. " alt="" coords="856,1173,1029,1215"/><area shape="rect" id="node59" href="classCheMPS2_1_1ThreeDM.html#a0a3de81e9881218690e26094be30b749" title="After the whole 3&#45;RDM is filled, a prefactor for higher multiplicities should be applied. " alt="" coords="847,1239,1039,1280"/><area shape="rect" id="node60" href="classCheMPS2_1_1Correlations.html#a1cf618a098e75511dda2fb0d010dab2e" title="Get the single&#45;orbital entropy for a certain site, using hte HAM indices. " alt="" coords="849,1304,1036,1345"/><area shape="rect" id="node61" href="classCheMPS2_1_1Correlations.html#a3e4a935011b95ad18b28b88ac56990fc" title="Return Idistance(power) (see return for definition) " alt="" coords="849,1523,1036,1564"/><area shape="rect" id="node62" href="classCheMPS2_1_1ThreeDM.html#a425345a7f5aa3a635e4a6eb7d1b3cec4" title="Return the trace (should be N(N&#45;1)(N&#45;2)) " alt="" coords="852,1589,1033,1615"/><area shape="rect" id="node71" href="classCheMPS2_1_1DMRGSCFintegrals.html#ac9c1b2d0d67b2beb246ce3c59b193177" title="Set an element of the Coulomb object ( c1 c2 | a1 a2 ) " alt="" coords="839,809,1046,851"/><area shape="rect" id="node72" href="classCheMPS2_1_1DMRGSCFintegrals.html#ab3a4b266923e8188ac73d49aa2acb90a" title="Add a double to an element of the Coulomb object ( c1 c2 | a1 a2 ) " alt="" coords="839,940,1046,981"/><area shape="rect" id="node73" href="classCheMPS2_1_1DMRGSCFintegrals.html#af910b76a44cdbde6cdffc1750705fdb9" title="Set an element of the Exchange object ( c1 v1 | c2 v2 ) " alt="" coords="839,875,1046,916"/><area shape="rect" id="node74" href="classCheMPS2_1_1DMRGSCFintegrals.html#a57d2abf30dfa50a715d7fffcb3987674" title="Add a double to an element of the Exchange object ( c1 v1 | c2 v2 ) " alt="" coords="839,1005,1046,1047"/></map>
</div>
</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="CASSCF_8h_source.html">CASSCF.h</a></li>
<li><a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a></li>
<li><a class="el" href="CASSCFdebug_8cpp_source.html">CASSCFdebug.cpp</a></li>
<li><a class="el" href="CASSCFnewtonraphson_8cpp_source.html">CASSCFnewtonraphson.cpp</a></li>
<li><a class="el" href="CASSCFpt2_8cpp_source.html">CASSCFpt2.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>CheMPS2</b></li><li class="navelem"><a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a></li>
    <li class="footer">Generated on Thu Feb 18 2016 10:25:52 for CheMPS2 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
