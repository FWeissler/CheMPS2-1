<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>CheMPS2: CheMPS2::CASSCF Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="CheMPS2logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CheMPS2
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classCheMPS2_1_1CASSCF.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classCheMPS2_1_1CASSCF-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CheMPS2::CASSCF Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="CASSCF_8h_source.html">CASSCF.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1e026f0ae4af55325996c6c97af11917"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a1e026f0ae4af55325996c6c97af11917">CASSCF</a> (<a class="el" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a> *ham_in, int *docc, int *socc, int *nocc, int *ndmrg, int *nvirt, const string tmp_folder=CheMPS2::defaultTMPpath)</td></tr>
<tr class="memdesc:a1e026f0ae4af55325996c6c97af11917"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a1e026f0ae4af55325996c6c97af11917">More...</a><br /></td></tr>
<tr class="separator:a1e026f0ae4af55325996c6c97af11917"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20937fd3dbc5c5f3fa2e7ffd4f751900"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a20937fd3dbc5c5f3fa2e7ffd4f751900"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a20937fd3dbc5c5f3fa2e7ffd4f751900">~CASSCF</a> ()</td></tr>
<tr class="memdesc:a20937fd3dbc5c5f3fa2e7ffd4f751900"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:a20937fd3dbc5c5f3fa2e7ffd4f751900"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ecba3101fed76c3ce03c23c6446a3f8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a4ecba3101fed76c3ce03c23c6446a3f8">get_num_irreps</a> ()</td></tr>
<tr class="memdesc:a4ecba3101fed76c3ce03c23c6446a3f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of irreps.  <a href="#a4ecba3101fed76c3ce03c23c6446a3f8">More...</a><br /></td></tr>
<tr class="separator:a4ecba3101fed76c3ce03c23c6446a3f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b4ebee13ba2a5764081fae5275f6c7e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a8b4ebee13ba2a5764081fae5275f6c7e">solve</a> (const int Nelectrons, const int TwoS, const int Irrep, <a class="el" href="classCheMPS2_1_1ConvergenceScheme.html">ConvergenceScheme</a> *OptScheme, const int rootNum, <a class="el" href="classCheMPS2_1_1DMRGSCFoptions.html">DMRGSCFoptions</a> *scf_options)</td></tr>
<tr class="memdesc:a8b4ebee13ba2a5764081fae5275f6c7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> cycles with the augmented Hessian Newton-Raphson method.  <a href="#a8b4ebee13ba2a5764081fae5275f6c7e">More...</a><br /></td></tr>
<tr class="separator:a8b4ebee13ba2a5764081fae5275f6c7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e8e56a34c6f28fe27341425a1db8384"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a0e8e56a34c6f28fe27341425a1db8384">caspt2</a> (const int Nelectrons, const int TwoS, const int Irrep, <a class="el" href="classCheMPS2_1_1ConvergenceScheme.html">ConvergenceScheme</a> *OptScheme, const int rootNum, <a class="el" href="classCheMPS2_1_1DMRGSCFoptions.html">DMRGSCFoptions</a> *scf_options, const double IPEA, const double IMAG, const bool PSEUDOCANONICAL, const bool CHECKPOINT=false, const bool CUMULANT=false)</td></tr>
<tr class="memdesc:a0e8e56a34c6f28fe27341425a1db8384"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the caspt2 correction energy for a converged casscf wavefunction.  <a href="#a0e8e56a34c6f28fe27341425a1db8384">More...</a><br /></td></tr>
<tr class="separator:a0e8e56a34c6f28fe27341425a1db8384"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a7334f5960b6d4305c2479df4995e5102"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7334f5960b6d4305c2479df4995e5102"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a7334f5960b6d4305c2479df4995e5102">deleteStoredUnitary</a> (const string filename=CheMPS2::DMRGSCF_unitary_storage_name)</td></tr>
<tr class="memdesc:a7334f5960b6d4305c2479df4995e5102"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> unitary rotation remove call. <br /></td></tr>
<tr class="separator:a7334f5960b6d4305c2479df4995e5102"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0ecf5c63622cb1f2aa4e72eebb31fe1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa0ecf5c63622cb1f2aa4e72eebb31fe1"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#aa0ecf5c63622cb1f2aa4e72eebb31fe1">deleteStoredDIIS</a> (const string filename=CheMPS2::DMRGSCF_diis_storage_name)</td></tr>
<tr class="memdesc:aa0ecf5c63622cb1f2aa4e72eebb31fe1"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> <a class="el" href="classCheMPS2_1_1DIIS.html">DIIS</a> vectors remove call. <br /></td></tr>
<tr class="separator:aa0ecf5c63622cb1f2aa4e72eebb31fe1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0210ff118bab44593aef7c6ec9f31a56"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a0210ff118bab44593aef7c6ec9f31a56">buildFmat</a> (<a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localFmat, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localTmat, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localJKocc, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localJKact, const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *localIdx, const <a class="el" href="classCheMPS2_1_1DMRGSCFintegrals.html">DMRGSCFintegrals</a> *theInts, double *local2DM, double *local1DM)</td></tr>
<tr class="memdesc:a0210ff118bab44593aef7c6ec9f31a56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the F-matrix (Eq. (11) in the Siegbahn paper [CAS3])  <a href="#a0210ff118bab44593aef7c6ec9f31a56">More...</a><br /></td></tr>
<tr class="separator:a0210ff118bab44593aef7c6ec9f31a56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21471f166b873029b5e51dda4a6907c4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a21471f166b873029b5e51dda4a6907c4">buildWtilde</a> (<a class="el" href="classCheMPS2_1_1DMRGSCFwtilde.html">DMRGSCFwtilde</a> *localwtilde, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localTmat, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localJKocc, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localJKact, const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *localIdx, const <a class="el" href="classCheMPS2_1_1DMRGSCFintegrals.html">DMRGSCFintegrals</a> *theInts, double *local2DM, double *local1DM)</td></tr>
<tr class="memdesc:a21471f166b873029b5e51dda4a6907c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the Wtilde-matrix (Eq. (20b) in the Siegbahn paper [CAS3])  <a href="#a21471f166b873029b5e51dda4a6907c4">More...</a><br /></td></tr>
<tr class="separator:a21471f166b873029b5e51dda4a6907c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a184b5eacca476b5c00750d0485b5e0b1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a184b5eacca476b5c00750d0485b5e0b1">augmentedHessianNR</a> (<a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *localFmat, <a class="el" href="classCheMPS2_1_1DMRGSCFwtilde.html">DMRGSCFwtilde</a> *localwtilde, const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *localIdx, const <a class="el" href="classCheMPS2_1_1DMRGSCFunitary.html">DMRGSCFunitary</a> *localUmat, double *theupdate, double *updateNorm, double *gradNorm)</td></tr>
<tr class="memdesc:a184b5eacca476b5c00750d0485b5e0b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the augmented Hessian Newton-Raphson update for the orthogonal orbital rotation matrix.  <a href="#a184b5eacca476b5c00750d0485b5e0b1">More...</a><br /></td></tr>
<tr class="separator:a184b5eacca476b5c00750d0485b5e0b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dbcb41aa9097e3b45b93c232337ec8a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a0dbcb41aa9097e3b45b93c232337ec8a">copy2DMover</a> (<a class="el" href="classCheMPS2_1_1TwoDM.html">TwoDM</a> *theDMRG2DM, const int LAS, double *two_dm)</td></tr>
<tr class="memdesc:a0dbcb41aa9097e3b45b93c232337ec8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy over the <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 2-RDM.  <a href="#a0dbcb41aa9097e3b45b93c232337ec8a">More...</a><br /></td></tr>
<tr class="separator:a0dbcb41aa9097e3b45b93c232337ec8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac35e694fd9e00f47d361bdbd47b787e1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#ac35e694fd9e00f47d361bdbd47b787e1">setDMRG1DM</a> (const int num_elec, const int LAS, double *one_dm, double *two_dm)</td></tr>
<tr class="memdesc:ac35e694fd9e00f47d361bdbd47b787e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct the 1-RDM from the 2-RDM.  <a href="#ac35e694fd9e00f47d361bdbd47b787e1">More...</a><br /></td></tr>
<tr class="separator:ac35e694fd9e00f47d361bdbd47b787e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f20d25b94c1d821f22f95a6bab0ebc7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a3f20d25b94c1d821f22f95a6bab0ebc7">copy_active</a> (double *origin, <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *result, const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *idx, const bool one_rdm)</td></tr>
<tr class="memdesc:a3f20d25b94c1d821f22f95a6bab0ebc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy a one-orbital quantity from array format to <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> format.  <a href="#a3f20d25b94c1d821f22f95a6bab0ebc7">More...</a><br /></td></tr>
<tr class="separator:a3f20d25b94c1d821f22f95a6bab0ebc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53a0c4f5043fd2494f8825cb43578fa7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a53a0c4f5043fd2494f8825cb43578fa7">copy_active</a> (const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *origin, double *result, const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *idx)</td></tr>
<tr class="memdesc:a53a0c4f5043fd2494f8825cb43578fa7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy a one-orbital quantity from <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> format to array format.  <a href="#a53a0c4f5043fd2494f8825cb43578fa7">More...</a><br /></td></tr>
<tr class="separator:a53a0c4f5043fd2494f8825cb43578fa7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49e2785c67342a2c907cf16292e9b589"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a49e2785c67342a2c907cf16292e9b589">fillLocalizedOrbitalRotations</a> (<a class="el" href="classCheMPS2_1_1DMRGSCFunitary.html">DMRGSCFunitary</a> *umat, <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *idx, double *eigenvecs)</td></tr>
<tr class="memdesc:a49e2785c67342a2c907cf16292e9b589"><td class="mdescLeft">&#160;</td><td class="mdescRight">From an Edmiston-Ruedenberg active space rotation, fetch the eigenvectors and store them in eigenvecs.  <a href="#a49e2785c67342a2c907cf16292e9b589">More...</a><br /></td></tr>
<tr class="separator:a49e2785c67342a2c907cf16292e9b589"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13589f3ee9f293b743676739bb1db372"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a13589f3ee9f293b743676739bb1db372">block_diagonalize</a> (const char space, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *Mat, <a class="el" href="classCheMPS2_1_1DMRGSCFunitary.html">DMRGSCFunitary</a> *Umat, double *work1, double *work2, const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *idx, const bool invert, double *two_dm, double *three_dm, double *contract)</td></tr>
<tr class="memdesc:a13589f3ee9f293b743676739bb1db372"><td class="mdescLeft">&#160;</td><td class="mdescRight">Block-diagonalize Mat.  <a href="#a13589f3ee9f293b743676739bb1db372">More...</a><br /></td></tr>
<tr class="separator:a13589f3ee9f293b743676739bb1db372"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10b37b294f7573005a6b49b669e734ca"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a10b37b294f7573005a6b49b669e734ca">construct_fock</a> (<a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *Fock, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *Tmat, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *Qocc, const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *Qact, const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *idx)</td></tr>
<tr class="memdesc:a10b37b294f7573005a6b49b669e734ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct the Fock matrix.  <a href="#a10b37b294f7573005a6b49b669e734ca">More...</a><br /></td></tr>
<tr class="separator:a10b37b294f7573005a6b49b669e734ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4c00cd4c21dc402ad5e966232b199d3"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#ad4c00cd4c21dc402ad5e966232b199d3">deviation_from_blockdiag</a> (<a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *matrix, const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *idx)</td></tr>
<tr class="memdesc:ad4c00cd4c21dc402ad5e966232b199d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the RMS deviation from block-diagonal.  <a href="#ad4c00cd4c21dc402ad5e966232b199d3">More...</a><br /></td></tr>
<tr class="separator:ad4c00cd4c21dc402ad5e966232b199d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace43158fe31a38fb9d9131031895578b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#ace43158fe31a38fb9d9131031895578b">write_f4rdm_checkpoint</a> (const string f4rdm_file, int *hamorb1, int *hamorb2, const int tot_dmrg_power6, double *contract)</td></tr>
<tr class="memdesc:ace43158fe31a38fb9d9131031895578b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the checkpoint file for the contraction of the generalized Fock operator with the 4-RDM to disk.  <a href="#ace43158fe31a38fb9d9131031895578b">More...</a><br /></td></tr>
<tr class="separator:ace43158fe31a38fb9d9131031895578b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad493cbf60a7b807ad0d3a06de74001b9"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#ad493cbf60a7b807ad0d3a06de74001b9">read_f4rdm_checkpoint</a> (const string f4rdm_file, int *hamorb1, int *hamorb2, const int tot_dmrg_power6, double *contract)</td></tr>
<tr class="memdesc:ad493cbf60a7b807ad0d3a06de74001b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the checkpoint file for the contraction of the generalized Fock operator with the 4-RDM from disk.  <a href="#ad493cbf60a7b807ad0d3a06de74001b9">More...</a><br /></td></tr>
<tr class="separator:ad493cbf60a7b807ad0d3a06de74001b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f1e0dc3e01be6e48eed126ca0ff1fd9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1CASSCF.html#a3f1e0dc3e01be6e48eed126ca0ff1fd9">fock_dot_4rdm</a> (double *fockmx, <a class="el" href="classCheMPS2_1_1DMRG.html">CheMPS2::DMRG</a> *dmrgsolver, <a class="el" href="classCheMPS2_1_1Hamiltonian.html">CheMPS2::Hamiltonian</a> *ham, int next_orb1, int next_orb2, double *work, double *result, const bool CHECKPOINT, const bool PSEUDOCANONICAL)</td></tr>
<tr class="memdesc:a3f1e0dc3e01be6e48eed126ca0ff1fd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the contraction of the fock matrix with the 4-RDM.  <a href="#a3f1e0dc3e01be6e48eed126ca0ff1fd9">More...</a><br /></td></tr>
<tr class="separator:a3f1e0dc3e01be6e48eed126ca0ff1fd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> class. </p><dl class="section author"><dt>Author</dt><dd>Sebastian Wouters <a href="#" onclick="location.href='mai'+'lto:'+'seb'+'as'+'tia'+'nw'+'out'+'er'+'s@g'+'ma'+'il.'+'co'+'m'; return false;">sebas<span style="display: none;">.nosp@m.</span>tian<span style="display: none;">.nosp@m.</span>woute<span style="display: none;">.nosp@m.</span>rs@g<span style="display: none;">.nosp@m.</span>mail.<span style="display: none;">.nosp@m.</span>com</a> </dd></dl>
<dl class="section date"><dt>Date</dt><dd>June 18, 2013</dd></dl>
<h1><a class="anchor" id="intro"></a>
Introduction</h1>
<p>In methods which use a <a class="el" href="classCheMPS2_1_1FCI.html">FCI</a> solver, this solver can be replaced by <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a>. <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> allows for an efficient extraction of the 2-RDM [CAS1, CAS2]. The 2-RDM of the active space is required in the complete active space self-consistent field (<a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a>) method to compute the gradient and the Hessian with respect to orbital rotations [CAS3]. It is therefore natural to introduce a <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> variant with <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> as active space solver, called DMRG-SCF [CAS2, CAS4, CAS5], which allows to treat static correlation in large active spaces. In CheMPS2, I have implemented the augmented Hessian Newton-Raphson DMRG-SCF method, with exact Hessian [CAS5, CAS6]. It can be called with the function CheMPS2::CASSCF::doCASSCFnewtonraphson.</p>
<h1><a class="anchor" id="equations_2step_dmrgscf"></a>
Orbital gradient and Hessian</h1>
<p>The calculation of the orbital gradient and Hessian for DMRG-SCF is based on [CAS3]. The basic idea is to express the energy with the unitary group generators: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \hat{E}_{pq} &amp; = &amp; \sum\limits_{\sigma} \hat{a}^{\dagger}_{p \sigma} \hat{a}_{q \sigma} \\ \left[ \hat{E}_{pq} , \hat{E}_{rs} \right] &amp; = &amp; \delta_{qr} \hat{E}_{ps} - \delta_{ps} \hat{E}_{rq} \\ \hat{E}^{-}_{pq} &amp; = &amp; \hat{E}_{pq} - \hat{E}_{qp} \\ \hat{T} &amp; = &amp; \sum\limits_{p&lt;q} x_{pq} \hat{E}^{-}_{pq} \\ E(\vec{x}) &amp; = &amp; \braket{0 | e^{\hat{T}} \hat{H} e^{-\hat{T}} | 0 } \\ \left. \frac{\partial E(\vec{x})}{\partial x_{ij}} \right|_{0} &amp; = &amp; \braket{ 0 | \left[ \hat{E}_{ij}^{-}, \hat{H} \right] | 0 } \\ \left. \frac{\partial^2 E(\vec{x})}{\partial x_{ij} \partial x_{kl}} \right|_{0} &amp; = &amp; \frac{1}{2} \braket{ 0 | \left[ \hat{E}_{ij}^{-}, \left[ \hat{E}_{kl}^{-}, \hat{H} \right] \right] | 0 } + \frac{1}{2} \braket{ 0 | \left[ \hat{E}_{kl}^{-}, \left[ \hat{E}_{ij}^{-}, \hat{H} \right] \right] | 0 } \end{eqnarray*}" src="form_0.png"/>
</p>
<p> The variables <img class="formulaInl" alt="$x_{pq}$" src="form_1.png"/> only connect orbitals with the same irrep ( <img class="formulaInl" alt="$I_p=I_q$" src="form_2.png"/>). Assuming that <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> is exact, <img class="formulaInl" alt="$x_{pq}$" src="form_1.png"/> in addition only connects orbitals when they belong to different occupation blocks: occupied, active, virtual. With some algebra, the derivatives can be rewritten. Real-valued symmetric one-electron integrals <img class="formulaInl" alt="$h_{ij}$" src="form_3.png"/> and real-valued eightfold permutation symmetric two-electron integrals <img class="formulaInl" alt="$(ij | kl)$" src="form_4.png"/> are assumed (chemical notation for the latter). </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \Gamma^{2A}_{ijkl} &amp; = &amp; \sum\limits_{\sigma \tau} \braket{ 0 | \hat{a}^{\dagger}_{i \sigma} \hat{a}_{j \tau}^{\dagger} \hat{a}_{l \tau} \hat{a}_{k \sigma} | 0} \\ \Gamma^1_{ij} &amp; = &amp; \sum\limits_{\sigma} \braket{ 0 | \hat{a}^{\dagger}_{i \sigma} \hat{a}_{j \sigma} | 0} \\ \left. \frac{\partial E(\vec{x})}{\partial x_{ij}} \right|_{0} &amp; = &amp; 2 \left( F_{ij} - F_{ji} \right) \\ F_{pq} &amp; = &amp; \sum\limits_{r} \Gamma_{pr}^{1} h_{qr} + \sum\limits_{rst} \Gamma^{2A}_{psrt} (qr | st) \\ \left. \frac{\partial^2 E(\vec{x})}{\partial x_{ij} \partial x_{kl}} \right|_{0} &amp; = &amp; w_{ijkl} - w_{jikl} - w_{ijlk} + w_{jilk} \\ w_{pqrs} &amp; = &amp; \delta_{qr} \left( F_{ps} + F_{sp} \right) + \tilde{w}_{pqrs} \\ \tilde{w}_{pqrs} &amp; = &amp; 2 \Gamma^1_{pr} h_{qs} + 2 \sum\limits_{\alpha \beta} \left( \Gamma^{2A}_{r \alpha p \beta} (qs | \alpha \beta ) + \left( \Gamma^{2A}_{r \alpha \beta p} + \Gamma^{2A}_{r p \beta \alpha} \right) (q \alpha | s \beta ) \right) \end{eqnarray*}" src="form_5.png"/>
</p>
<p> In the calculation of <img class="formulaInl" alt="$F_{pq}$" src="form_6.png"/>, the indices <img class="formulaInl" alt="$prst$" src="form_7.png"/> can only be occupied or active due to their appearance in the density matrices, and the only index which can be virtual is hence <img class="formulaInl" alt="$q$" src="form_8.png"/>. Moreover, due to the irrep symmetry of the integrals and density matrices, <img class="formulaInl" alt="$F_{pq}$" src="form_6.png"/> is diagonal in the irreps: <img class="formulaInl" alt="$I_p = I_q$" src="form_9.png"/>. Alternatively, this can be understood by the fact that <img class="formulaInl" alt="$x_{pq}$" src="form_1.png"/> only connects orbitals with the same irrep.</p>
<p>In the calculation of <img class="formulaInl" alt="$\tilde{w}_{pqrs}$" src="form_10.png"/>, the indices <img class="formulaInl" alt="$pr\alpha\beta$" src="form_11.png"/> can only be occupied or active due to their appearance in the density matrices, and the only indices which can be virtual are hence <img class="formulaInl" alt="$qs$" src="form_12.png"/>. Together with the remark for <img class="formulaInl" alt="$F_{pq}$" src="form_6.png"/>, this can save time for the two-electron integral rotation. Moreover, as <img class="formulaInl" alt="$x_{pq}$" src="form_1.png"/> only connects orbitals with the same irrep, <img class="formulaInl" alt="$I_p = I_q$" src="form_9.png"/> and <img class="formulaInl" alt="$I_r = I_s$" src="form_13.png"/> in <img class="formulaInl" alt="$\tilde{w}_{pqrs}$" src="form_10.png"/>.</p>
<p>By rewriting the density matrices, the calculation of <img class="formulaInl" alt="$F_{pq}$" src="form_6.png"/> and <img class="formulaInl" alt="$\tilde{w}_{pqrs}$" src="form_10.png"/> can be simplified. In the following, occ and act denote the doubly occupied and active orbital spaces, respectively. </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \Gamma^1_{ij} &amp; = &amp; 2 \delta_{ij}^{occ} + \Gamma^{1,act}_{ij} \\ \Gamma^{2A}_{ijkl} &amp; = &amp; \Gamma^{2A,act}_{ijkl} + 2 \delta_{ik}^{occ} \Gamma^{1,act}_{jl} - \delta_{il}^{occ} \Gamma^{1,act}_{jk} \\ &amp; + &amp; 2 \delta_{jl}^{occ} \Gamma^{1,act}_{ik} - \delta_{jk}^{occ} \Gamma^{1,act}_{il} + 4 \delta_{ik}^{occ} \delta_{jl}^{occ} - 2 \delta_{il}^{occ} \delta_{jk}^{occ} \end{eqnarray*}" src="form_14.png"/>
</p>
<p> Define the following symmetric charge (Coulomb + exchange) matrices: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} Q^{occ}_{ij} &amp; = &amp; \sum\limits_{s \in occ} \left[ 2 (ij | ss) - (is | js ) \right] \\ Q^{act}_{ij} &amp; = &amp; \sum\limits_{st \in act} \frac{1}{2} \Gamma^{1,act}_{st} \left[ 2 (ij | st) - (is | jt ) \right] \end{eqnarray*}" src="form_15.png"/>
</p>
<p> They can be calculated efficiently by (1) rotating the occupied and active density matrices from the current basis to the original basis, (2) contracting the rotated density matrices with the two-electron integrals in the original basis, and (3) rotating these contractions to the current basis. The constant part and the one-electron integrals of the active space <a class="el" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a> are: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \tilde{E}_{const} &amp; = &amp; E_{const} + \sum\limits_{s \in occ} \left( 2 h_{ss} + Q_{ss}^{occ} \right) \\ \tilde{h}_{ij} &amp; = &amp; h_{ij} + Q_{ij}^{occ} \end{eqnarray*}" src="form_16.png"/>
</p>
<p> The calculation of <img class="formulaInl" alt="$F_{pq}$" src="form_6.png"/> boils down to: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} p \in occ &amp; : &amp; F_{pq} = 2 \left( h_{qp} + Q^{occ}_{qp} + Q^{act}_{qp} \right) \\ p \in act &amp; : &amp; F_{pq} = \sum\limits_{r \in act} \Gamma^{1,act}_{pr} \left[ h_{qr} + Q^{occ}_{qr} \right] + \sum\limits_{rst \in act} \Gamma^{2A,act}_{psrt} (qr | st) \end{eqnarray*}" src="form_17.png"/>
</p>
<p> And the calculation of <img class="formulaInl" alt="$\tilde{w}_{pqrs}$" src="form_10.png"/> (remember that <img class="formulaInl" alt="$I_p = I_q$" src="form_9.png"/> and <img class="formulaInl" alt="$I_r = I_s$" src="form_13.png"/>): </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} (p,r) &amp; \in &amp; (occ,occ) : \tilde{w}_{pqrs} \\ &amp; = &amp; 4 \delta_{pr}^{occ} \left[ h_{qs} + Q^{occ}_{qs} + Q^{act}_{qs} \right] \\ &amp; + &amp; 4 \left[ 4 (qp | sr) - ( qs | pr ) - ( qr | sp ) \right] \\ (p,r) &amp; \in &amp; (act,act) : \tilde{w}_{pqrs} = 2 \Gamma^{1,act}_{rp} \left[ h_{qs} + Q^{occ}_{qs} \right] \\ &amp; + &amp; 2 \sum\limits_{\alpha\beta \in act} \left[ \Gamma^{2A,act}_{r \alpha p \beta} (qs | \alpha \beta ) + \left( \Gamma^{2A,act}_{r \alpha \beta p} + \Gamma^{2A,act}_{r p \beta \alpha} \right) (q \alpha | s \beta ) \right] \\ (p,r) &amp; \in &amp; (act,occ) : \tilde{w}_{pqrs} \\ &amp; = &amp; 2 \sum\limits_{\alpha \in act} \Gamma^{1,act}_{\alpha p} \left[ 4 (q \alpha | s r) - (qs | \alpha r) - (qr | s \alpha) \right] \\ (p,r) &amp; \in &amp; (occ,act) : \tilde{w}_{pqrs} \\ &amp; = &amp; 2 \sum\limits_{\beta \in act} \Gamma^{1,act}_{r \beta} \left[ 4 (q p | s \beta) - (qs | p \beta) - (q \beta | sp) \right] \end{eqnarray*}" src="form_18.png"/>
</p>
<h1><a class="anchor" id="origalgo"></a>
Augmented Hessian Newton-Raphson DMRG-SCF</h1>
<p>The <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> energy is a function of <img class="formulaInl" alt="$\vec{x}$" src="form_19.png"/>. Up to second order, the energy is given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ E(\vec{x}) = \braket{0 | e^{\hat{T}(\vec{x})} \hat{H} e^{-\hat{T}(\vec{x})} | 0 } \approx E(0) + \vec{x}^T \vec{g} + \frac{1}{2} \vec{x}^T \mathbf{H} \vec{x}. \]" src="form_20.png"/>
</p>
<p> The vector <img class="formulaInl" alt="$\vec{g}$" src="form_21.png"/> is the gradient and the matrix <img class="formulaInl" alt="$\mathbf{H}$" src="form_22.png"/> the Hessian for orbital rotations [CAS3]. They have been described in the previous section. The minimum of <img class="formulaInl" alt="$E(\vec{x})$" src="form_23.png"/> is found at <img class="formulaInl" alt="$\vec{x} = - \mathbf{H}^{-1} \vec{g}$" src="form_24.png"/>. The variables <img class="formulaInl" alt="$\vec{x}$" src="form_19.png"/> parametrize an additional orbital rotation <img class="formulaInl" alt="$\mathbf{U}_{add} = \exp(\mathbf{X}(\vec{x}))$" src="form_25.png"/>, with <img class="formulaInl" alt="$\mathbf{X}(\vec{x}) = -\mathbf{X}^T(\vec{x})$" src="form_26.png"/> a real-valued skew-symmetric matrix. The additional orbital rotation <img class="formulaInl" alt="$\mathbf{U}_{add}$" src="form_27.png"/> transforms the current orbitals <img class="formulaInl" alt="$\mathbf{U}(n)$" src="form_28.png"/> to the new orbitals </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathbf{U}(n+1) = \mathbf{U}_{add} \mathbf{U}(n) = \exp(\mathbf{X}(\vec{x}(n))) \mathbf{U}(n). \]" src="form_29.png"/>
</p>
<p> This updating scheme is called the Newton-Raphson method [CAS3]. If the Hessian is positive definite, these updates are stable. For saddle points in the energy landscape, the Hessian has negative eigenvalues, and these updates can be unstable. It is therefore better to use the augmented Hessian Newton-Raphson method [CAS7]: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left[ \begin{array}{cc} \mathbf{H} &amp; \vec{g} \\ \vec{g}^T &amp; 0 \end{array} \right] \left[ \begin{array}{c} \vec{x} \\ 1 \end{array} \right] = \alpha \left[ \begin{array}{c} \vec{x} \\ 1 \end{array} \right]. \]" src="form_30.png"/>
</p>
<p> The eigenvector with smallest algebraic eigenvalue determines a stable update <img class="formulaInl" alt="$\vec{x}$" src="form_19.png"/>, as is well explained in Ref. [CAS7].</p>
<p>As a final remark in this section, I would like to say that orbitals have gauge freedom. One can always multiply them with a phase factor. It is therefore possible to choose the orbital gauges so that all <img class="formulaInl" alt="$\mathbf{U}$" src="form_31.png"/> are always special orthogonal: <img class="formulaInl" alt="$\det(\mathbf{U})=+1$" src="form_32.png"/>.</p>
<h1><a class="anchor" id="diis"></a>
Direct inversion of the iterative subspace (DIIS)</h1>
<p>When the update norm <img class="formulaInl" alt="$\|\vec{x}\|_2$" src="form_33.png"/> is small enough, the convergence can be accelerated by the direct inversion of the iterative subspace (<a class="el" href="classCheMPS2_1_1DIIS.html">DIIS</a>) [CAS5, CAS8, CAS9, CAS10]. For a given set of orbitals <img class="formulaInl" alt="$\mathbf{U}(n)$" src="form_28.png"/>, the update <img class="formulaInl" alt="$\vec{x}(n)$" src="form_34.png"/> is calculated with the augmented Hessian Newton-Raphson method. This update defines the next set of orbitals: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathbf{U}(n+1) = \mathbf{U}_{add} \mathbf{U}(n) = \exp(\mathbf{X}(\vec{x}(n))) \mathbf{U}(n). \]" src="form_29.png"/>
</p>
<p> In <a class="el" href="classCheMPS2_1_1DIIS.html">DIIS</a>, the error vector <img class="formulaInl" alt="$\vec{x}(n)$" src="form_34.png"/> and the state vector <img class="formulaInl" alt="$\mathbf{Y}(n+1) = \log(\mathbf{U}(n+1))$" src="form_35.png"/> are added to a list. The error </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ e = \left\| \sum\limits_{i = 1}^{\kappa} c_i \vec{x}(n - \kappa + i) \right\|_2 \]" src="form_36.png"/>
</p>
<p> is minimized under the constraint <img class="formulaInl" alt="$\sum_{i} c_i = 1$" src="form_37.png"/>. <img class="formulaInl" alt="$\kappa$" src="form_38.png"/> is the size of the list memory, i.e. the number of retained vectors. The minimization of the error <img class="formulaInl" alt="$e$" src="form_39.png"/> can be performed with Lagrangian calculus: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left[ \begin{array}{cc} \mathbf{B} &amp; \vec{1} \\ \vec{1}^T &amp; 0 \end{array} \right] \left[ \begin{array}{c} \vec{c} \\ \lambda \end{array} \right] = \left[ \begin{array}{c} \vec{0} \\ 1 \end{array} \right], \]" src="form_40.png"/>
</p>
<p> where <img class="formulaInl" alt="$2\lambda$" src="form_41.png"/> is the Lagrangian multiplier and </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left[\mathbf{B}\right]_{ij} = \vec{x}^T(n - \kappa + i) \vec{x}(n - \kappa + j) = \left[\mathbf{B}\right]_{ji}. \]" src="form_42.png"/>
</p>
<p> The new state vector is then defined as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathbf{Y}_{new} = \sum\limits_{i = 1}^{\kappa} c_i \mathbf{Y}(n+1 - \kappa + i). \]" src="form_43.png"/>
</p>
<p> The new state vector <img class="formulaInl" alt="$\mathbf{Y}_{new}$" src="form_44.png"/> is calculated by the function <a class="el" href="classCheMPS2_1_1DIIS.html#ad8f60dd3e52d1d8a59c155c25a7ce3f3" title="Calculate the new parameter vector, based on the just appended error and parameter vectors...">CheMPS2::DIIS::calculateParam</a>. The current orbitals are then set to <img class="formulaInl" alt="$\mathbf{U}(n+1) = \exp(\mathbf{Y}_{new})$" src="form_45.png"/>.</p>
<h1><a class="anchor" id="biblio"></a>
References</h1>
<p>[CAS1] D. Zgid and M. Nooijen, Journal of Chemical Physics 128, 144115 (2008). <a href="http://dx.doi.org/10.1063/1.2883980">http://dx.doi.org/10.1063/1.2883980</a> <br />
[CAS2] D. Ghosh, J. Hachmann, T. Yanai and G.K.-L. Chan, Journal of Chemical Physics 128, 144117 (2008). <a href="http://dx.doi.org/10.1063/1.2883976">http://dx.doi.org/10.1063/1.2883976</a> <br />
[CAS3] P.E.M. Siegbahn, J. Almlof, A. Heiberg and B.O. Roos, Journal of Chemical Physics 74, 2384-2396 (1981). <a href="http://dx.doi.org/10.1063/1.441359">http://dx.doi.org/10.1063/1.441359</a> <br />
[CAS4] D. Zgid and M. Nooijen, Journal of Chemical Physics 128, 144116 (2008). <a href="http://dx.doi.org/10.1063/1.2883981">http://dx.doi.org/10.1063/1.2883981</a> <br />
[CAS5] T. Yanai, Y. Kurashige, D. Ghosh and G.K.-L. Chan, International Journal of Quantum Chemistry 109, 2178-2190 (2009). <a href="http://dx.doi.org/10.1002/qua.22099">http://dx.doi.org/10.1002/qua.22099</a> <br />
[CAS6] S. Wouters, W. Poelmans, P.W. Ayers and D. Van Neck, Computer Physics Communications 185, 1501-1514 (2014). <a href="http://dx.doi.org/10.1016/j.cpc.2014.01.019">http://dx.doi.org/10.1016/j.cpc.2014.01.019</a> <br />
[CAS7] A. Banerjee, N. Adams, J. Simons and R. Shepard, Journal of Physical Chemistry 89, 52-57 (1985). <a href="http://dx.doi.org/10.1021/j100247a015">http://dx.doi.org/10.1021/j100247a015</a> <br />
[CAS8] P. Pulay, Chemical Physics Letters 73, 393-398 (1980). <a href="http://dx.doi.org/10.1016/0009-2614(80)80396-4">http://dx.doi.org/10.1016/0009-2614(80)80396-4</a> <br />
[CAS9] C.D. Sherrill, Programming <a class="el" href="classCheMPS2_1_1DIIS.html">DIIS</a>, <a href="http://vergil.chemistry.gatech.edu/notes/diis/node3.html">http://vergil.chemistry.gatech.edu/notes/diis/node3.html</a> (2000). <br />
[CAS10] T. Rohwedder and R. Schneider, Journal of Mathematical Chemistry 49, 1889-1914 (2011). <a href="http://dx.doi.org/10.1007/s10910-011-9863-y">http://dx.doi.org/10.1007/s10910-011-9863-y</a> <br />
</p>

<p>Definition at line <a class="el" href="CASSCF_8h_source.html#l00164">164</a> of file <a class="el" href="CASSCF_8h_source.html">CASSCF.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a1e026f0ae4af55325996c6c97af11917"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CheMPS2::CASSCF::CASSCF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a> *&#160;</td>
          <td class="paramname"><em>ham_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>docc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>socc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nocc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ndmrg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nvirt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const string&#160;</td>
          <td class="paramname"><em>tmp_folder</em> = <code>CheMPS2::defaultTMPpath</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ham_in</td><td><a class="el" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a> containing the matrix elements of the <a class="el" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a> for which a <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> calculation is desired </td></tr>
    <tr><td class="paramname">docc</td><td>Array containing the number of doubly occupied HF orbitals per irrep </td></tr>
    <tr><td class="paramname">socc</td><td>Array containing the number of singly occupied HF orbitals per irrep </td></tr>
    <tr><td class="paramname">nocc</td><td>Array containing the number of doubly occupied (inactive) orbitals per irrep </td></tr>
    <tr><td class="paramname">ndmrg</td><td>Array containing the number of active orbitals per irrep </td></tr>
    <tr><td class="paramname">nvirt</td><td>Array containing the number of virtual (secondary) orbitals per irrep </td></tr>
    <tr><td class="paramname">tmp_folder</td><td>Temporary work folder for the <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> renormalized operators and the ERI rotations </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00039">39</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a1e026f0ae4af55325996c6c97af11917_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a1e026f0ae4af55325996c6c97af11917_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a1e026f0ae4af55325996c6c97af11917_cgraph" id="classCheMPS2_1_1CASSCF_a1e026f0ae4af55325996c6c97af11917_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1MPIchemps2.html#a6732ae60b5b4c8a4f1b063f9db304bf5" title="Get the rank of this MPI process. " alt="" coords="277,64,444,105"/>
<area shape="rect" id="node6" href="classCheMPS2_1_1Hamiltonian.html#a031fa6987b304e3a7f6114b9f2e1f2ab" title="Get the constant energy. " alt="" coords="281,129,440,171"/>
<area shape="rect" id="node7" href="classCheMPS2_1_1Hamiltonian.html#ac0b8314dc6133642997e648d1169d10f" title="Get a Tmat element. " alt="" coords="281,195,440,236"/>
<area shape="rect" id="node9" href="classCheMPS2_1_1Hamiltonian.html#af2d3836be75d50640cbed9a9234af126" title="Get a Vmat element. " alt="" coords="281,260,440,301"/>
<area shape="rect" id="node13" href="classCheMPS2_1_1Irreps.html#afd3d1b65e870aad920125c05606c4a7d" title="Get the number of irreps for the currently activated group. " alt="" coords="987,319,1181,360"/>
<area shape="rect" id="node15" href="classCheMPS2_1_1Hamiltonian.html#a101963cfa8f06abe798a7ae79faab618" title="Get the number of orbitals. " alt="" coords="281,377,440,419"/>
<area shape="rect" id="node16" href="classCheMPS2_1_1Irreps.html#aca6fdd79557f9189153258daad5fbe8c" title="Set the group. " alt="" coords="755,410,939,437"/>
<area shape="rect" id="node17" href="classCheMPS2_1_1Hamiltonian.html#a8c18f51ded63810e316f1834853dce21" title="Get the group number. " alt="" coords="281,495,440,536"/>
<area shape="rect" id="node18" href="classCheMPS2_1_1Irreps.html#a9813550797b0557cf22d2bca5f3e07b0" title="Get the group number. " alt="" coords="515,524,699,565"/>
<area shape="rect" id="node19" href="classCheMPS2_1_1FourIndex.html#a6488d46b83685234b81a529d61d91cd6" title="Get a given irrep size. " alt="" coords="287,612,435,653"/>
<area shape="rect" id="node20" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="261,677,460,719"/>
<area shape="rect" id="node21" href="classCheMPS2_1_1DMRGSCFmatrix.html#a0729b05fef0cb96eaf26e7c8d6017931" title="Clear the matrix. " alt="" coords="263,743,458,784"/>
<area shape="rect" id="node23" href="classCheMPS2_1_1DMRGSCFindices.html#a9e59260eecdb760a58464e330b313928" title="Print my contents. " alt="" coords="261,808,460,849"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1MPIchemps2.html#a2a6ae387436d5e5b0a320a12b87244e1" title="Get the number of MPI processes. " alt="" coords="524,5,691,47"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1Tensor.html#ad68f65759e764c6cb55e2b8db18f8874" title="Get the number of tensor blocks. " alt="" coords="511,71,703,98"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1Tensor.html#a2f17a5413447e77ad3f128d49b3ca676" title="Get the pointer to the storage. " alt="" coords="512,122,703,149"/>
<area shape="rect" id="node8" href="classCheMPS2_1_1TwoIndex.html#a49c7065a18ca6b82e7a63a56cdf2687c" title="Get an element. " alt="" coords="521,174,694,201"/>
<area shape="rect" id="node10" href="classCheMPS2_1_1Irreps.html#a1d86c7a8b3c3a7b9215c0e298f0ae047" title="Get the direct product of the irreps with numbers Irrep1 and Irrep2: a bitwise XOR for psi4&#39;s convent..." alt="" coords="512,225,703,251"/>
<area shape="rect" id="node14" href="classCheMPS2_1_1FourIndex.html#ae93c264cbb81e7d39db778a129dc7ca1" title="Get an element. " alt="" coords="520,275,695,302"/>
<area shape="rect" id="node11" href="classCheMPS2_1_1Irreps.html#a78b964944caac0cf835e42a428cfef67" title="Fill the array psi2molpro with the irrep conventions of molpro for the currently activated group..." alt="" coords="763,184,930,225"/>
<area shape="rect" id="node12" href="classCheMPS2_1_1Irreps.html#afd70b3b21e33a3f8163db04a768ef848" title="Print all info contained in this class. " alt="" coords="761,250,932,277"/>
<area shape="rect" id="node22" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="508,743,707,784"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a184b5eacca476b5c00750d0485b5e0b1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::augmentedHessianNR </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localFmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFwtilde.html">DMRGSCFwtilde</a> *&#160;</td>
          <td class="paramname"><em>localwtilde</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>localIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFunitary.html">DMRGSCFunitary</a> *&#160;</td>
          <td class="paramname"><em>localUmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>theupdate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>updateNorm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>gradNorm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the augmented Hessian Newton-Raphson update for the orthogonal orbital rotation matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">localFmat</td><td>Matrix which contains the Fock operator (Eq. (11) in the Siegbahn paper [CAS3]) </td></tr>
    <tr><td class="paramname">localwtilde</td><td>Object which contains the second order derivative of the energy with respect to the unitary (Eq. (20b) in the Siegbahn paper [CAS3]) </td></tr>
    <tr><td class="paramname">localIdx</td><td>Orbital index bookkeeper for the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> calculations </td></tr>
    <tr><td class="paramname">localUmat</td><td>The unitary matrix for <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> calculations (in this function it is used to fetch the orbital ordering convention of the skew-symmetric parametrization) </td></tr>
    <tr><td class="paramname">theupdate</td><td>Where the augmented Hessian Newton-Raphson update will be stored </td></tr>
    <tr><td class="paramname">updateNorm</td><td>Pointer to one double to store the update norm </td></tr>
    <tr><td class="paramname">gradNorm</td><td>Pointer to one double to store the gradient norm </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCFnewtonraphson_8cpp_source.html#l00316">316</a> of file <a class="el" href="CASSCFnewtonraphson_8cpp_source.html">CASSCFnewtonraphson.cpp</a>.</p>

<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a184b5eacca476b5c00750d0485b5e0b1_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a184b5eacca476b5c00750d0485b5e0b1_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a184b5eacca476b5c00750d0485b5e0b1_cgraph" id="classCheMPS2_1_1CASSCF_a184b5eacca476b5c00750d0485b5e0b1_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFunitary.html#a725cdfa70964b24914436fc40bba90b4" title="Get the number of variables in the x&#45;parametrization of the unitary update. " alt="" coords="281,158,479,199"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="537,49,736,90"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="537,117,736,158"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="537,187,736,229"/>
<area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFindices.html#afdbe42f60924d9fb705cce44426d72d0" title="Get the number of virtual orbitals for an irrep. " alt="" coords="537,263,736,305"/>
<area shape="rect" id="node7" href="classCheMPS2_1_1Davidson.html#a3a04d5e4423b6cfc15f985aecf50c4b2" title="The iterator to converge the ground state vector. " alt="" coords="303,326,457,367"/>
<area shape="rect" id="node8" href="classCheMPS2_1_1Davidson.html#a0a9f07122a47a4ec24e6add4b8b30797" title="Get the number of matrix vector multiplications which have been performed. " alt="" coords="303,391,457,433"/>
<area shape="rect" id="node9" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="281,457,479,498"/>
<area shape="rect" id="node10" href="classCheMPS2_1_1DMRGSCFmatrix.html#a230d9fa54109d0754a054868611177c5" title="Get a matrix block. " alt="" coords="283,522,477,563"/>
<area shape="rect" id="node11" href="classCheMPS2_1_1DMRGSCFwtilde.html#a39a6ec517f0bbd6129dce43473bfbc89" title="Get an element of w_tilde_pqrs. " alt="" coords="271,5,489,32"/>
<area shape="rect" id="node12" href="classCheMPS2_1_1DMRGSCFwtilde.html#a1315dead44fb4c153c1e93758f048378" title="Get the (pr) subblock of w_tilde_pqrs, which is stored as w_tilde[ I_pq ][ I_rs ][ p + ( Nocc[I_pq] +..." alt="" coords="284,587,476,629"/>
</map>
</div>
</p>

<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a184b5eacca476b5c00750d0485b5e0b1_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a184b5eacca476b5c00750d0485b5e0b1_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a184b5eacca476b5c00750d0485b5e0b1_icgraph" id="classCheMPS2_1_1CASSCF_a184b5eacca476b5c00750d0485b5e0b1_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#aa0ecf5c63622cb1f2aa4e72eebb31fe1" title="CASSCF DIIS vectors remove call. " alt="" coords="271,5,524,32"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1CASSCF.html#a8b4ebee13ba2a5764081fae5275f6c7e" title="Do the CASSCF cycles with the augmented Hessian Newton&#45;Raphson method. " alt="" coords="305,56,489,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a13589f3ee9f293b743676739bb1db372"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::block_diagonalize </td>
          <td>(</td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>space</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>Mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFunitary.html">DMRGSCFunitary</a> *&#160;</td>
          <td class="paramname"><em>Umat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>work1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>work2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>invert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>two_dm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>three_dm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>contract</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Block-diagonalize Mat. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">space</td><td>Can be 'O', 'A', or 'V' and denotes which block of Mat should be considered </td></tr>
    <tr><td class="paramname">Mat</td><td>Matrix to block-diagonalize </td></tr>
    <tr><td class="paramname">Umat</td><td>The unitary rotation will be updated so that Mat is block-diagonal in the orbitals 'space' </td></tr>
    <tr><td class="paramname">work1</td><td>Workspace </td></tr>
    <tr><td class="paramname">work2</td><td>Workspace </td></tr>
    <tr><td class="paramname">idx</td><td>Object which handles the index conventions for <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> </td></tr>
    <tr><td class="paramname">invert</td><td>If true, the eigenvectors are sorted from large to small instead of the other way around </td></tr>
    <tr><td class="paramname">two_dm</td><td>If not NULL, this 4-index array will be rotated to the new eigenvecs if space == 'A' </td></tr>
    <tr><td class="paramname">three_dm</td><td>If not NULL, this 6-index array will be rotated to the new eigenvecs if space == 'A' </td></tr>
    <tr><td class="paramname">contract</td><td>If not NULL, this 6-index array will be rotated to the new eigenvecs if space == 'A' </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00433">433</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a13589f3ee9f293b743676739bb1db372_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a13589f3ee9f293b743676739bb1db372_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a13589f3ee9f293b743676739bb1db372_cgraph" id="classCheMPS2_1_1CASSCF_a13589f3ee9f293b743676739bb1db372_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1MPIchemps2.html#a6732ae60b5b4c8a4f1b063f9db304bf5" title="Get the rank of this MPI process. " alt="" coords="264,64,431,105"/>
<area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="248,129,447,171"/>
<area shape="rect" id="node7" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="248,195,447,236"/>
<area shape="rect" id="node8" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="505,377,704,419"/>
<area shape="rect" id="node9" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="248,312,447,353"/>
<area shape="rect" id="node10" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="248,377,447,419"/>
<area shape="rect" id="node11" href="classCheMPS2_1_1DMRGSCFindices.html#afdbe42f60924d9fb705cce44426d72d0" title="Get the number of virtual orbitals for an irrep. " alt="" coords="248,443,447,484"/>
<area shape="rect" id="node12" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9" title="Get an element. " alt="" coords="237,509,457,535"/>
<area shape="rect" id="node13" href="classCheMPS2_1_1DMRGSCFmatrix.html#a230d9fa54109d0754a054868611177c5" title="Get a matrix block. " alt="" coords="250,560,445,601"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1MPIchemps2.html#a2a6ae387436d5e5b0a320a12b87244e1" title="Get the number of MPI processes. " alt="" coords="521,5,688,47"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1Tensor.html#ad68f65759e764c6cb55e2b8db18f8874" title="Get the number of tensor blocks. " alt="" coords="509,71,701,98"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1Tensor.html#a2f17a5413447e77ad3f128d49b3ca676" title="Get the pointer to the storage. " alt="" coords="509,122,700,149"/>
</map>
</div>
</p>

<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a13589f3ee9f293b743676739bb1db372_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a13589f3ee9f293b743676739bb1db372_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a13589f3ee9f293b743676739bb1db372_icgraph" id="classCheMPS2_1_1CASSCF_a13589f3ee9f293b743676739bb1db372_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#aa0ecf5c63622cb1f2aa4e72eebb31fe1" title="CASSCF DIIS vectors remove call. " alt="" coords="237,5,491,32"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1CASSCF.html#a8b4ebee13ba2a5764081fae5275f6c7e" title="Do the CASSCF cycles with the augmented Hessian Newton&#45;Raphson method. " alt="" coords="272,56,456,83"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1CASSCF.html#a0e8e56a34c6f28fe27341425a1db8384" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="268,107,460,133"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0210ff118bab44593aef7c6ec9f31a56"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::buildFmat </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localFmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localTmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localJKocc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localJKact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>localIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFintegrals.html">DMRGSCFintegrals</a> *&#160;</td>
          <td class="paramname"><em>theInts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>local2DM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>local1DM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build the F-matrix (Eq. (11) in the Siegbahn paper [CAS3]) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">localFmat</td><td>Matrix where the result should be stored </td></tr>
    <tr><td class="paramname">localTmat</td><td>Matrix which contains the one-electron integrals </td></tr>
    <tr><td class="paramname">localJKocc</td><td>Matrix which contains the Coulomb and exchange interaction due to the frozen core orbitals </td></tr>
    <tr><td class="paramname">localJKact</td><td>Matrix which contains the Coulomb and exchange interaction due to the active space </td></tr>
    <tr><td class="paramname">localIdx</td><td>Orbital index bookkeeper for the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> calculations </td></tr>
    <tr><td class="paramname">theInts</td><td>The rotated two-electron integrals (at most 2 virtual indices) </td></tr>
    <tr><td class="paramname">local2DM</td><td>The <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 2-RDM </td></tr>
    <tr><td class="paramname">local1DM</td><td>The <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 1-RDM </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCFnewtonraphson_8cpp_source.html#l00823">823</a> of file <a class="el" href="CASSCFnewtonraphson_8cpp_source.html">CASSCFnewtonraphson.cpp</a>.</p>

<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_cgraph" id="classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFmatrix.html#a0729b05fef0cb96eaf26e7c8d6017931" title="Clear the matrix. " alt="" coords="277,5,471,47"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="536,221,735,263"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="275,123,473,164"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="275,188,473,229"/>
<area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="275,253,473,295"/>
<area shape="rect" id="node7" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="275,319,473,360"/>
<area shape="rect" id="node8" href="classCheMPS2_1_1DMRGSCFmatrix.html#a3660ff17cbeb278c265b6461450b1a24" title="Set an element. " alt="" coords="264,385,484,411"/>
<area shape="rect" id="node9" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9" title="Get an element. " alt="" coords="264,435,484,462"/>
<area shape="rect" id="node10" href="classCheMPS2_1_1DMRGSCFmatrix.html#a230d9fa54109d0754a054868611177c5" title="Get a matrix block. " alt="" coords="277,487,471,528"/>
<area shape="rect" id="node11" href="classCheMPS2_1_1Irreps.html#a1d86c7a8b3c3a7b9215c0e298f0ae047" title="Get the direct product of the irreps with numbers Irrep1 and Irrep2: a bitwise XOR for psi4&#39;s convent..." alt="" coords="787,603,977,630"/>
<area shape="rect" id="node16" href="classCheMPS2_1_1DMRGSCFintegrals.html#ad462dfa92d77f1f02371f12e91cac429" title="Get a two&#45;body matrix element with at most 2 virtual indices, using the FourIndex API..." alt="" coords="271,629,477,671"/>
<area shape="rect" id="node12" href="classCheMPS2_1_1Irreps.html#a78b964944caac0cf835e42a428cfef67" title="Fill the array psi2molpro with the irrep conventions of molpro for the currently activated group..." alt="" coords="1027,537,1194,579"/>
<area shape="rect" id="node14" href="classCheMPS2_1_1Irreps.html#afd70b3b21e33a3f8163db04a768ef848" title="Print all info contained in this class. " alt="" coords="1025,603,1196,630"/>
<area shape="rect" id="node13" href="classCheMPS2_1_1Irreps.html#aa56e8dea52881f0c86c348539b21bb5c" title="Get the name of the group. " alt="" coords="1244,545,1463,571"/>
<area shape="rect" id="node15" href="classCheMPS2_1_1Irreps.html#afd3d1b65e870aad920125c05606c4a7d" title="Get the number of irreps for the currently activated group. " alt="" coords="1256,596,1451,637"/>
<area shape="rect" id="node17" href="classCheMPS2_1_1DMRGSCFintegrals.html#a2c40911e39bd643684180ff400b2a9f4" title="Get an element of the Coulomb object ( c1 c2 | a1 a2 ) " alt="" coords="532,655,739,696"/>
<area shape="rect" id="node18" href="classCheMPS2_1_1DMRGSCFintegrals.html#ad3549d8b199d76fdc1edab70e132dcb0" title="Get an element of the Exchange object ( c1 v1 | c2 v2 ) " alt="" coords="532,720,739,761"/>
</map>
</div>
</p>

<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_icgraph" id="classCheMPS2_1_1CASSCF_a0210ff118bab44593aef7c6ec9f31a56_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#aa0ecf5c63622cb1f2aa4e72eebb31fe1" title="CASSCF DIIS vectors remove call. " alt="" coords="264,5,517,32"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1CASSCF.html#a8b4ebee13ba2a5764081fae5275f6c7e" title="Do the CASSCF cycles with the augmented Hessian Newton&#45;Raphson method. " alt="" coords="299,56,483,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a21471f166b873029b5e51dda4a6907c4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::buildWtilde </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFwtilde.html">DMRGSCFwtilde</a> *&#160;</td>
          <td class="paramname"><em>localwtilde</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localTmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localJKocc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>localJKact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>localIdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFintegrals.html">DMRGSCFintegrals</a> *&#160;</td>
          <td class="paramname"><em>theInts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>local2DM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>local1DM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build the Wtilde-matrix (Eq. (20b) in the Siegbahn paper [CAS3]) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">localwtilde</td><td>Where the result should be stored </td></tr>
    <tr><td class="paramname">localTmat</td><td>Matrix which contains the one-electron integrals </td></tr>
    <tr><td class="paramname">localJKocc</td><td>Matrix which contains the Coulomb and exchange interaction due to the frozen core orbitals </td></tr>
    <tr><td class="paramname">localJKact</td><td>Matrix which contains the Coulomb and exchange interaction due to the active space </td></tr>
    <tr><td class="paramname">localIdx</td><td>Orbital index bookkeeper for the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> calculations </td></tr>
    <tr><td class="paramname">theInts</td><td>The rotated two-electron integrals (at most 2 virtual indices) </td></tr>
    <tr><td class="paramname">local2DM</td><td>The <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 2-RDM </td></tr>
    <tr><td class="paramname">local1DM</td><td>The <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 1-RDM </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCFnewtonraphson_8cpp_source.html#l00611">611</a> of file <a class="el" href="CASSCFnewtonraphson_8cpp_source.html">CASSCFnewtonraphson.cpp</a>.</p>

<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_cgraph" id="classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFwtilde.html#a939e077b9fcc8ffafd9a168056991795" title="Clear. " alt="" coords="285,54,477,95"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="543,22,741,63"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="543,112,741,154"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="281,171,480,212"/>
<area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="281,236,480,278"/>
<area shape="rect" id="node7" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="281,302,480,343"/>
<area shape="rect" id="node8" href="classCheMPS2_1_1DMRGSCFwtilde.html#a1315dead44fb4c153c1e93758f048378" title="Get the (pr) subblock of w_tilde_pqrs, which is stored as w_tilde[ I_pq ][ I_rs ][ p + ( Nocc[I_pq] +..." alt="" coords="285,367,477,408"/>
<area shape="rect" id="node9" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9" title="Get an element. " alt="" coords="271,433,491,460"/>
<area shape="rect" id="node10" href="classCheMPS2_1_1Irreps.html#a1d86c7a8b3c3a7b9215c0e298f0ae047" title="Get the direct product of the irreps with numbers Irrep1 and Irrep2: a bitwise XOR for psi4&#39;s convent..." alt="" coords="793,534,984,561"/>
<area shape="rect" id="node15" href="classCheMPS2_1_1DMRGSCFintegrals.html#ad462dfa92d77f1f02371f12e91cac429" title="Get a two&#45;body matrix element with at most 2 virtual indices, using the FourIndex API..." alt="" coords="277,560,484,602"/>
<area shape="rect" id="node11" href="classCheMPS2_1_1Irreps.html#a78b964944caac0cf835e42a428cfef67" title="Fill the array psi2molpro with the irrep conventions of molpro for the currently activated group..." alt="" coords="1034,468,1201,510"/>
<area shape="rect" id="node13" href="classCheMPS2_1_1Irreps.html#afd70b3b21e33a3f8163db04a768ef848" title="Print all info contained in this class. " alt="" coords="1032,534,1203,561"/>
<area shape="rect" id="node12" href="classCheMPS2_1_1Irreps.html#aa56e8dea52881f0c86c348539b21bb5c" title="Get the name of the group. " alt="" coords="1251,476,1469,502"/>
<area shape="rect" id="node14" href="classCheMPS2_1_1Irreps.html#afd3d1b65e870aad920125c05606c4a7d" title="Get the number of irreps for the currently activated group. " alt="" coords="1263,527,1457,568"/>
<area shape="rect" id="node16" href="classCheMPS2_1_1DMRGSCFintegrals.html#a2c40911e39bd643684180ff400b2a9f4" title="Get an element of the Coulomb object ( c1 c2 | a1 a2 ) " alt="" coords="539,586,745,627"/>
<area shape="rect" id="node17" href="classCheMPS2_1_1DMRGSCFintegrals.html#ad3549d8b199d76fdc1edab70e132dcb0" title="Get an element of the Exchange object ( c1 v1 | c2 v2 ) " alt="" coords="539,651,745,692"/>
</map>
</div>
</p>

<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_icgraph" id="classCheMPS2_1_1CASSCF_a21471f166b873029b5e51dda4a6907c4_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#aa0ecf5c63622cb1f2aa4e72eebb31fe1" title="CASSCF DIIS vectors remove call. " alt="" coords="271,5,524,32"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1CASSCF.html#a8b4ebee13ba2a5764081fae5275f6c7e" title="Do the CASSCF cycles with the augmented Hessian Newton&#45;Raphson method. " alt="" coords="305,56,489,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0e8e56a34c6f28fe27341425a1db8384"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CheMPS2::CASSCF::caspt2 </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nelectrons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>TwoS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Irrep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1ConvergenceScheme.html">ConvergenceScheme</a> *&#160;</td>
          <td class="paramname"><em>OptScheme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rootNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFoptions.html">DMRGSCFoptions</a> *&#160;</td>
          <td class="paramname"><em>scf_options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>IPEA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>IMAG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>PSEUDOCANONICAL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>CHECKPOINT</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>CUMULANT</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the caspt2 correction energy for a converged casscf wavefunction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Nelectrons</td><td>Total number of electrons in the system: occupied HF orbitals + active space </td></tr>
    <tr><td class="paramname">TwoS</td><td>Twice the targeted spin </td></tr>
    <tr><td class="paramname">Irrep</td><td>Desired wave-function irrep </td></tr>
    <tr><td class="paramname">OptScheme</td><td>The optimization scheme to run the inner <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> loop. If NULL: use <a class="el" href="classCheMPS2_1_1FCI.html">FCI</a> instead of <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a>. </td></tr>
    <tr><td class="paramname">rootNum</td><td>Denotes the targeted state in state-specific <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a>; 1 means ground state, 2 first excited state etc. </td></tr>
    <tr><td class="paramname">scf_options</td><td>Contains the DMRGSCF options </td></tr>
    <tr><td class="paramname">IPEA</td><td>The <a class="el" href="classCheMPS2_1_1CASPT2.html">CASPT2</a> IPEA shift from Ghigo, Roos and Malmqvist, Chemical Physics Letters 396, 142-149 (2004) </td></tr>
    <tr><td class="paramname">IMAG</td><td>The <a class="el" href="classCheMPS2_1_1CASPT2.html">CASPT2</a> imaginary shift from Forsberg and Malmqvist, Chemical Physics Letters 274, 196-204 (1997) </td></tr>
    <tr><td class="paramname">PSEUDOCANONICAL</td><td>If true, use the exact <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 4-RDM in the pseudocanonical basis. If false, use the cumulant approximated <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 4-RDM in the unrotated basis. </td></tr>
    <tr><td class="paramname">CHECKPOINT</td><td>If true, write checkpoints to disk and read them back in again in order to perform the contraction of the generalized Fock operator with the 4-RDM in multiple runs. </td></tr>
    <tr><td class="paramname">CUMULANT</td><td>If true, a cumulant approximation is used for the 4-RDM and CHECKPOINT is overwritten to false. If false, the full 4-RDM is used. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The <a class="el" href="classCheMPS2_1_1CASPT2.html">CASPT2</a> variational correction energy </dd></dl>

<p>Definition at line <a class="el" href="CASSCFpt2_8cpp_source.html#l00189">189</a> of file <a class="el" href="CASSCFpt2_8cpp_source.html">CASSCFpt2.cpp</a>.</p>

<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a0e8e56a34c6f28fe27341425a1db8384_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a0e8e56a34c6f28fe27341425a1db8384_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a0e8e56a34c6f28fe27341425a1db8384_cgraph" id="classCheMPS2_1_1CASSCF_a0e8e56a34c6f28fe27341425a1db8384_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1MPIchemps2.html#a6732ae60b5b4c8a4f1b063f9db304bf5" title="Get the rank of this MPI process. " alt="" coords="1477,5419,1643,5460"/>
<area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFindices.html#a2cb6c31a775d6f155942dc127eee2218" title="Get the total number of occupied orbitals. " alt="" coords="564,7288,763,7329"/>
<area shape="rect" id="node9" href="classCheMPS2_1_1CASPT2.html#a0aad4cf7db898047a811ea75f45b2abc" title="Return the vector length for the CASPT2 first order wavefunction (before diagonalization of the overl..." alt="" coords="570,6772,757,6813"/>
<area shape="rect" id="node24" href="classCheMPS2_1_1DMRGSCFindices.html#ade657fa7e0ebf49098f5d22172a0dc01" title="Get the maximum NORB. " alt="" coords="564,7471,763,7512"/>
<area shape="rect" id="node25" href="classCheMPS2_1_1DMRGSCFoptions.html#acea3d3f5a5abf8a4bdd509fc13a1a275" title="Get whether the Orbital Rotation checkpoint should be stored to disk. " alt="" coords="271,10100,471,10141"/>
<area shape="rect" id="node26" href="classCheMPS2_1_1DMRGSCFoptions.html#a45fb0323c73651fb83f6856af5145e83" title="Get the Orbital Rotation checkpoint filename. " alt="" coords="271,10165,471,10207"/>
<area shape="rect" id="node27" href="classCheMPS2_1_1DMRGSCFunitary.html#a93dc806a8a1c931334570903c326220e" title="Load the unitary from disk. " alt="" coords="272,7625,469,7667"/>
<area shape="rect" id="node29" href="classCheMPS2_1_1CASSCF.html#a10b37b294f7573005a6b49b669e734ca" title="Construct the Fock matrix. " alt="" coords="544,7354,783,7381"/>
<area shape="rect" id="node30" href="classCheMPS2_1_1CASSCF.html#a13589f3ee9f293b743676739bb1db372" title="Block&#45;diagonalize Mat. " alt="" coords="571,6932,755,6973"/>
<area shape="rect" id="node32" href="classCheMPS2_1_1DMRGSCFunitary.html#aa40f3a37dd71b9a2c714fc98094d115e" title="Save the unitary to disk. " alt="" coords="272,7532,469,7573"/>
<area shape="rect" id="node34" href="classCheMPS2_1_1Irreps.html#a9813550797b0557cf22d2bca5f3e07b0" title="Get the group number. " alt="" coords="571,10281,755,10323"/>
<area shape="rect" id="node35" href="classCheMPS2_1_1DMRGSCFindices.html#ae04eb205d9aa13edaae834e535c3396d" title="Get an array with the irreps of each DMRG orbital. " alt="" coords="271,10348,470,10389"/>
<area shape="rect" id="node36" href="classCheMPS2_1_1DMRGSCFrotations.html#a0ac61c3fa5cf82a20d0664b1e1452ea0" title="Fill the rotated two&#45;body matrix elements for the space. If the blocks become too large..." alt="" coords="559,7405,767,7447"/>
<area shape="rect" id="node37" href="classCheMPS2_1_1Hamiltonian.html#af2d3836be75d50640cbed9a9234af126" title="Get a Vmat element. " alt="" coords="1481,5081,1639,5123"/>
<area shape="rect" id="node39" href="classCheMPS2_1_1DMRGSCFoptions.html#a9f81d7a089fc4a239638d95d93c24099" title="Get which active space should be considered in the DMRG routine. " alt="" coords="271,10413,471,10455"/>
<area shape="rect" id="node40" href="classCheMPS2_1_1DMRGSCFindices.html#a3689ebc91a3c11f3703ba21f53e7604d" title="Get the group number. " alt="" coords="271,10283,470,10324"/>
<area shape="rect" id="node41" href="classCheMPS2_1_1EdmistonRuedenberg.html#aeefc7cee7eae7da6c2beb4e0c0cdfd7c" title="Permute the orbitals so that the bandwidth of the exchange matrix is (approximately) minimized..." alt="" coords="263,9983,478,10024"/>
<area shape="rect" id="node45" href="classCheMPS2_1_1CASSCF.html#ad493cbf60a7b807ad0d3a06de74001b9" title="Read the checkpoint file for the contraction of the generalized Fock operator with the 4&#45;RDM from dis..." alt="" coords="281,6376,460,6417"/>
<area shape="rect" id="node46" href="classCheMPS2_1_1FCI.html#af904234f3a73203c39ddadba56d49555" title="Getter for the number of variables in the vector &quot; E_ij | FCI vector &gt; &quot; ; where irrep_center = I_i x..." alt="" coords="2861,9203,3061,9230"/>
<area shape="rect" id="node47" href="classCheMPS2_1_1FCI.html#afb601467d67d5d85b3783d144d608557" title="Set the entries of a vector to zero. " alt="" coords="2867,7794,3056,7821"/>
<area shape="rect" id="node48" href="classCheMPS2_1_1FCI.html#a34faadeeb812173bfa523f8619d40f87" title="Return the global counter of the Slater determinant with the lowest energy. " alt="" coords="2056,9353,2259,9395"/>
<area shape="rect" id="node55" href="classCheMPS2_1_1FCI.html#a9fba49f1eba2366bd5a26d6d5521c8e8" title="Calculates the FCI ground state with Davidson&#39;s algorithm. " alt="" coords="273,8933,468,8959"/>
<area shape="rect" id="node62" href="classCheMPS2_1_1FCI.html#a36e81090d6d9c12eb8e86f65ce1e66b4" title="Construct the (spin&#45;summed) 2&#45;RDM of a FCI vector: Gamma^2(i,j,k,l) = sum_sigma,tau &lt; a^+_i..." alt="" coords="2070,8350,2245,8377"/>
<area shape="rect" id="node65" href="classCheMPS2_1_1FCI.html#a46c8a713121b5554e76ffdd640450e2d" title="Construct the (spin&#45;summed) 3&#45;RDM of a FCI vector: Gamma^3(i,j,k,l,m,n) = sum_sigma,tau,s &lt; a^+_{i,sigma} a^+_{j,tau} a^+_{k,s} a_{n,s} a_{m,tau} a_{l,sigma} &gt; = ThreeRDM[ i + L * ( j + L * ( k + L * ( l + L * ( m + L * n ) ) ) ) ]. " alt="" coords="871,9875,1045,9902"/>
<area shape="rect" id="node67" href="classCheMPS2_1_1FCI.html#a91869efdf5f581c444c69627bd3b593a" title="Construct the (spin&#45;summed) contraction of the 4&#45;RDM with the Fock operator: output(i,j,k,p,q,r) = sum_{l,t} Fock(l,t) * Gamma^4(i,j,k,l,p,q,r,t) " alt="" coords="865,9926,1051,9953"/>
<area shape="rect" id="node94" href="classCheMPS2_1_1CASSCF.html#ac35e694fd9e00f47d361bdbd47b787e1" title="Construct the 1&#45;RDM from the 2&#45;RDM. " alt="" coords="251,5958,491,5985"/>
<area shape="rect" id="node95" href="classCheMPS2_1_1CASSCF.html#a3f20d25b94c1d821f22f95a6bab0ebc7" title="Copy a one&#45;orbital quantity from array format to DMRGSCFmatrix format. " alt="" coords="573,7167,754,7208"/>
<area shape="rect" id="node97" href="classCheMPS2_1_1DMRG.html#acfb3123c72e3503f2d6c77dcf9eb141a" title="Push back current calculation and set everything up to calculate a (new) excitation. " alt="" coords="553,5755,774,5782"/>
<area shape="rect" id="node99" href="classCheMPS2_1_1DMRG.html#ab6d80dde8b71171ee969a6b7b86193d2" title="Solver. " alt="" coords="577,3801,749,3827"/>
<area shape="rect" id="node145" href="classCheMPS2_1_1DMRG.html#ab442cbc43e2e5d877660859578849133" title="Activate the necessary storage and machinery to handle excitations. " alt="" coords="245,10479,496,10506"/>
<area shape="rect" id="node146" href="classCheMPS2_1_1DMRG.html#a43f338725791d3b5822acdba6444c056" title="Calculate the reduced density matrices and correlations. Afterwards the MPS is again in LLLLLLLC gaug..." alt="" coords="289,2019,452,2060"/>
<area shape="rect" id="node186" href="classCheMPS2_1_1CASSCF.html#a0dbcb41aa9097e3b45b93c232337ec8a" title="Copy over the DMRG 2&#45;RDM. " alt="" coords="253,5686,488,5713"/>
<area shape="rect" id="node188" href="classCheMPS2_1_1DMRG.html#a0b471ea7ea19f7a49e6e1412f443d5ac" title="Get the pointer to the 2&#45;RDM. " alt="" coords="278,10530,463,10557"/>
<area shape="rect" id="node189" href="classCheMPS2_1_1Cumulant.html#a71af6ca25a81326cac7f772bd9723ab7" title="Contract the CASPT2 Fock operator with the cumulant approximation of &#160;in &#160;time, using HAM indices..." alt="" coords="568,5495,759,5536"/>
<area shape="rect" id="node191" href="classCheMPS2_1_1DMRG.html#ae87028e0d13f774aa31d5b41978e6aa4" title="Get the pointer to the 3&#45;RDM. " alt="" coords="278,4617,463,4643"/>
<area shape="rect" id="node194" href="classCheMPS2_1_1ThreeDM.html#af918bc3d3c4655263b8205a2f99632c8" title="Perform storage[ :, :, :, :, :, : ] { = or += } alpha * 3&#45;RDM[ :, :, :, :, :, last_orb_start: last_or..." alt="" coords="875,5101,1041,5143"/>
<area shape="rect" id="node202" href="classCheMPS2_1_1CASSCF.html#a3f1e0dc3e01be6e48eed126ca0ff1fd9" title="Build the contraction of the fock matrix with the 4&#45;RDM. " alt="" coords="281,4941,460,4983"/>
<area shape="rect" id="node204" href="classCheMPS2_1_1DMRG.html#a0f4e487c40f522846288fe1b3d55e66c" title="Call &quot;rm &quot; + CheMPS2::DMRG_MPS_storage_prefix + &quot;*.h5&quot;. " alt="" coords="250,10581,491,10607"/>
<area shape="rect" id="node205" href="classCheMPS2_1_1DMRG.html#a2254cc31b5d9497694ea2229226b7bd6" title="Call &quot;rm &quot; + tempfolder + &quot;/&quot; + CheMPS2::DMRG_OPERATOR_storage_prefix + string(thePID) + &quot;*..." alt="" coords="265,10632,477,10673"/>
<area shape="rect" id="node206" href="classCheMPS2_1_1CASSCF.html#ad4c00cd4c21dc402ad5e966232b199d3" title="Return the RMS deviation from block&#45;diagonal. " alt="" coords="561,7049,766,7091"/>
<area shape="rect" id="node207" href="classCheMPS2_1_1CASPT2.html#acda216c42c5245d79ae398ec59f2253f" title="Solve for the CASPT2 energy (note that the IPEA shift has been set in the constructor) ..." alt="" coords="280,6569,461,6595"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1MPIchemps2.html#a2a6ae387436d5e5b0a320a12b87244e1" title="Get the number of MPI processes. " alt="" coords="1781,5389,1948,5431"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1Tensor.html#ad68f65759e764c6cb55e2b8db18f8874" title="Get the number of tensor blocks. " alt="" coords="1769,5455,1961,5482"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1Tensor.html#a2f17a5413447e77ad3f128d49b3ca676" title="Get the pointer to the storage. " alt="" coords="1769,633,1960,659"/>
<area shape="rect" id="node7" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="859,7348,1057,7389"/>
<area shape="rect" id="node8" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="859,7049,1057,7091"/>
<area shape="rect" id="node10" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="859,6932,1057,6973"/>
<area shape="rect" id="node11" href="classCheMPS2_1_1DMRGSCFindices.html#afdbe42f60924d9fb705cce44426d72d0" title="Get the number of virtual orbitals for an irrep. " alt="" coords="859,6801,1057,6843"/>
<area shape="rect" id="node12" href="classCheMPS2_1_1Irreps.html#a1d86c7a8b3c3a7b9215c0e298f0ae047" title="Get the direct product of the irreps with numbers Irrep1 and Irrep2: a bitwise XOR for psi4&#39;s convent..." alt="" coords="2866,6610,3057,6637"/>
<area shape="rect" id="node15" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9" title="Get an element. " alt="" coords="848,7115,1068,7142"/>
<area shape="rect" id="node16" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="1161,7392,1360,7433"/>
<area shape="rect" id="node17" href="classCheMPS2_1_1Special.html#aa4f2b217e055a343e0446eaadd395154" title="Triangle function for two variables. " alt="" coords="1174,2569,1347,2611"/>
<area shape="rect" id="node18" href="classCheMPS2_1_1Special.html#a3fa86e2e43dd2d70bf8a80f6e0fa43f2" title="LOWER triangle function for two variables. " alt="" coords="871,6415,1045,6456"/>
<area shape="rect" id="node19" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="859,6867,1057,6908"/>
<area shape="rect" id="node20" href="classCheMPS2_1_1DMRGSCFintegrals.html#ad462dfa92d77f1f02371f12e91cac429" title="Get a two&#45;body matrix element with at most 2 virtual indices, using the FourIndex API..." alt="" coords="855,6583,1061,6624"/>
<area shape="rect" id="node21" href="classCheMPS2_1_1DMRGSCFintegrals.html#a2c40911e39bd643684180ff400b2a9f4" title="Get an element of the Coulomb object ( c1 c2 | a1 a2 ) " alt="" coords="1157,6633,1364,6675"/>
<area shape="rect" id="node22" href="classCheMPS2_1_1DMRGSCFintegrals.html#ad3549d8b199d76fdc1edab70e132dcb0" title="Get an element of the Exchange object ( c1 v1 | c2 v2 ) " alt="" coords="1157,6516,1364,6557"/>
<area shape="rect" id="node23" href="classCheMPS2_1_1DMRGSCFmatrix.html#a3660ff17cbeb278c265b6461450b1a24" title="Set an element. " alt="" coords="848,7166,1068,7193"/>
<area shape="rect" id="node13" href="classCheMPS2_1_1Irreps.html#a78b964944caac0cf835e42a428cfef67" title="Fill the array psi2molpro with the irrep conventions of molpro for the currently activated group..." alt="" coords="3111,6544,3278,6585"/>
<area shape="rect" id="node14" href="classCheMPS2_1_1Irreps.html#afd70b3b21e33a3f8163db04a768ef848" title="Print all info contained in this class. " alt="" coords="3109,6610,3280,6637"/>
<area shape="rect" id="node28" href="classCheMPS2_1_1DMRGSCFmatrix.html#acdf72e3e9d5adb923a6dfd0c0be5c27d" title="Read the DMRGSCFmatrix from disk. " alt="" coords="566,7653,761,7695"/>
<area shape="rect" id="node31" href="classCheMPS2_1_1DMRGSCFmatrix.html#a230d9fa54109d0754a054868611177c5" title="Get a matrix block. " alt="" coords="861,7283,1055,7324"/>
<area shape="rect" id="node33" href="classCheMPS2_1_1DMRGSCFmatrix.html#ac234313f31037f3ecc326451704ae688" title="Write a DMRGSCFmatrix to disk. " alt="" coords="566,7536,761,7577"/>
<area shape="rect" id="node38" href="classCheMPS2_1_1FourIndex.html#ae93c264cbb81e7d39db778a129dc7ca1" title="Get an element. " alt="" coords="1777,5293,1952,5319"/>
<area shape="rect" id="node42" href="classCheMPS2_1_1DMRGSCFindices.html#a2fd841a1120c44377df3ef8d9d1c9f27" title="Get the number of orbitals. " alt="" coords="564,10033,763,10075"/>
<area shape="rect" id="node43" href="classCheMPS2_1_1DMRGSCFindices.html#a2b1f2ae0964f9c0ecd653acfe88f5bd4" title="Get the irrep corresponding to a global orbital index. " alt="" coords="564,10099,763,10140"/>
<area shape="rect" id="node44" href="classCheMPS2_1_1DMRGSCFindices.html#a1a24f5ffe9537c50cf1a23211e3a7a5f" title="Get in the original Hamiltonian index the start orbital for the occupied orbitals with a certain irre..." alt="" coords="564,10164,763,10205"/>
<area shape="rect" id="node49" href="classCheMPS2_1_1FCI.html#abe702e621bfaec9302f81561cde3c144" title="Function which returns the diagonal elements of the FCI Hamiltonian (without Econstant!!) = Slater de..." alt="" coords="2341,9075,2516,9102"/>
<area shape="rect" id="node50" href="classCheMPS2_1_1FCI.html#aeb59e611639c0249e422f0f7c5dfda28" title="Find the bit representation of a global counter corresponding to &quot; E_ij | FCI vector &gt; &quot; ; where irre..." alt="" coords="2590,9001,2811,9027"/>
<area shape="rect" id="node53" href="classCheMPS2_1_1FCI.html#ada6d8ff3debe7a82fe843785a2b2d84e" title="Function which returns the AUGMENTED one&#45;body matrix elements ( G_{ij} = T_{ij} &#45; 0..." alt="" coords="2876,8443,3047,8470"/>
<area shape="rect" id="node54" href="classCheMPS2_1_1FCI.html#a56cbdfb4af815c382559c888a32e67ac" title="Function which returns the electron repulsion integral (in chemists notation: integral dr1 dr2 orb1(r..." alt="" coords="2881,8494,3042,8521"/>
<area shape="rect" id="node51" href="classCheMPS2_1_1FCI.html#aa86f6afd61836e4bad67955b3f900465" title="Find the irrep of the up Slater determinant of a global counter corresponding to &quot; E_ij | FCI vector ..." alt="" coords="2871,8993,3052,9035"/>
<area shape="rect" id="node52" href="classCheMPS2_1_1FCI.html#aee672b186854b9fdaf2402203892852e" title="Convertor between two representations of a same spin&#45;projection Slater determinant. " alt="" coords="2880,9746,3043,9773"/>
<area shape="rect" id="node56" href="classCheMPS2_1_1Davidson.html#a3a04d5e4423b6cfc15f985aecf50c4b2" title="The iterator to converge the ground state vector. " alt="" coords="1184,6263,1337,6304"/>
<area shape="rect" id="node57" href="classCheMPS2_1_1FCI.html#a2da3e8cbf73c6bfb5a5f0ca6e1c7f987" title="Copy a vector. " alt="" coords="2069,10035,2246,10062"/>
<area shape="rect" id="node58" href="classCheMPS2_1_1FCI.html#a631d174616e2e3cea01205bce5379934" title="Fill a vector with random numbers in the interval [&#45;1,1[; used when output for GSDavidson is desired ..." alt="" coords="865,9825,1051,9851"/>
<area shape="rect" id="node59" href="classCheMPS2_1_1FCI.html#a6909d31a41e439edfcff0049cb200de0" title="Function which performs the Hamiltonian times Vector product (without Econstant!!) making use of the ..." alt="" coords="2619,8342,2782,8369"/>
<area shape="rect" id="node61" href="classCheMPS2_1_1FCI.html#ad9df11199ab6633de3df7b9c1c51001a" title="Function which returns the nuclear repulsion energy. " alt="" coords="574,8933,753,8959"/>
<area shape="rect" id="node93" href="classCheMPS2_1_1Davidson.html#a0a9f07122a47a4ec24e6add4b8b30797" title="Get the number of matrix vector multiplications which have been performed. " alt="" coords="1183,6111,1338,6152"/>
<area shape="rect" id="node60" href="classCheMPS2_1_1FCI.html#a79c9426a1f2d8a4b918adad9ffa89894" title="Get an orbital irrep. " alt="" coords="2865,8038,3057,8065"/>
<area shape="rect" id="node63" href="classCheMPS2_1_1FCI.html#a278f51555ab4e5da474403748cff8098" title="Apply E_{crea,anni} to |orig_vector&gt; and store the result in |result_vector&gt; " alt="" coords="2625,7871,2776,7912"/>
<area shape="rect" id="node64" href="classCheMPS2_1_1FCI.html#a568465ddb393655431e710b3f202ccaa" title="Take the inproduct of two vectors. " alt="" coords="2345,8923,2512,8950"/>
<area shape="rect" id="node66" href="classCheMPS2_1_1FCI.html#afbbec65f5e8dca3f343defa609ca108f" title="Construct the (spin&#45;summed) 4&#45;RDM of a FCI vector: Gamma^4(i,j,k,l,p,q,r,t) = sum_sigma,tau,s,z &lt; a^+_{i,sigma} a^+_{j,tau} a^+_{k,s} a^+_{l,z} a_{t,z} a_{r,s} a_{q,tau} a_{p,sigma} &gt; = FourRDM[ i + L * ( j + L * ( k + L * ( l + L * ( p + L * ( q + L * ( r + L * t ) ) ) ) ) ) ]. " alt="" coords="2070,7958,2245,7985"/>
<area shape="rect" id="node68" href="classCheMPS2_1_1FCI.html#a77058d7ff4691b13b773dd4ea6118bc8" title="Construct part of the 4&#45;RDM: output(i,j,k,p,q,r) = Gamma^4(i,j,k,z,p,q,r,z) " alt="" coords="2065,8030,2250,8057"/>
<area shape="rect" id="node69" href="classCheMPS2_1_1FCI.html#a6bccc92d238c94ba8e212075a464f48c" title="Do lapack&#39;s daxpy vec_y += alpha * vec_x. " alt="" coords="2340,9571,2517,9598"/>
<area shape="rect" id="node70" href="classCheMPS2_1_1FCI.html#ac6d07ca52369591cf7a7676c7181b45f" title="Measure S(S+1) (spin squared) " alt="" coords="2590,8646,2811,8673"/>
<area shape="rect" id="node71" href="classCheMPS2_1_1FCI.html#aaa00a4720e4796700dc9ebd83aa71cfc" title="Calculate the retarded Green&#39;s function (= addition + removal amplitude) " alt="" coords="863,8326,1053,8353"/>
<area shape="rect" id="node72" href="classCheMPS2_1_1FCI.html#ae8035a4a03bc0232f6a38a90f1477a60" title="Calculate the addition part of the retarded Green&#39;s function: &lt;GSvector| a_{alpha, spin(isUp)} [ omega &#45; Ham + GSenergy + I*eta ]^{&#45;1} a^+_{beta, spin(isUp)} |GSvector&gt; " alt="" coords="1165,8352,1356,8393"/>
<area shape="rect" id="node73" href="classCheMPS2_1_1FCI.html#a490f73f0901972ed913a47119b5e0f23" title="Calculate the addition Green&#39;s function: GF[i+numLeft*j] = &lt;GSvector| a_{orbsLeft[i], spin} [ alpha + beta * Ham + I*eta ]^{&#45;1} a^+_{orbsRight[j], spin} |GSvector&gt; " alt="" coords="1473,8352,1647,8393"/>
<area shape="rect" id="node74" href="classCheMPS2_1_1FCI.html#ac33683cb6adf2063e7fe0fc908c3febb" title="Set thisVector to a creator/annihilator acting on otherVector. " alt="" coords="2323,7668,2534,7709"/>
<area shape="rect" id="node75" href="classCheMPS2_1_1FCI.html#a87f310673fe8b183cb4a5bf3d3051f9f" title="Function which returns a FCI coefficient. " alt="" coords="2606,7566,2795,7593"/>
<area shape="rect" id="node76" href="classCheMPS2_1_1FCI.html#adfc4c041ecd01c3610624b92dcf1ed5b" title="Convertor between two representations of a same spin&#45;projection Slater determinant. " alt="" coords="2880,7389,3043,7415"/>
<area shape="rect" id="node77" href="classCheMPS2_1_1FCI.html#ab41b5c8e777fcdfeb700c7763f64f805" title="Calculate the solution of the equation ( alpha + beta * Hamiltonian + I * eta ) Solution = RHS with c..." alt="" coords="1755,9614,1974,9641"/>
<area shape="rect" id="node78" href="classCheMPS2_1_1FCI.html#a34f2b199f72e604c96f1aeda63f00d21" title="Calculate (without approximation) diagonal = diag[ (alpha + beta * Hamiltonian)^2 + eta^2 ] (Econstan..." alt="" coords="2063,9025,2251,9051"/>
<area shape="rect" id="node79" href="classCheMPS2_1_1FCI.html#a5dd256cb52e3b7a16ce5895dc012664e" title="Function which returns the diagonal elements of the FCI Hamiltonian squared (without Econstant!!) ..." alt="" coords="2317,8662,2540,8689"/>
<area shape="rect" id="node81" href="classCheMPS2_1_1FCI.html#a38332cb2e35e961f8b95901002385770" title="Calculate out = [(alpha + beta * Hamiltonian)^2 + eta^2] * in (Econstant is taken into account!!) ..." alt="" coords="2064,9622,2251,9649"/>
<area shape="rect" id="node82" href="classCheMPS2_1_1FCI.html#a10b843aafc2f153ee1b5dbf3699c8a1b" title="Calculate out = (alpha + beta * Hamiltonian) * in (Econstant is taken into account!!) ..." alt="" coords="2329,9323,2528,9364"/>
<area shape="rect" id="node83" href="classCheMPS2_1_1FCI.html#aabbf6b2efcbcafcac2a584c08f2be1a6" title="Calculate the removal part of the retarded Green&#39;s function: &lt;GSvector| a^+_{beta, spin(isUp)} [ omega + Ham &#45; GSenergy + I*eta ]^{&#45;1} a_{alpha, spin(isUp)} |GSvector&gt; " alt="" coords="1165,8276,1356,8317"/>
<area shape="rect" id="node84" href="classCheMPS2_1_1FCI.html#ad940e823b2f18ce3d85ff2f3a0e94889" title="Calculate the removal Green&#39;s function: GF[i+numLeft*j] = &lt;GSvector| a^+_{orbsLeft[i], spin} [ alpha + beta * Ham + I*eta ]^{&#45;1} a_{orbsRight[j], spin} |GSvector&gt; " alt="" coords="1473,8217,1647,8259"/>
<area shape="rect" id="node85" href="classCheMPS2_1_1FCI.html#a132bbdf8fb4063a5199c7cbbbdccc0e0" title="Calculate the density response Green&#39;s function (= forward &#45; backward propagating part) ..." alt="" coords="1139,9563,1382,9590"/>
<area shape="rect" id="node86" href="classCheMPS2_1_1FCI.html#ac8ae42bbe769daf5254064e65adc076f" title="Calculate the forward propagating part of the density response Green&#39;s function: &lt;GSvector| ( n_alpha..." alt="" coords="1448,9665,1672,9707"/>
<area shape="rect" id="node87" href="classCheMPS2_1_1FCI.html#ac7b47739c602e3351baca282bdc715ca" title="Set resultVector to the number operator of a specific site acting on sourceVector. " alt="" coords="1758,9868,1971,9909"/>
<area shape="rect" id="node88" href="classCheMPS2_1_1FCI.html#aee7af7bfd2815c30db028025d573a684" title="Calculate the backward propagating part of the density response Green&#39;s function: &lt;GSvector| ( n_beta..." alt="" coords="1448,9548,1672,9589"/>
<area shape="rect" id="node89" href="classCheMPS2_1_1FCI.html#adf8c063a9d17fe98f0bcaba1281c648f" title="Sandwich the Hamiltonian between two Slater determinants (return a specific element) (without Econsta..." alt="" coords="2588,8443,2813,8470"/>
<area shape="rect" id="node90" href="classCheMPS2_1_1FCI.html#aa1acb129d5615d8ea7840a3909032726" title="Calculate the 2&#45;norm of a vector. " alt="" coords="2045,8857,2269,8883"/>
<area shape="rect" id="node91" href="classCheMPS2_1_1FCI.html#a68a5f1dd25036aa6d5e1b395746ee04a" title="Do lapack&#39;s dscal vec *= alpha. " alt="" coords="871,8907,1045,8934"/>
<area shape="rect" id="node92" href="classCheMPS2_1_1FCI.html#afe4f50a1de6b4c6a6be2f7e8dd4b91e2" title="Calculate the solution of the system Operator |Sol&gt; = |RESID&gt; with Operator = precon * [ ( alpha + be..." alt="" coords="855,8958,1061,8985"/>
<area shape="rect" id="node80" href="classCheMPS2_1_1ConjugateGradient.html#a37f5465c918d5d922fc5b108ab29f6ea" title="The iterator to converge the ground state vector. " alt="" coords="2058,8908,2257,8949"/>
<area shape="rect" id="node96" href="classCheMPS2_1_1DMRGSCFmatrix.html#a0729b05fef0cb96eaf26e7c8d6017931" title="Clear the matrix. " alt="" coords="861,7217,1055,7259"/>
<area shape="rect" id="node98" href="classCheMPS2_1_1DMRG.html#aa6e349febeaf92b9dfa4c7f92d8507d4" title="Reconstruct the renormalized operators when you overwrite the matrix elements with Prob&#45;&gt;setMxElement..." alt="" coords="862,5705,1054,5731"/>
<area shape="rect" id="node100" href="classCheMPS2_1_1ConvergenceScheme.html#a1d5339434adafc615592bf92ab9feb16" title="Get the number of instructions. " alt="" coords="851,3629,1065,3671"/>
<area shape="rect" id="node101" href="classCheMPS2_1_1ConvergenceScheme.html#ac12ca4a6c69913388eca92bdc361f118" title="Get the energy convergence threshold for a particular instruction. " alt="" coords="851,3695,1065,3736"/>
<area shape="rect" id="node102" href="classCheMPS2_1_1ConvergenceScheme.html#a982fa5f929b66ed42211f64eb6d5a192" title="Get the number of renormalized states for a particular instruction. " alt="" coords="851,3760,1065,3801"/>
<area shape="rect" id="node103" href="classCheMPS2_1_1ConvergenceScheme.html#aaa418f2b95ef871dca6a6aa4d6b0b8cb" title="Get the noise prefactor for a particular instruction. " alt="" coords="851,3825,1065,3867"/>
<area shape="rect" id="node104" href="classCheMPS2_1_1ConvergenceScheme.html#a487130810ed96f93112f07e9beb65f3c" title="Get the Davidson residual tolerance for a particular instruction. " alt="" coords="851,3564,1065,3605"/>
<area shape="rect" id="node105" href="classCheMPS2_1_1Sobject.html#a687a29eab89ef3763af8c630b48e3bf6" title="Join two sites to form a composite S&#45;object. " alt="" coords="1177,2939,1344,2966"/>
<area shape="rect" id="node110" href="classCheMPS2_1_1Heff.html#a1075e481d1a1d12f09f791be7389d2f4" title="Davidson Solver. " alt="" coords="845,4446,1071,4473"/>
<area shape="rect" id="node116" href="classCheMPS2_1_1Problem.html#a6c6f133286114da1666965c8048e47a1" title="Get the constant part of the Hamiltonian. " alt="" coords="861,4291,1055,4318"/>
<area shape="rect" id="node135" href="classCheMPS2_1_1Sobject.html#abe676ef06644b5b675c65b123d118f2c" title="Add noise to the current S&#45;object. " alt="" coords="859,4345,1057,4371"/>
<area shape="rect" id="node136" href="classCheMPS2_1_1Sobject.html#a34983e86ae9f19de0be6b923479c13df" title="SVD an S&#45;object into 2 TensorT&#39;s. " alt="" coords="874,3294,1042,3321"/>
<area shape="rect" id="node106" href="classCheMPS2_1_1Special.html#afffda0b19a0e9dc4bddca5fb3ebfd350" title="Phase function. " alt="" coords="1472,2737,1648,2763"/>
<area shape="rect" id="node107" href="classCheMPS2_1_1SyBookkeeper.html#ade15ac00f19abf28ea238a7d2530e049" title="Get the current virtual dimensions. " alt="" coords="1473,1199,1647,1240"/>
<area shape="rect" id="node108" href="classCheMPS2_1_1TensorT.html#aafb4d43ad6178437b47a32a24c375fa3" title="Get the pointer to the storage. " alt="" coords="1461,2686,1659,2713"/>
<area shape="rect" id="node109" href="classCheMPS2_1_1Wigner.html#a552611fbd1be53036fc06e52fc8632fa" title="Wigner&#45;6j symbol (gsl api) " alt="" coords="1467,3105,1653,3131"/>
<area shape="rect" id="node111" href="classCheMPS2_1_1Sobject.html#aff81bb404f07da2814b396306fb38588" title="Get the storage jump corresponding to a certain symmetry block. " alt="" coords="1149,5131,1373,5158"/>
<area shape="rect" id="node112" href="classCheMPS2_1_1Sobject.html#a1dfbe469443fbf7daa49c1d0cb34425e" title="Get the number of symmetry blocks. " alt="" coords="1163,5081,1359,5107"/>
<area shape="rect" id="node113" href="classCheMPS2_1_1Sobject.html#a01b16408c5439e0eca69b2fde6d0185c" title="Convert the storage from diagram convention to symmetric Hamiltonian convention. " alt="" coords="1155,4979,1366,5006"/>
<area shape="rect" id="node114" href="classCheMPS2_1_1Sobject.html#a55a31306f564c1d220d36ac9a07623c9" title="Get the pointer to the storage. " alt="" coords="1163,4878,1358,4905"/>
<area shape="rect" id="node115" href="classCheMPS2_1_1Sobject.html#a2b482f6b45ddd735e42b906843c10e24" title="Convert the storage from symmetric Hamiltonian convention to diagram convention. " alt="" coords="1155,5030,1366,5057"/>
<area shape="rect" id="node117" href="classCheMPS2_1_1Hamiltonian.html#a031fa6987b304e3a7f6114b9f2e1f2ab" title="Get the constant energy. " alt="" coords="1181,4071,1340,4112"/>
<area shape="rect" id="node118" href="classCheMPS2_1_1Problem.html#af3ad2a73da9b8af05d145b448cf8bc36" title="Get a specific interaction matrix element. " alt="" coords="1151,3395,1370,3422"/>
<area shape="rect" id="node119" href="classCheMPS2_1_1Problem.html#a0a979c3461cc2824cb7c0e91442d5e14" title="Set the matrix elements: Note that each time you create a DMRG object, they will be overwritten with ..." alt="" coords="1445,4587,1675,4614"/>
<area shape="rect" id="node120" href="classCheMPS2_1_1Problem.html#ac2e23ae168f5c9ffa1c98a73da91def4" title="Construct a table with the h&#45;matrix elements (two&#45;body augmented with one&#45;body). Remember to recall t..." alt="" coords="1161,4559,1361,4600"/>
<area shape="rect" id="node121" href="classCheMPS2_1_1Problem.html#a6e26b40eb9bf80eb9979083b58a4e30e" title="Check whether the given parameters L, N, and TwoS are not inconsistent and whether 0&lt;=Irrep&lt;nIrreps..." alt="" coords="1133,4238,1388,4265"/>
<area shape="rect" id="node126" href="classCheMPS2_1_1Problem.html#a2b562b3dce075741cf3cf038143a2754" title="Get whether the Hamiltonian orbitals are reordered for the DMRG calculation. " alt="" coords="1161,5553,1360,5579"/>
<area shape="rect" id="node127" href="classCheMPS2_1_1Problem.html#af261a2869feffd866b1f7ee5052c9ae9" title="Get the DMRG index corresponding to a Ham index. " alt="" coords="1179,5502,1343,5529"/>
<area shape="rect" id="node128" href="classCheMPS2_1_1Problem.html#ac5d35cb647b66606e3cf69a21bbcb98a" title="Get the Ham index corresponding to a DMRG index. " alt="" coords="1179,4137,1343,4163"/>
<area shape="rect" id="node129" href="classCheMPS2_1_1Problem.html#ace8f96e419792f829198e96b897da0a9" title="Reorder the orbitals, so that they form irrep blocks, with order of irreps Ag B1u B3u B2g B2u B3g B1g..." alt="" coords="1135,4289,1386,4315"/>
<area shape="rect" id="node132" href="classCheMPS2_1_1Problem.html#aac2913c0dbc0d28dc2ed6cefe853f873" title="Reorder the orbitals, so that they form irrep blocks, with order of irreps A1 B1 B2 A2..." alt="" coords="1135,4339,1386,4366"/>
<area shape="rect" id="node133" href="classCheMPS2_1_1Problem.html#aaa734d8f3bf869965af7529df4ff4dfc" title="Reorder the orbitals to a custom ordering. Previous reorderings are cleared. " alt="" coords="1471,4420,1649,4461"/>
<area shape="rect" id="node134" href="classCheMPS2_1_1Problem.html#a24b9329bce03b3d6797750a530d4dd59" title="Reorder the orbitals for d(infinity)h. Previous reorderings are cleared. " alt="" coords="1171,4441,1350,4483"/>
<area shape="rect" id="node122" href="classCheMPS2_1_1Problem.html#a15485ccb1ac98823b9e8187c16fab03f" title="Get the point group symmetry. " alt="" coords="1475,4267,1645,4294"/>
<area shape="rect" id="node123" href="classCheMPS2_1_1Problem.html#ad472d8f16b1014db3ae67478684b0c49" title="Get twice the targeted spin. " alt="" coords="1467,3446,1653,3473"/>
<area shape="rect" id="node124" href="classCheMPS2_1_1Problem.html#a634bbc2ad8be9f45ecd894f0f222885f" title="Get the targeted particle number. " alt="" coords="1783,3918,1946,3945"/>
<area shape="rect" id="node125" href="classCheMPS2_1_1Problem.html#a3e7be26cd15d22f4e0a65a34616cbcdd" title="Get the number of orbitals. " alt="" coords="1480,5030,1640,5057"/>
<area shape="rect" id="node130" href="classCheMPS2_1_1Hamiltonian.html#a101963cfa8f06abe798a7ae79faab618" title="Get the number of orbitals. " alt="" coords="1785,4420,1944,4461"/>
<area shape="rect" id="node131" href="classCheMPS2_1_1Hamiltonian.html#a02130b2901a5a3c05171d4f7dd5fa4cd" title="Get an orbital irrep number. " alt="" coords="2349,4311,2508,4352"/>
<area shape="rect" id="node137" href="classCheMPS2_1_1SyBookkeeper.html#a5e5fbbeb3f0a499ec4b905200f4a14b2" title="Get the min. possible particle number for a certain boundary. " alt="" coords="1473,1087,1647,1128"/>
<area shape="rect" id="node138" href="classCheMPS2_1_1SyBookkeeper.html#a3e5f4d30bef465424acb784caaf62628" title="Get the max. possible particle number for a certain boundary. " alt="" coords="1473,879,1647,920"/>
<area shape="rect" id="node139" href="classCheMPS2_1_1SyBookkeeper.html#ad57f3ba5107c78bdd56131c40ae4f3e9" title="Get the minimum possible spin value for a certain boundary and particle number. " alt="" coords="1473,1376,1647,1417"/>
<area shape="rect" id="node140" href="classCheMPS2_1_1SyBookkeeper.html#ad89a9ec018a14187e5a3e5b87ad9fb2c" title="Get the maximum possible spin value for a certain boundary and particle number. " alt="" coords="1473,1569,1647,1611"/>
<area shape="rect" id="node141" href="classCheMPS2_1_1SyBookkeeper.html#aac9b4729c5fe841b619b9527dbf69e12" title="Get the total number of irreps. " alt="" coords="1473,813,1647,855"/>
<area shape="rect" id="node142" href="classCheMPS2_1_1SyBookkeeper.html#a87e4bca7afcfb744aa224ab2a942c8b4" title="Get the FCI virtual dimensions ( bound by SYBK_dimensionCutoff ) " alt="" coords="1473,2235,1647,2276"/>
<area shape="rect" id="node143" href="classCheMPS2_1_1SyBookkeeper.html#aeb6f41f7c78c9e15e02e6b238419b5e7" title="Get the current virtual dimensions. " alt="" coords="1173,1511,1348,1552"/>
<area shape="rect" id="node144" href="classCheMPS2_1_1TensorT.html#a1f0830b0e729573fe19a3327462f7e7e" title="Reset the TensorT (if virtual dimensions are changed) " alt="" coords="1170,3294,1351,3321"/>
<area shape="rect" id="node147" href="classCheMPS2_1_1TwoDM.html#a5c5bf12b31aa9cb4b0b31bd53dad1ed3" title="Fill the 2DM terms with as second site index denT&#45;&gt;gIndex() " alt="" coords="866,1467,1050,1494"/>
<area shape="rect" id="node148" href="classCheMPS2_1_1TensorT.html#a279b51f0616ab58f2a2893681b4cab71" title="Get the location index. " alt="" coords="1467,329,1653,355"/>
<area shape="rect" id="node152" href="classCheMPS2_1_1TwoDM.html#a520ebec8dd2e56a475105e651a98fec3" title="Add the 2&#45;RDM elements of all MPI processes. " alt="" coords="581,1901,746,1943"/>
<area shape="rect" id="node153" href="classCheMPS2_1_1TwoDM.html#a09eb9e2471fe7fb19659b611e3e4550b" title="After the whole 2&#45;RDM is filled, a prefactor for higher multiplicities should be applied. " alt="" coords="1169,1628,1353,1669"/>
<area shape="rect" id="node155" href="classCheMPS2_1_1SyBookkeeper.html#af39babd5df4cb5eeb84ffc017af841c3" title="Get the targeted particle number. " alt="" coords="1460,3918,1660,3945"/>
<area shape="rect" id="node156" href="classCheMPS2_1_1TwoDM.html#a5ea664bc3b45270494e3d6e9f8d52619" title="Return the double trace of 2DM&#45;A (should be N(N&#45;1)) " alt="" coords="577,647,750,674"/>
<area shape="rect" id="node158" href="classCheMPS2_1_1TwoDM.html#ab35662dd77d8ae32f5b28bbe04239e79" title="Calculate the energy based on the 2DM&#45;A. " alt="" coords="572,3151,755,3178"/>
<area shape="rect" id="node159" href="classCheMPS2_1_1TwoDM.html#ac24a417e0cd64e7c3a82c94ba1d9d71c" title="Print the natural orbital occupation numbers. " alt="" coords="1159,3867,1363,3894"/>
<area shape="rect" id="node161" href="classCheMPS2_1_1ThreeDM.html#a41f377c3636898276dcb6c2f30dbf3ad" title="Fill the 3&#45;RDM terms corresponding to site denT&#45;&gt;gIndex() " alt="" coords="861,2135,1055,2162"/>
<area shape="rect" id="node171" href="classCheMPS2_1_1Correlations.html#ad0628c1674123410d212401e14812964" title="Fill at the current step of the iterations the two&#45;orbital mutual information and the remaining part ..." alt="" coords="878,1569,1038,1611"/>
<area shape="rect" id="node174" href="classCheMPS2_1_1Correlations.html#ae175e3599bab50c3fe334e3a98c41f23" title="Broadcast the diradical correlation function and the two&#45;orbital mutual information. " alt="" coords="878,2044,1038,2085"/>
<area shape="rect" id="node175" href="classCheMPS2_1_1ThreeDM.html#acceb29cbf3244a2fee196f36c87589a7" title="Add the 3&#45;RDM elements of all MPI processes. " alt="" coords="871,3228,1045,3269"/>
<area shape="rect" id="node176" href="classCheMPS2_1_1ThreeDM.html#a0a3de81e9881218690e26094be30b749" title="After the whole 3&#45;RDM is filled, a prefactor for higher multiplicities should be applied. " alt="" coords="862,3396,1054,3437"/>
<area shape="rect" id="node177" href="classCheMPS2_1_1Correlations.html#a1cf618a098e75511dda2fb0d010dab2e" title="Get the single&#45;orbital entropy for a certain site, using hte HAM indices. " alt="" coords="865,5284,1051,5325"/>
<area shape="rect" id="node178" href="classCheMPS2_1_1Correlations.html#a3e4a935011b95ad18b28b88ac56990fc" title="Return Idistance(power) (see return for definition) " alt="" coords="570,2019,757,2060"/>
<area shape="rect" id="node179" href="classCheMPS2_1_1ThreeDM.html#a363f29c1aea7e4317c3e5814099a6d5a" title="Return the trace (should be N(N&#45;1)(N&#45;2)) " alt="" coords="573,5174,754,5201"/>
<area shape="rect" id="node181" href="classCheMPS2_1_1TensorT.html#a5c9ed2cb2b6014a9b16b60670ff0d2d5" title="Get the pointer to the symmetry bookkeeper. " alt="" coords="578,1967,749,1994"/>
<area shape="rect" id="node182" href="classCheMPS2_1_1TensorT.html#a1ee5bb57153170fc200acea0859a5ef9" title="Left&#45;normalization. " alt="" coords="1177,937,1344,963"/>
<area shape="rect" id="node183" href="classCheMPS2_1_1TensorT.html#a88c0e7491c53ff6ba5a737a380df188b" title="Multiply at the left with a diagonal TensorOperator. " alt="" coords="1154,126,1367,153"/>
<area shape="rect" id="node184" href="classCheMPS2_1_1TensorT.html#abc507af3cebe59f0800c12db47bd9752" title="Right&#45;normalization. " alt="" coords="1179,886,1342,913"/>
<area shape="rect" id="node185" href="classCheMPS2_1_1TensorT.html#a06f61e76a7a6d46c1899141c75678aa8" title="Multiply at the right with a diagonal TensorOperator. " alt="" coords="1149,177,1372,203"/>
<area shape="rect" id="node149" href="classCheMPS2_1_1SyBookkeeper.html#a470a4876ee25036e3f7db2663986d608" title="Get the maximum virtual dimension at a certain boundary. " alt="" coords="1173,1039,1348,1080"/>
<area shape="rect" id="node150" href="classCheMPS2_1_1SyBookkeeper.html#ac0d4a5f26831eaf12b023c623494c144" title="Get an orbital irrep. " alt="" coords="1473,2831,1647,2872"/>
<area shape="rect" id="node151" href="classCheMPS2_1_1Problem.html#ac09cc027ab9b41132096e9bd14b549ff" title="Get an orbital irrep. " alt="" coords="2068,3817,2247,3843"/>
<area shape="rect" id="node154" href="classCheMPS2_1_1TensorOperator.html#a0013992f81ec5681774124e104a22a9d" title="Get the pointer to the storage. " alt="" coords="1470,2052,1650,2093"/>
<area shape="rect" id="node157" href="classCheMPS2_1_1TwoDM.html#a2cb905399d199f45e7101e3927933005" title="Get a 2DM_A term, using the DMRG indices. " alt="" coords="1732,3729,1997,3755"/>
<area shape="rect" id="node160" href="classCheMPS2_1_1TwoDM.html#abad942f9d45c5ec3f9b3d8d7fd5b2922" title="Get a 1&#45;RDM term, using the DMRG indices. " alt="" coords="1436,3867,1684,3894"/>
<area shape="rect" id="node162" href="classCheMPS2_1_1Special.html#abe7c3ec1d1a684a0c86693b11589eaf5" title="Triangle function for three variables. " alt="" coords="1174,1796,1347,1837"/>
<area shape="rect" id="node163" href="classCheMPS2_1_1TensorOperator.html#a0c347c3df77117eb3e6340ce032fb3b7" title="Make the in&#45;product of two TensorOperator. " alt="" coords="1171,2183,1351,2224"/>
<area shape="rect" id="node164" href="classCheMPS2_1_1TensorOperator.html#a7438680d389551c7c3d38075f83240ce" title="Get how many electrons there are more in the symmetry sector of the lower leg compared to the upper l..." alt="" coords="1470,2300,1650,2341"/>
<area shape="rect" id="node165" href="classCheMPS2_1_1TensorOperator.html#a1b08aef00ecb10b1e88220dda5c7e285" title="Get the (real&#45;valued abelian) point group irrep difference between the symmetry sectors of the lower ..." alt="" coords="1470,2365,1650,2407"/>
<area shape="rect" id="node166" href="classCheMPS2_1_1Tensor3RDM.html#abce2935d5e3293bbfbd39c7b78b4705e" title="Make the in&#45;product of two Tensor3RDMs. " alt="" coords="1177,2300,1345,2341"/>
<area shape="rect" id="node167" href="classCheMPS2_1_1Tensor3RDM.html#a119e63036c8e52a6f77123798586af1e" title="Get the spin value of the Tensor3RDM. " alt="" coords="1476,2169,1644,2211"/>
<area shape="rect" id="node168" href="classCheMPS2_1_1Tensor3RDM.html#a4829f26ff83a00999ca6c4159520702a" title="Get the intermediary spin coupling value of the Tensor3RDM. " alt="" coords="1177,1913,1345,1955"/>
<area shape="rect" id="node169" href="classCheMPS2_1_1TensorOperator.html#a2088bb2ec0105ad443d02413ee2dd998" title="Set all storage variables to 0.0. " alt="" coords="1171,5284,1351,5325"/>
<area shape="rect" id="node170" href="classCheMPS2_1_1Wigner.html#aa97a080dbd6e3377e3320abdc8c61289" title="Wigner&#45;9j symbol (gsl api) " alt="" coords="1167,3142,1354,3169"/>
<area shape="rect" id="node172" href="classCheMPS2_1_1TwoDM.html#ad7615a0d2458408de29de4b8b88868f1" title="Get a 2DM_B term, using the DMRG indices. " alt="" coords="1732,1551,1997,1578"/>
<area shape="rect" id="node173" href="classCheMPS2_1_1Correlations.html#a7414689fc9e58291884af75779f18f85" title="Get the single&#45;orbital entropy for a certain site, using the DMRG indices. " alt="" coords="1162,3751,1359,3792"/>
<area shape="rect" id="node180" href="classCheMPS2_1_1ThreeDM.html#ae3a0de0da6659adca36ea0cdae16da0e" title="Get a 3&#45;RDM, using the HAM indices. " alt="" coords="873,5167,1043,5208"/>
<area shape="rect" id="node187" href="classCheMPS2_1_1TwoDM.html#a40c2181006aaf66b8dad2e545e3d8186" title="Get a 2DM_A term, using the HAM indices. " alt="" coords="831,5502,1085,5529"/>
<area shape="rect" id="node190" href="classCheMPS2_1_1TwoDM.html#a4eb81922bf21b38ed8fb8c4696da3a19" title="Get a 1&#45;RDM term, using the HAM indices. " alt="" coords="839,5350,1077,5377"/>
<area shape="rect" id="node192" href="classCheMPS2_1_1DMRG.html#a5e39f9d280ccbdc3944b5d50012306ac" title="Obtain the symmetrized 4&#45;RDM terms 0.5 * ( Gamma4_ijkl,pqrt + Gamma4_ijkt,pqrl ) with l and t fixed..." alt="" coords="556,4345,771,4371"/>
<area shape="rect" id="node193" href="classCheMPS2_1_1TensorT.html#a55f79851b7dc42a4c288ab82d54d8f1a" title="Get the storage jump corresponding to a certain tensor block. " alt="" coords="844,4547,1072,4574"/>
<area shape="rect" id="node195" href="classCheMPS2_1_1TensorT.html#a1963e6fbeb248515d49757dd367fd3bc" title="Apply alpha * ( number operator ) + beta to the MPS tensor. " alt="" coords="863,4716,1053,4757"/>
<area shape="rect" id="node196" href="classCheMPS2_1_1Excitation.html#ae054572d788aff6a75f80ad63879e9af" title="Matrix&#45;vector multiplication S_up = ( alpha * E_{orb1,orb2} + beta * E_{orb2,orb1} + gamma ) x S_down..." alt="" coords="884,4044,1032,4085"/>
<area shape="rect" id="node197" href="classCheMPS2_1_1SyBookkeeper.html#acea8cf07785547a8cb1a6029eb4c47e4" title="Restart by setting the virtual dimensions from boundary start to boundary stop to FCI virtual dimensi..." alt="" coords="871,4781,1045,4823"/>
<area shape="rect" id="node198" href="classCheMPS2_1_1TensorT.html#a315536959cbf0608cd11f386e8637782" title="Set the pointer to the symmetry bookkeeper. " alt="" coords="873,4847,1043,4874"/>
<area shape="rect" id="node199" href="classCheMPS2_1_1TensorT.html#a5143f02e292c2c7e25d472e75b239298" title="Fill storage with random numbers 0 &lt; val &lt; 1. " alt="" coords="863,4898,1053,4925"/>
<area shape="rect" id="node200" href="classCheMPS2_1_1TensorL.html#a51ae1984b9ed9e377f4e7e2694ac6ea5" title="Create a new TensorL. " alt="" coords="867,4665,1049,4691"/>
<area shape="rect" id="node201" href="classCheMPS2_1_1TensorOperator.html#a7e53ebc77a77239387ac6849cc3962ba" title="Clear and update. " alt="" coords="868,4599,1048,4640"/>
<area shape="rect" id="node203" href="classCheMPS2_1_1CASSCF.html#ace43158fe31a38fb9d9131031895578b" title="Write the checkpoint file for the contraction of the generalized Fock operator with the 4&#45;RDM to disk..." alt="" coords="573,5580,754,5621"/>
<area shape="rect" id="node208" href="classCheMPS2_1_1ConjugateGradient.html#afe8c8a3af798ce7a300cbb88dc57e3f4" title="Get the number of matrix vector multiplications which have been performed. " alt="" coords="564,6313,763,6355"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a10b37b294f7573005a6b49b669e734ca"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::construct_fock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>Fock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>Tmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>Qocc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>Qact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct the Fock matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Fock</td><td>Matrix to store the Fock operator in </td></tr>
    <tr><td class="paramname">Tmat</td><td>Matrix with the one-electron integrals </td></tr>
    <tr><td class="paramname">Qocc</td><td>Matrix with the Coulomb and exchange contributions of the occupied (inactive) orbitals </td></tr>
    <tr><td class="paramname">Qact</td><td>Matrix with the Coulomb and exchange contributions of the active space orbitals </td></tr>
    <tr><td class="paramname">idx</td><td>Object which handles the index conventions for <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCFpt2_8cpp_source.html#l00395">395</a> of file <a class="el" href="CASSCFpt2_8cpp_source.html">CASSCFpt2.cpp</a>.</p>

<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a10b37b294f7573005a6b49b669e734ca_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a10b37b294f7573005a6b49b669e734ca_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a10b37b294f7573005a6b49b669e734ca_cgraph" id="classCheMPS2_1_1CASSCF_a10b37b294f7573005a6b49b669e734ca_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="303,5,501,47"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="560,115,759,156"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFmatrix.html#a3660ff17cbeb278c265b6461450b1a24" title="Set an element. " alt="" coords="292,122,512,149"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9" title="Get an element. " alt="" coords="292,173,512,199"/>
</map>
</div>
</p>

<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a10b37b294f7573005a6b49b669e734ca_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a10b37b294f7573005a6b49b669e734ca_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a10b37b294f7573005a6b49b669e734ca_icgraph" id="classCheMPS2_1_1CASSCF_a10b37b294f7573005a6b49b669e734ca_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#aa0ecf5c63622cb1f2aa4e72eebb31fe1" title="CASSCF DIIS vectors remove call. " alt="" coords="292,5,545,32"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1CASSCF.html#a0e8e56a34c6f28fe27341425a1db8384" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="323,56,515,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0dbcb41aa9097e3b45b93c232337ec8a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::copy2DMover </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1TwoDM.html">TwoDM</a> *&#160;</td>
          <td class="paramname"><em>theDMRG2DM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>LAS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>two_dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy over the <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> 2-RDM. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">theDMRG2DM</td><td>The 2-RDM from the <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> object </td></tr>
    <tr><td class="paramname">LAS</td><td>The total number of <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> orbitals </td></tr>
    <tr><td class="paramname">two_dm</td><td>The <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> 2-RDM </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00119">119</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a0dbcb41aa9097e3b45b93c232337ec8a_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a0dbcb41aa9097e3b45b93c232337ec8a_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a0dbcb41aa9097e3b45b93c232337ec8a_cgraph" id="classCheMPS2_1_1CASSCF_a0dbcb41aa9097e3b45b93c232337ec8a_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1TwoDM.html#a40c2181006aaf66b8dad2e545e3d8186" title="Get a 2DM_A term, using the HAM indices. " alt="" coords="288,56,543,83"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1Problem.html#a2b562b3dce075741cf3cf038143a2754" title="Get whether the Hamiltonian orbitals are reordered for the DMRG calculation. " alt="" coords="624,5,823,32"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1TwoDM.html#a2cb905399d199f45e7101e3927933005" title="Get a 2DM_A term, using the DMRG indices. " alt="" coords="591,56,856,83"/>
<area shape="rect" id="node7" href="classCheMPS2_1_1Problem.html#af261a2869feffd866b1f7ee5052c9ae9" title="Get the DMRG index corresponding to a Ham index. " alt="" coords="641,107,805,133"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1Problem.html#ac09cc027ab9b41132096e9bd14b549ff" title="Get an orbital irrep. " alt="" coords="910,31,1089,57"/>
<area shape="rect" id="node6" href="classCheMPS2_1_1Irreps.html#a1d86c7a8b3c3a7b9215c0e298f0ae047" title="Get the direct product of the irreps with numbers Irrep1 and Irrep2: a bitwise XOR for psi4&#39;s convent..." alt="" coords="904,81,1095,108"/>
</map>
</div>
</p>

<p><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a0dbcb41aa9097e3b45b93c232337ec8a_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a0dbcb41aa9097e3b45b93c232337ec8a_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a0dbcb41aa9097e3b45b93c232337ec8a_icgraph" id="classCheMPS2_1_1CASSCF_a0dbcb41aa9097e3b45b93c232337ec8a_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#aa0ecf5c63622cb1f2aa4e72eebb31fe1" title="CASSCF DIIS vectors remove call. " alt="" coords="288,5,541,32"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1CASSCF.html#a8b4ebee13ba2a5764081fae5275f6c7e" title="Do the CASSCF cycles with the augmented Hessian Newton&#45;Raphson method. " alt="" coords="323,56,507,83"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1CASSCF.html#a0e8e56a34c6f28fe27341425a1db8384" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="319,107,511,133"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3f20d25b94c1d821f22f95a6bab0ebc7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::copy_active </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>one_rdm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy a one-orbital quantity from array format to <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">origin</td><td>Array to copy </td></tr>
    <tr><td class="paramname">result</td><td><a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> to store the copy </td></tr>
    <tr><td class="paramname">idx</td><td>Object which handles the index conventions for <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> </td></tr>
    <tr><td class="paramname">one_rdm</td><td>If true, the occupied orbitals get occupation 2 </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00375">375</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a3f20d25b94c1d821f22f95a6bab0ebc7_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a3f20d25b94c1d821f22f95a6bab0ebc7_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a3f20d25b94c1d821f22f95a6bab0ebc7_cgraph" id="classCheMPS2_1_1CASSCF_a3f20d25b94c1d821f22f95a6bab0ebc7_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFmatrix.html#a0729b05fef0cb96eaf26e7c8d6017931" title="Clear the matrix. " alt="" coords="247,5,442,47"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="245,71,444,112"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="245,136,444,177"/>
<area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="245,201,444,243"/>
<area shape="rect" id="node7" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="245,267,444,308"/>
<area shape="rect" id="node8" href="classCheMPS2_1_1DMRGSCFmatrix.html#a3660ff17cbeb278c265b6461450b1a24" title="Set an element. " alt="" coords="235,333,455,359"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="503,165,701,207"/>
</map>
</div>
</p>

<p><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a3f20d25b94c1d821f22f95a6bab0ebc7_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a3f20d25b94c1d821f22f95a6bab0ebc7_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a3f20d25b94c1d821f22f95a6bab0ebc7_icgraph" id="classCheMPS2_1_1CASSCF_a3f20d25b94c1d821f22f95a6bab0ebc7_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#aa0ecf5c63622cb1f2aa4e72eebb31fe1" title="CASSCF DIIS vectors remove call. " alt="" coords="235,5,488,32"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1CASSCF.html#a8b4ebee13ba2a5764081fae5275f6c7e" title="Do the CASSCF cycles with the augmented Hessian Newton&#45;Raphson method. " alt="" coords="269,56,453,83"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1CASSCF.html#a0e8e56a34c6f28fe27341425a1db8384" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="265,107,457,133"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a53a0c4f5043fd2494f8825cb43578fa7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::copy_active </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy a one-orbital quantity from <a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> format to array format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">origin</td><td><a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> to copy </td></tr>
    <tr><td class="paramname">result</td><td>Array to store the copy </td></tr>
    <tr><td class="paramname">idx</td><td>Object which handles the index conventions for <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00407">407</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a53a0c4f5043fd2494f8825cb43578fa7_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a53a0c4f5043fd2494f8825cb43578fa7_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a53a0c4f5043fd2494f8825cb43578fa7_cgraph" id="classCheMPS2_1_1CASSCF_a53a0c4f5043fd2494f8825cb43578fa7_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="245,5,444,47"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="245,71,444,112"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="245,136,444,177"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="245,201,444,243"/>
<area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9" title="Get an element. " alt="" coords="235,267,455,294"/>
<area shape="rect" id="node7" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="503,260,701,301"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad4c00cd4c21dc402ad5e966232b199d3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double CheMPS2::CASSCF::deviation_from_blockdiag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> *&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the RMS deviation from block-diagonal. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>Matrix to be assessed </td></tr>
    <tr><td class="paramname">idx</td><td>Object which handles the index conventions for <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>RMS deviation from block-diagonal </dd></dl>

<p>Definition at line <a class="el" href="CASSCFpt2_8cpp_source.html#l00411">411</a> of file <a class="el" href="CASSCFpt2_8cpp_source.html">CASSCFpt2.cpp</a>.</p>

<p><div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_ad4c00cd4c21dc402ad5e966232b199d3_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_ad4c00cd4c21dc402ad5e966232b199d3_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_ad4c00cd4c21dc402ad5e966232b199d3_cgraph" id="classCheMPS2_1_1CASSCF_ad4c00cd4c21dc402ad5e966232b199d3_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="269,5,468,47"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="269,71,468,112"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9" title="Get an element. " alt="" coords="259,137,479,163"/>
<area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="269,188,468,229"/>
<area shape="rect" id="node7" href="classCheMPS2_1_1DMRGSCFindices.html#afdbe42f60924d9fb705cce44426d72d0" title="Get the number of virtual orbitals for an irrep. " alt="" coords="269,253,468,295"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="527,129,725,171"/>
</map>
</div>
</p>

<p><div id="dynsection-18" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_ad4c00cd4c21dc402ad5e966232b199d3_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_ad4c00cd4c21dc402ad5e966232b199d3_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_ad4c00cd4c21dc402ad5e966232b199d3_icgraph" id="classCheMPS2_1_1CASSCF_ad4c00cd4c21dc402ad5e966232b199d3_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#aa0ecf5c63622cb1f2aa4e72eebb31fe1" title="CASSCF DIIS vectors remove call. " alt="" coords="259,5,512,32"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1CASSCF.html#a0e8e56a34c6f28fe27341425a1db8384" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="289,56,481,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a49e2785c67342a2c907cf16292e9b589"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::fillLocalizedOrbitalRotations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFunitary.html">DMRGSCFunitary</a> *&#160;</td>
          <td class="paramname"><em>umat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> *&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>eigenvecs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>From an Edmiston-Ruedenberg active space rotation, fetch the eigenvectors and store them in eigenvecs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">umat</td><td>The Edmiston-Ruedenberg active space rotation </td></tr>
    <tr><td class="paramname">idx</td><td>Object which handles the index conventions for <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> </td></tr>
    <tr><td class="paramname">eigenvecs</td><td>Where the eigenvectors are stored </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00160">160</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-19" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a49e2785c67342a2c907cf16292e9b589_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a49e2785c67342a2c907cf16292e9b589_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a49e2785c67342a2c907cf16292e9b589_cgraph" id="classCheMPS2_1_1CASSCF_a49e2785c67342a2c907cf16292e9b589_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="285,5,484,47"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="285,71,484,112"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="285,136,484,177"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1DMRGSCFmatrix.html#a230d9fa54109d0754a054868611177c5" title="Get a matrix block. " alt="" coords="287,201,482,243"/>
<area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="543,377,741,419"/>
<area shape="rect" id="node7" href="classCheMPS2_1_1Special.html#aa4f2b217e055a343e0446eaadd395154" title="Triangle function for two variables. " alt="" coords="298,319,471,360"/>
<area shape="rect" id="node8" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9" title="Get an element. " alt="" coords="275,385,495,411"/>
<area shape="rect" id="node9" href="classCheMPS2_1_1FourIndex.html#ae93c264cbb81e7d39db778a129dc7ca1" title="Get an element. " alt="" coords="297,435,472,462"/>
<area shape="rect" id="node10" href="classCheMPS2_1_1DMRGSCFmatrix.html#a3660ff17cbeb278c265b6461450b1a24" title="Set an element. " alt="" coords="275,486,495,513"/>
<area shape="rect" id="node11" href="classCheMPS2_1_1MPIchemps2.html#a6732ae60b5b4c8a4f1b063f9db304bf5" title="Get the rank of this MPI process. " alt="" coords="301,537,468,579"/>
<area shape="rect" id="node15" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="285,603,484,644"/>
<area shape="rect" id="node16" href="classCheMPS2_1_1TwoIndex.html#a49c7065a18ca6b82e7a63a56cdf2687c" title="Get an element. " alt="" coords="298,669,471,695"/>
<area shape="rect" id="node17" href="classCheMPS2_1_1Hamiltonian.html#af6664242601063dd762c6a430054e4c5" title="Set the constant energy. " alt="" coords="305,720,464,761"/>
<area shape="rect" id="node18" href="classCheMPS2_1_1Hamiltonian.html#a7a56bcf4365125ec144c21d5a4684c32" title="Set a Tmat element. " alt="" coords="305,785,464,827"/>
<area shape="rect" id="node12" href="classCheMPS2_1_1MPIchemps2.html#a2a6ae387436d5e5b0a320a12b87244e1" title="Get the number of MPI processes. " alt="" coords="559,479,725,520"/>
<area shape="rect" id="node13" href="classCheMPS2_1_1Tensor.html#ad68f65759e764c6cb55e2b8db18f8874" title="Get the number of tensor blocks. " alt="" coords="546,545,738,571"/>
<area shape="rect" id="node14" href="classCheMPS2_1_1Tensor.html#a2f17a5413447e77ad3f128d49b3ca676" title="Get the pointer to the storage. " alt="" coords="547,595,737,622"/>
<area shape="rect" id="node19" href="classCheMPS2_1_1TwoIndex.html#a4385881853e910bb1ce7d5ea911b75c4" title="Set an element. " alt="" coords="555,793,729,819"/>
</map>
</div>
</p>

<p><div id="dynsection-20" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a49e2785c67342a2c907cf16292e9b589_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a49e2785c67342a2c907cf16292e9b589_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a49e2785c67342a2c907cf16292e9b589_icgraph" id="classCheMPS2_1_1CASSCF_a49e2785c67342a2c907cf16292e9b589_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#aa0ecf5c63622cb1f2aa4e72eebb31fe1" title="CASSCF DIIS vectors remove call. " alt="" coords="275,5,528,32"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1CASSCF.html#a8b4ebee13ba2a5764081fae5275f6c7e" title="Do the CASSCF cycles with the augmented Hessian Newton&#45;Raphson method. " alt="" coords="309,56,493,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3f1e0dc3e01be6e48eed126ca0ff1fd9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::fock_dot_4rdm </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fockmx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRG.html">CheMPS2::DMRG</a> *&#160;</td>
          <td class="paramname"><em>dmrgsolver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1Hamiltonian.html">CheMPS2::Hamiltonian</a> *&#160;</td>
          <td class="paramname"><em>ham</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>next_orb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>next_orb2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>work</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>CHECKPOINT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>PSEUDOCANONICAL</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build the contraction of the fock matrix with the 4-RDM. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fockmx</td><td>Array of size ham-&gt;getL() x ham-&gt;getL() containing the Fock matrix elements </td></tr>
    <tr><td class="paramname">dmrgsolver</td><td><a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> object which is solved, and for which the 2-RDM and 3-RDM have been calculated as well </td></tr>
    <tr><td class="paramname">ham</td><td>Active space <a class="el" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a>, which is needed for the size of the active space and the orbital irreps </td></tr>
    <tr><td class="paramname">next_orb1</td><td>The next first orbital for which the contraction should be continued </td></tr>
    <tr><td class="paramname">next_orb2</td><td>The next second orbital for which the contraction should be continued </td></tr>
    <tr><td class="paramname">work</td><td>Work array of size ham-&gt;getL()**6 </td></tr>
    <tr><td class="paramname">result</td><td>On entry, contains the partial contraction corresponding to (next_orb1, next_orb2). On exit, contains the full contraction. </td></tr>
    <tr><td class="paramname">CHECKPOINT</td><td>Whether or not the standard CheMPS2 F.4-RDM checkpoint should be created/updated to continue the contraction at later times </td></tr>
    <tr><td class="paramname">PSEUDOCANONICAL</td><td>Whether or not pseudocanonical orbitals are used in the active space </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCFpt2_8cpp_source.html#l00140">140</a> of file <a class="el" href="CASSCFpt2_8cpp_source.html">CASSCFpt2.cpp</a>.</p>

<p><div id="dynsection-21" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a3f1e0dc3e01be6e48eed126ca0ff1fd9_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a3f1e0dc3e01be6e48eed126ca0ff1fd9_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a3f1e0dc3e01be6e48eed126ca0ff1fd9_cgraph" id="classCheMPS2_1_1CASSCF_a3f1e0dc3e01be6e48eed126ca0ff1fd9_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1Hamiltonian.html#a101963cfa8f06abe798a7ae79faab618" title="Get the number of orbitals. " alt="" coords="260,5,419,47"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1DMRG.html#a5e39f9d280ccbdc3944b5d50012306ac" title="Obtain the symmetrized 4&#45;RDM terms 0.5 * ( Gamma4_ijkl,pqrt + Gamma4_ijkt,pqrl ) with l and t fixed..." alt="" coords="232,2853,447,2879"/>
<area shape="rect" id="node24" href="classCheMPS2_1_1Hamiltonian.html#a02130b2901a5a3c05171d4f7dd5fa4cd" title="Get an orbital irrep number. " alt="" coords="1577,1349,1736,1391"/>
<area shape="rect" id="node83" href="classCheMPS2_1_1CASSCF.html#ace43158fe31a38fb9d9131031895578b" title="Write the checkpoint file for the contraction of the generalized Fock operator with the 4&#45;RDM to disk..." alt="" coords="249,123,430,164"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1ThreeDM.html#ae3a0de0da6659adca36ea0cdae16da0e" title="Get a 3&#45;RDM, using the HAM indices. " alt="" coords="533,1079,704,1120"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1DMRG.html#aa6e349febeaf92b9dfa4c7f92d8507d4" title="Reconstruct the renormalized operators when you overwrite the matrix elements with Prob&#45;&gt;setMxElement..." alt="" coords="523,1145,715,1171"/>
<area shape="rect" id="node6" href="classCheMPS2_1_1MPIchemps2.html#a6732ae60b5b4c8a4f1b063f9db304bf5" title="Get the rank of this MPI process. " alt="" coords="840,123,1007,164"/>
<area shape="rect" id="node10" href="classCheMPS2_1_1Problem.html#a2b562b3dce075741cf3cf038143a2754" title="Get whether the Hamiltonian orbitals are reordered for the DMRG calculation. " alt="" coords="519,2954,718,2981"/>
<area shape="rect" id="node11" href="classCheMPS2_1_1Problem.html#af261a2869feffd866b1f7ee5052c9ae9" title="Get the DMRG index corresponding to a Ham index. " alt="" coords="537,3005,701,3031"/>
<area shape="rect" id="node12" href="classCheMPS2_1_1TensorT.html#a55f79851b7dc42a4c288ab82d54d8f1a" title="Get the storage jump corresponding to a certain tensor block. " alt="" coords="505,3055,733,3082"/>
<area shape="rect" id="node13" href="classCheMPS2_1_1ThreeDM.html#a41f377c3636898276dcb6c2f30dbf3ad" title="Fill the 3&#45;RDM terms corresponding to site denT&#45;&gt;gIndex() " alt="" coords="522,1246,715,1273"/>
<area shape="rect" id="node15" href="classCheMPS2_1_1SyBookkeeper.html#a470a4876ee25036e3f7db2663986d608" title="Get the maximum virtual dimension at a certain boundary. " alt="" coords="836,793,1011,835"/>
<area shape="rect" id="node22" href="classCheMPS2_1_1SyBookkeeper.html#ac0d4a5f26831eaf12b023c623494c144" title="Get an orbital irrep. " alt="" coords="1116,2633,1291,2675"/>
<area shape="rect" id="node40" href="classCheMPS2_1_1ThreeDM.html#acceb29cbf3244a2fee196f36c87589a7" title="Add the 3&#45;RDM elements of all MPI processes. " alt="" coords="532,3107,705,3148"/>
<area shape="rect" id="node41" href="classCheMPS2_1_1ThreeDM.html#a0a3de81e9881218690e26094be30b749" title="After the whole 3&#45;RDM is filled, a prefactor for higher multiplicities should be applied. " alt="" coords="523,3224,715,3265"/>
<area shape="rect" id="node42" href="classCheMPS2_1_1Problem.html#ad472d8f16b1014db3ae67478684b0c49" title="Get twice the targeted spin. " alt="" coords="830,3757,1017,3783"/>
<area shape="rect" id="node43" href="classCheMPS2_1_1ThreeDM.html#af918bc3d3c4655263b8205a2f99632c8" title="Perform storage[ :, :, :, :, :, : ] { = or += } alpha * 3&#45;RDM[ :, :, :, :, :, last_orb_start: last_or..." alt="" coords="536,3289,701,3331"/>
<area shape="rect" id="node44" href="classCheMPS2_1_1TensorT.html#a1963e6fbeb248515d49757dd367fd3bc" title="Apply alpha * ( number operator ) + beta to the MPS tensor. " alt="" coords="524,3355,713,3396"/>
<area shape="rect" id="node45" href="classCheMPS2_1_1Sobject.html#a687a29eab89ef3763af8c630b48e3bf6" title="Join two sites to form a composite S&#45;object. " alt="" coords="840,2038,1007,2065"/>
<area shape="rect" id="node46" href="classCheMPS2_1_1Excitation.html#ae054572d788aff6a75f80ad63879e9af" title="Matrix&#45;vector multiplication S_up = ( alpha * E_{orb1,orb2} + beta * E_{orb2,orb1} + gamma ) x S_down..." alt="" coords="545,2787,693,2828"/>
<area shape="rect" id="node64" href="classCheMPS2_1_1Sobject.html#a34983e86ae9f19de0be6b923479c13df" title="SVD an S&#45;object into 2 TensorT&#39;s. " alt="" coords="535,1654,703,1681"/>
<area shape="rect" id="node68" href="classCheMPS2_1_1ConvergenceScheme.html#a982fa5f929b66ed42211f64eb6d5a192" title="Get the number of renormalized states for a particular instruction. " alt="" coords="511,3420,726,3461"/>
<area shape="rect" id="node69" href="classCheMPS2_1_1ConvergenceScheme.html#a1d5339434adafc615592bf92ab9feb16" title="Get the number of instructions. " alt="" coords="511,3485,726,3527"/>
<area shape="rect" id="node70" href="classCheMPS2_1_1SyBookkeeper.html#acea8cf07785547a8cb1a6029eb4c47e4" title="Restart by setting the virtual dimensions from boundary start to boundary stop to FCI virtual dimensi..." alt="" coords="531,3551,706,3592"/>
<area shape="rect" id="node71" href="classCheMPS2_1_1TensorT.html#a315536959cbf0608cd11f386e8637782" title="Set the pointer to the symmetry bookkeeper. " alt="" coords="533,3617,704,3643"/>
<area shape="rect" id="node72" href="classCheMPS2_1_1TensorT.html#a5143f02e292c2c7e25d472e75b239298" title="Fill storage with random numbers 0 &lt; val &lt; 1. " alt="" coords="524,3667,713,3694"/>
<area shape="rect" id="node73" href="classCheMPS2_1_1ConvergenceScheme.html#ac12ca4a6c69913388eca92bdc361f118" title="Get the energy convergence threshold for a particular instruction. " alt="" coords="511,1013,726,1055"/>
<area shape="rect" id="node74" href="classCheMPS2_1_1ConvergenceScheme.html#aaa418f2b95ef871dca6a6aa4d6b0b8cb" title="Get the noise prefactor for a particular instruction. " alt="" coords="511,2525,726,2567"/>
<area shape="rect" id="node75" href="classCheMPS2_1_1Sobject.html#abe676ef06644b5b675c65b123d118f2c" title="Add noise to the current S&#45;object. " alt="" coords="520,2642,717,2669"/>
<area shape="rect" id="node76" href="classCheMPS2_1_1TwoDM.html#abad942f9d45c5ec3f9b3d8d7fd5b2922" title="Get a 1&#45;RDM term, using the DMRG indices. " alt="" coords="495,2903,743,2930"/>
<area shape="rect" id="node79" href="classCheMPS2_1_1TensorL.html#a51ae1984b9ed9e377f4e7e2694ac6ea5" title="Create a new TensorL. " alt="" coords="528,2591,709,2618"/>
<area shape="rect" id="node80" href="classCheMPS2_1_1TensorOperator.html#a7e53ebc77a77239387ac6849cc3962ba" title="Clear and update. " alt="" coords="529,2368,709,2409"/>
<area shape="rect" id="node7" href="classCheMPS2_1_1MPIchemps2.html#a2a6ae387436d5e5b0a320a12b87244e1" title="Get the number of MPI processes. " alt="" coords="1120,224,1287,265"/>
<area shape="rect" id="node8" href="classCheMPS2_1_1Tensor.html#ad68f65759e764c6cb55e2b8db18f8874" title="Get the number of tensor blocks. " alt="" coords="1107,122,1299,149"/>
<area shape="rect" id="node9" href="classCheMPS2_1_1Tensor.html#a2f17a5413447e77ad3f128d49b3ca676" title="Get the pointer to the storage. " alt="" coords="1108,173,1299,199"/>
<area shape="rect" id="node14" href="classCheMPS2_1_1TensorT.html#a279b51f0616ab58f2a2893681b4cab71" title="Get the location index. " alt="" coords="831,357,1016,383"/>
<area shape="rect" id="node16" href="classCheMPS2_1_1SyBookkeeper.html#a5e5fbbeb3f0a499ec4b905200f4a14b2" title="Get the min. possible particle number for a certain boundary. " alt="" coords="1116,777,1291,819"/>
<area shape="rect" id="node17" href="classCheMPS2_1_1SyBookkeeper.html#a3e5f4d30bef465424acb784caaf62628" title="Get the max. possible particle number for a certain boundary. " alt="" coords="1116,703,1291,744"/>
<area shape="rect" id="node18" href="classCheMPS2_1_1SyBookkeeper.html#ad57f3ba5107c78bdd56131c40ae4f3e9" title="Get the minimum possible spin value for a certain boundary and particle number. " alt="" coords="1116,848,1291,889"/>
<area shape="rect" id="node19" href="classCheMPS2_1_1SyBookkeeper.html#ad89a9ec018a14187e5a3e5b87ad9fb2c" title="Get the maximum possible spin value for a certain boundary and particle number. " alt="" coords="1116,937,1291,979"/>
<area shape="rect" id="node20" href="classCheMPS2_1_1SyBookkeeper.html#ade15ac00f19abf28ea238a7d2530e049" title="Get the current virtual dimensions. " alt="" coords="1116,1676,1291,1717"/>
<area shape="rect" id="node21" href="classCheMPS2_1_1Special.html#aa4f2b217e055a343e0446eaadd395154" title="Triangle function for two variables. " alt="" coords="837,291,1010,332"/>
<area shape="rect" id="node25" href="classCheMPS2_1_1Special.html#abe7c3ec1d1a684a0c86693b11589eaf5" title="Triangle function for three variables. " alt="" coords="837,560,1010,601"/>
<area shape="rect" id="node26" href="classCheMPS2_1_1Irreps.html#a1d86c7a8b3c3a7b9215c0e298f0ae047" title="Get the direct product of the irreps with numbers Irrep1 and Irrep2: a bitwise XOR for psi4&#39;s convent..." alt="" coords="1108,2187,1299,2214"/>
<area shape="rect" id="node27" href="classCheMPS2_1_1TensorOperator.html#a0c347c3df77117eb3e6340ce032fb3b7" title="Make the in&#45;product of two TensorOperator. " alt="" coords="833,1348,1013,1389"/>
<area shape="rect" id="node28" href="classCheMPS2_1_1TensorOperator.html#a7438680d389551c7c3d38075f83240ce" title="Get how many electrons there are more in the symmetry sector of the lower leg compared to the upper l..." alt="" coords="1113,1129,1293,1171"/>
<area shape="rect" id="node29" href="classCheMPS2_1_1TensorOperator.html#a1b08aef00ecb10b1e88220dda5c7e285" title="Get the (real&#45;valued abelian) point group irrep difference between the symmetry sectors of the lower ..." alt="" coords="1113,1243,1293,1284"/>
<area shape="rect" id="node30" href="classCheMPS2_1_1TensorOperator.html#a0013992f81ec5681774124e104a22a9d" title="Get the pointer to the storage. " alt="" coords="1113,1831,1293,1872"/>
<area shape="rect" id="node31" href="classCheMPS2_1_1Special.html#afffda0b19a0e9dc4bddca5fb3ebfd350" title="Phase function. " alt="" coords="1115,1942,1291,1969"/>
<area shape="rect" id="node32" href="classCheMPS2_1_1Tensor3RDM.html#abce2935d5e3293bbfbd39c7b78b4705e" title="Make the in&#45;product of two Tensor3RDMs. " alt="" coords="839,1129,1007,1171"/>
<area shape="rect" id="node33" href="classCheMPS2_1_1Tensor3RDM.html#a119e63036c8e52a6f77123798586af1e" title="Get the spin value of the Tensor3RDM. " alt="" coords="1119,463,1287,504"/>
<area shape="rect" id="node34" href="classCheMPS2_1_1SyBookkeeper.html#aac9b4729c5fe841b619b9527dbf69e12" title="Get the total number of irreps. " alt="" coords="836,1617,1011,1659"/>
<area shape="rect" id="node35" href="classCheMPS2_1_1TensorT.html#aafb4d43ad6178437b47a32a24c375fa3" title="Get the pointer to the storage. " alt="" coords="1104,2137,1303,2163"/>
<area shape="rect" id="node36" href="classCheMPS2_1_1Tensor3RDM.html#a4829f26ff83a00999ca6c4159520702a" title="Get the intermediary spin coupling value of the Tensor3RDM. " alt="" coords="839,625,1007,667"/>
<area shape="rect" id="node37" href="classCheMPS2_1_1Wigner.html#a552611fbd1be53036fc06e52fc8632fa" title="Wigner&#45;6j symbol (gsl api) " alt="" coords="1110,2038,1297,2065"/>
<area shape="rect" id="node38" href="classCheMPS2_1_1TensorOperator.html#a2088bb2ec0105ad443d02413ee2dd998" title="Set all storage variables to 0.0. " alt="" coords="833,2475,1013,2516"/>
<area shape="rect" id="node39" href="classCheMPS2_1_1Wigner.html#aa97a080dbd6e3377e3320abdc8c61289" title="Wigner&#45;9j symbol (gsl api) " alt="" coords="830,1566,1017,1593"/>
<area shape="rect" id="node23" href="classCheMPS2_1_1Problem.html#ac09cc027ab9b41132096e9bd14b549ff" title="Get an orbital irrep. " alt="" coords="1351,2989,1529,3015"/>
<area shape="rect" id="node47" href="classCheMPS2_1_1Sobject.html#a973aa40f2b0e659a55b4c63e768afdf2" title="Get the location index. " alt="" coords="833,2845,1014,2871"/>
<area shape="rect" id="node48" href="classCheMPS2_1_1Sobject.html#a01b16408c5439e0eca69b2fde6d0185c" title="Convert the storage from diagram convention to symmetric Hamiltonian convention. " alt="" coords="818,2895,1029,2922"/>
<area shape="rect" id="node49" href="classCheMPS2_1_1Sobject.html#a1dfbe469443fbf7daa49c1d0cb34425e" title="Get the number of symmetry blocks. " alt="" coords="825,2642,1021,2669"/>
<area shape="rect" id="node50" href="classCheMPS2_1_1Sobject.html#afa741115faee102be2bacc03b382428c" title="Get the blocks from large to small: blocksize(reorder[i])&gt;=blocksize(reorder[i+1]) ..." alt="" coords="826,2946,1021,2973"/>
<area shape="rect" id="node51" href="classCheMPS2_1_1Sobject.html#a2b482f6b45ddd735e42b906843c10e24" title="Convert the storage from symmetric Hamiltonian convention to diagram convention. " alt="" coords="818,2997,1029,3023"/>
<area shape="rect" id="node52" href="classCheMPS2_1_1Sobject.html#aff81bb404f07da2814b396306fb38588" title="Get the storage jump corresponding to a certain symmetry block. " alt="" coords="811,2591,1035,2618"/>
<area shape="rect" id="node53" href="classCheMPS2_1_1Sobject.html#a55a31306f564c1d220d36ac9a07623c9" title="Get the pointer to the storage. " alt="" coords="826,2541,1021,2567"/>
<area shape="rect" id="node54" href="classCheMPS2_1_1Sobject.html#ae33e692d6e5f89d446f62515a85f725f" title="Get the left spin symmetry of block ikappa. " alt="" coords="828,3047,1019,3074"/>
<area shape="rect" id="node55" href="classCheMPS2_1_1Sobject.html#ac3d208dc1bc37fdbcf48aaa9e4cc6ed7" title="Get the right spin symmetry of block ikappa. " alt="" coords="827,3098,1020,3125"/>
<area shape="rect" id="node56" href="classCheMPS2_1_1Sobject.html#a2bf86bc7861704b1f2ddb655312da82b" title="Get the central spin symmetry of block ikappa. " alt="" coords="833,3199,1014,3226"/>
<area shape="rect" id="node57" href="classCheMPS2_1_1Sobject.html#a2b8ca2eaecfc448c0f0591462c8edede" title="Get the left particle number symmetry of block ikappa. " alt="" coords="840,3250,1007,3277"/>
<area shape="rect" id="node58" href="classCheMPS2_1_1Sobject.html#a6dc776c7b9c79a2fb5a5e6e81d190562" title="Get the right particle number symmetry of block ikappa. " alt="" coords="839,3301,1008,3327"/>
<area shape="rect" id="node59" href="classCheMPS2_1_1Sobject.html#a77be4052f1655e2f8fecee8f231bc209" title="Get the left irrep symmetry of block ikappa. " alt="" coords="843,3351,1003,3378"/>
<area shape="rect" id="node60" href="classCheMPS2_1_1Sobject.html#a1a9a06b257e018439ded8c1bf9c88813" title="Get the right irrep symmetry of block ikappa. " alt="" coords="842,3402,1005,3429"/>
<area shape="rect" id="node61" href="classCheMPS2_1_1Sobject.html#ae27c30606eb0f3f1eb9a32c559b7b209" title="Get the left local particle number symmetry of block ikappa. " alt="" coords="840,3453,1007,3479"/>
<area shape="rect" id="node62" href="classCheMPS2_1_1Sobject.html#a62923e0b950298fe42017dcdeadcfb03" title="Get the right local particle number symmetry of block ikappa. " alt="" coords="840,3503,1007,3530"/>
<area shape="rect" id="node63" href="classCheMPS2_1_1Sobject.html#a5626b98bd01a9fb04f4d8e9e739e3034" title="Get the index corresponding to a certain symmetry block. " alt="" coords="830,2794,1017,2821"/>
<area shape="rect" id="node65" href="classCheMPS2_1_1SyBookkeeper.html#a87e4bca7afcfb744aa224ab2a942c8b4" title="Get the FCI virtual dimensions ( bound by SYBK_dimensionCutoff ) " alt="" coords="1116,1021,1291,1063"/>
<area shape="rect" id="node66" href="classCheMPS2_1_1SyBookkeeper.html#aeb6f41f7c78c9e15e02e6b238419b5e7" title="Get the current virtual dimensions. " alt="" coords="836,961,1011,1003"/>
<area shape="rect" id="node67" href="classCheMPS2_1_1TensorT.html#a1f0830b0e729573fe19a3327462f7e7e" title="Reset the TensorT (if virtual dimensions are changed) " alt="" coords="833,1785,1014,1811"/>
<area shape="rect" id="node77" href="classCheMPS2_1_1TwoDM.html#a2cb905399d199f45e7101e3927933005" title="Get a 2DM_A term, using the DMRG indices. " alt="" coords="791,3655,1056,3682"/>
<area shape="rect" id="node78" href="classCheMPS2_1_1Problem.html#a634bbc2ad8be9f45ecd894f0f222885f" title="Get the targeted particle number. " alt="" coords="842,3605,1005,3631"/>
<area shape="rect" id="node81" href="classCheMPS2_1_1TensorOperator.html#ac3130ea131c40f4ceedfe7b119dfe424" title="Update moving right. " alt="" coords="833,2089,1013,2131"/>
<area shape="rect" id="node82" href="classCheMPS2_1_1TensorOperator.html#ac2d470cd957aa26a9700ff923e30e1af" title="Update moving left. " alt="" coords="833,2155,1013,2196"/>
</map>
</div>
</p>

<p><div id="dynsection-22" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a3f1e0dc3e01be6e48eed126ca0ff1fd9_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a3f1e0dc3e01be6e48eed126ca0ff1fd9_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a3f1e0dc3e01be6e48eed126ca0ff1fd9_icgraph" id="classCheMPS2_1_1CASSCF_a3f1e0dc3e01be6e48eed126ca0ff1fd9_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#aa0ecf5c63622cb1f2aa4e72eebb31fe1" title="CASSCF DIIS vectors remove call. " alt="" coords="232,5,485,32"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1CASSCF.html#a0e8e56a34c6f28fe27341425a1db8384" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="263,56,455,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4ecba3101fed76c3ce03c23c6446a3f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CheMPS2::CASSCF::get_num_irreps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the number of irreps. </p>
<dl class="section return"><dt>Returns</dt><dd>The number of irreps </dd></dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00117">117</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad493cbf60a7b807ad0d3a06de74001b9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CheMPS2::CASSCF::read_f4rdm_checkpoint </td>
          <td>(</td>
          <td class="paramtype">const string&#160;</td>
          <td class="paramname"><em>f4rdm_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>hamorb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>hamorb2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>tot_dmrg_power6</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>contract</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read the checkpoint file for the contraction of the generalized Fock operator with the 4-RDM from disk. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f4rdm_file</td><td>The filename </td></tr>
    <tr><td class="paramname">hamorb1</td><td>The next hamiltonian orbital 1 </td></tr>
    <tr><td class="paramname">hamorb2</td><td>The next hamiltonian orbital 2 </td></tr>
    <tr><td class="paramname">tot_dmrg_power6</td><td>The size of the array contract </td></tr>
    <tr><td class="paramname">contract</td><td>The current partial contraction </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether the file was found and read </dd></dl>

<p>Definition at line <a class="el" href="CASSCFpt2_8cpp_source.html#l00087">87</a> of file <a class="el" href="CASSCFpt2_8cpp_source.html">CASSCFpt2.cpp</a>.</p>

<p><div id="dynsection-23" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_ad493cbf60a7b807ad0d3a06de74001b9_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_ad493cbf60a7b807ad0d3a06de74001b9_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_ad493cbf60a7b807ad0d3a06de74001b9_cgraph" id="classCheMPS2_1_1CASSCF_ad493cbf60a7b807ad0d3a06de74001b9_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1MPIchemps2.html#a6732ae60b5b4c8a4f1b063f9db304bf5" title="Get the rank of this MPI process. " alt="" coords="232,64,399,105"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1MPIchemps2.html#a2a6ae387436d5e5b0a320a12b87244e1" title="Get the number of MPI processes. " alt="" coords="459,5,626,47"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1Tensor.html#ad68f65759e764c6cb55e2b8db18f8874" title="Get the number of tensor blocks. " alt="" coords="447,71,639,98"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1Tensor.html#a2f17a5413447e77ad3f128d49b3ca676" title="Get the pointer to the storage. " alt="" coords="447,122,638,149"/>
</map>
</div>
</p>

<p><div id="dynsection-24" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-24-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-24-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-24-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_ad493cbf60a7b807ad0d3a06de74001b9_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_ad493cbf60a7b807ad0d3a06de74001b9_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_ad493cbf60a7b807ad0d3a06de74001b9_icgraph" id="classCheMPS2_1_1CASSCF_ad493cbf60a7b807ad0d3a06de74001b9_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#aa0ecf5c63622cb1f2aa4e72eebb31fe1" title="CASSCF DIIS vectors remove call. " alt="" coords="232,5,485,32"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1CASSCF.html#a0e8e56a34c6f28fe27341425a1db8384" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="263,56,455,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac35e694fd9e00f47d361bdbd47b787e1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::setDMRG1DM </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>num_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>LAS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>one_dm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>two_dm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct the 1-RDM from the 2-RDM. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num_elec</td><td>The number of <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> active space electrons </td></tr>
    <tr><td class="paramname">LAS</td><td>The total number of <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> orbitals </td></tr>
    <tr><td class="paramname">one_dm</td><td>The <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> 1-RDM </td></tr>
    <tr><td class="paramname">two_dm</td><td>The <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> 2-RDM </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCF_8cpp_source.html#l00134">134</a> of file <a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a>.</p>

<p><div id="dynsection-25" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-25-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-25-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-25-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_ac35e694fd9e00f47d361bdbd47b787e1_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_ac35e694fd9e00f47d361bdbd47b787e1_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_ac35e694fd9e00f47d361bdbd47b787e1_cgraph" id="classCheMPS2_1_1CASSCF_ac35e694fd9e00f47d361bdbd47b787e1_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1MPIchemps2.html#a6732ae60b5b4c8a4f1b063f9db304bf5" title="Get the rank of this MPI process. " alt="" coords="293,64,460,105"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1MPIchemps2.html#a2a6ae387436d5e5b0a320a12b87244e1" title="Get the number of MPI processes. " alt="" coords="521,5,687,47"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1Tensor.html#ad68f65759e764c6cb55e2b8db18f8874" title="Get the number of tensor blocks. " alt="" coords="508,71,700,98"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1Tensor.html#a2f17a5413447e77ad3f128d49b3ca676" title="Get the pointer to the storage. " alt="" coords="509,122,699,149"/>
</map>
</div>
</p>

<p><div id="dynsection-26" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-26-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-26-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-26-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_ac35e694fd9e00f47d361bdbd47b787e1_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_ac35e694fd9e00f47d361bdbd47b787e1_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_ac35e694fd9e00f47d361bdbd47b787e1_icgraph" id="classCheMPS2_1_1CASSCF_ac35e694fd9e00f47d361bdbd47b787e1_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#aa0ecf5c63622cb1f2aa4e72eebb31fe1" title="CASSCF DIIS vectors remove call. " alt="" coords="293,5,547,32"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1CASSCF.html#a8b4ebee13ba2a5764081fae5275f6c7e" title="Do the CASSCF cycles with the augmented Hessian Newton&#45;Raphson method. " alt="" coords="328,56,512,83"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1CASSCF.html#a0e8e56a34c6f28fe27341425a1db8384" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="324,107,516,133"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8b4ebee13ba2a5764081fae5275f6c7e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CheMPS2::CASSCF::solve </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nelectrons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>TwoS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Irrep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1ConvergenceScheme.html">ConvergenceScheme</a> *&#160;</td>
          <td class="paramname"><em>OptScheme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rootNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1DMRGSCFoptions.html">DMRGSCFoptions</a> *&#160;</td>
          <td class="paramname"><em>scf_options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Do the <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a> cycles with the augmented Hessian Newton-Raphson method. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Nelectrons</td><td>Total number of electrons in the system: occupied HF orbitals + active space </td></tr>
    <tr><td class="paramname">TwoS</td><td>Twice the targeted spin </td></tr>
    <tr><td class="paramname">Irrep</td><td>Desired wave-function irrep </td></tr>
    <tr><td class="paramname">OptScheme</td><td>The optimization scheme to run the inner <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> loop. If NULL: use <a class="el" href="classCheMPS2_1_1FCI.html">FCI</a> instead of <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a>. </td></tr>
    <tr><td class="paramname">rootNum</td><td>Denotes the targeted state in state-specific <a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a>; 1 means ground state, 2 first excited state etc. </td></tr>
    <tr><td class="paramname">scf_options</td><td>Contains the DMRGSCF options </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The converged DMRGSCF energy </dd></dl>

<p>Definition at line <a class="el" href="CASSCFnewtonraphson_8cpp_source.html#l00056">56</a> of file <a class="el" href="CASSCFnewtonraphson_8cpp_source.html">CASSCFnewtonraphson.cpp</a>.</p>

<p><div id="dynsection-27" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-27-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-27-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-27-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_a8b4ebee13ba2a5764081fae5275f6c7e_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_a8b4ebee13ba2a5764081fae5275f6c7e_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_a8b4ebee13ba2a5764081fae5275f6c7e_cgraph" id="classCheMPS2_1_1CASSCF_a8b4ebee13ba2a5764081fae5275f6c7e_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1MPIchemps2.html#a6732ae60b5b4c8a4f1b063f9db304bf5" title="Get the rank of this MPI process. " alt="" coords="1745,947,1912,989"/>
<area shape="rect" id="node6" href="classCheMPS2_1_1DMRGSCFindices.html#a2cb6c31a775d6f155942dc127eee2218" title="Get the total number of occupied orbitals. " alt="" coords="831,4742,1029,4783"/>
<area shape="rect" id="node9" href="classCheMPS2_1_1DMRGSCFunitary.html#a725cdfa70964b24914436fc40bba90b4" title="Get the number of variables in the x&#45;parametrization of the unitary update. " alt="" coords="831,5246,1029,5287"/>
<area shape="rect" id="node13" href="classCheMPS2_1_1Irreps.html#a9813550797b0557cf22d2bca5f3e07b0" title="Get the group number. " alt="" coords="545,8421,729,8462"/>
<area shape="rect" id="node14" href="classCheMPS2_1_1DMRGSCFindices.html#ae04eb205d9aa13edaae834e535c3396d" title="Get an array with the irreps of each DMRG orbital. " alt="" coords="251,5935,450,5977"/>
<area shape="rect" id="node15" href="classCheMPS2_1_1DMRGSCFindices.html#ade657fa7e0ebf49098f5d22172a0dc01" title="Get the maximum NORB. " alt="" coords="831,4546,1029,4587"/>
<area shape="rect" id="node16" href="classCheMPS2_1_1DMRGSCFoptions.html#a9f81d7a089fc4a239638d95d93c24099" title="Get which active space should be considered in the DMRG routine. " alt="" coords="251,6001,451,6042"/>
<area shape="rect" id="node17" href="classCheMPS2_1_1Hamiltonian.html#af2d3836be75d50640cbed9a9234af126" title="Get a Vmat element. " alt="" coords="1749,1277,1908,1318"/>
<area shape="rect" id="node23" href="classCheMPS2_1_1DMRGSCFindices.html#a3689ebc91a3c11f3703ba21f53e7604d" title="Get the group number. " alt="" coords="251,5870,450,5911"/>
<area shape="rect" id="node24" href="classCheMPS2_1_1DMRGSCFoptions.html#acea3d3f5a5abf8a4bdd509fc13a1a275" title="Get whether the Orbital Rotation checkpoint should be stored to disk. " alt="" coords="251,6066,451,6107"/>
<area shape="rect" id="node25" href="classCheMPS2_1_1DMRGSCFoptions.html#a45fb0323c73651fb83f6856af5145e83" title="Get the Orbital Rotation checkpoint filename. " alt="" coords="251,6131,451,6173"/>
<area shape="rect" id="node26" href="classCheMPS2_1_1DMRGSCFunitary.html#a93dc806a8a1c931334570903c326220e" title="Load the unitary from disk. " alt="" coords="252,3415,449,3457"/>
<area shape="rect" id="node28" href="classCheMPS2_1_1DMRGSCFoptions.html#a208fba2b1dbb95bec171867d39917fc8" title="Get whether DIIS should be performed. " alt="" coords="251,6197,451,6238"/>
<area shape="rect" id="node29" href="classCheMPS2_1_1DMRGSCFoptions.html#a59cdddf8451651c980aa49957c2897b5" title="Get whether the DIIS checkpoint should be stored to disk. " alt="" coords="251,6262,451,6303"/>
<area shape="rect" id="node30" href="classCheMPS2_1_1DMRGSCFoptions.html#ae4f2901cf992d1a4100367f002af786c" title="Get the DIIS checkpoint filename. " alt="" coords="251,6327,451,6369"/>
<area shape="rect" id="node31" href="classCheMPS2_1_1DMRGSCFindices.html#a8cbb84d6c55248612af1a9527c4934de" title="Get the orbital rotation parameter space size. " alt="" coords="831,4677,1029,4718"/>
<area shape="rect" id="node32" href="classCheMPS2_1_1DMRGSCFoptions.html#a57ed7e22a351ad6fc1621ff95106040a" title="Get the number of DIIS update vectors which should be kept. " alt="" coords="251,6393,451,6434"/>
<area shape="rect" id="node33" href="classCheMPS2_1_1DIIS.html#af4cee5f5868dbd95000eb1476d0db032" title="Load the DIIS object from disk. " alt="" coords="263,6459,439,6485"/>
<area shape="rect" id="node34" href="classCheMPS2_1_1DMRGSCFoptions.html#a55ce3e1a48b8d977e53db9874c8fd7c6" title="Get the threshold for DMRGSCF convergence. " alt="" coords="251,6510,451,6551"/>
<area shape="rect" id="node35" href="classCheMPS2_1_1DMRGSCFunitary.html#a0b7e14e83dd48b97dcd791509bddc630" title="Update the unitary transformation. " alt="" coords="831,3677,1029,3718"/>
<area shape="rect" id="node37" href="classCheMPS2_1_1DMRGSCFunitary.html#a661342a71c1ee032e9c2bf0efaa8e799" title="Orbitals are defined up to a phase factor. Make sure that the logarithm of each block of the unitary ..." alt="" coords="539,3482,736,3523"/>
<area shape="rect" id="node38" href="classCheMPS2_1_1DMRGSCFunitary.html#a4fc1da7a1ee20da577495f0f0c6d5100" title="Obtain the logarithm of the unitary matrix. " alt="" coords="252,3746,449,3787"/>
<area shape="rect" id="node44" href="classCheMPS2_1_1DIIS.html#ae08b4931a1ed04490fecb06618d26432" title="Append a new error and parameter vector. " alt="" coords="253,6576,448,6603"/>
<area shape="rect" id="node45" href="classCheMPS2_1_1DIIS.html#ad8f60dd3e52d1d8a59c155c25a7ce3f3" title="Calculate the new parameter vector, based on the just appended error and parameter vectors..." alt="" coords="262,6627,439,6669"/>
<area shape="rect" id="node46" href="classCheMPS2_1_1DMRGSCFunitary.html#aa40f3a37dd71b9a2c714fc98094d115e" title="Save the unitary to disk. " alt="" coords="539,4645,736,4686"/>
<area shape="rect" id="node48" href="classCheMPS2_1_1DIIS.html#a49b15fbf0a60e554085ba5c868e11440" title="Save the DIIS object to disk. " alt="" coords="261,6693,441,6720"/>
<area shape="rect" id="node49" href="classCheMPS2_1_1DMRGSCFrotations.html#a0ac61c3fa5cf82a20d0664b1e1452ea0" title="Fill the rotated two&#45;body matrix elements for the space. If the blocks become too large..." alt="" coords="826,4145,1034,4186"/>
<area shape="rect" id="node51" href="classCheMPS2_1_1EdmistonRuedenberg.html#af52e7bc01e8f31e9b605ec4130f0337c" title="Maximize the Edmiston&#45;Ruedenberg cost function. " alt="" coords="530,4150,745,4191"/>
<area shape="rect" id="node53" href="classCheMPS2_1_1DMRGSCFoptions.html#a874f361f6567bebf376a4d35095b4a98" title="Get whether the localization procedure should start from a random unitary. " alt="" coords="251,6745,451,6786"/>
<area shape="rect" id="node54" href="classCheMPS2_1_1EdmistonRuedenberg.html#ad73febba415f3bcbef367b587d5bcc0d" title="Permute the orbitals so that the bandwidth of the exchange matrix is (approximately) minimized (per i..." alt="" coords="530,3269,745,3310"/>
<area shape="rect" id="node57" href="classCheMPS2_1_1CASSCF.html#a49e2785c67342a2c907cf16292e9b589" title="From an Edmiston&#45;Ruedenberg active space rotation, fetch the eigenvectors and store them in eigenvecs..." alt="" coords="819,3546,1041,3587"/>
<area shape="rect" id="node65" href="classCheMPS2_1_1EdmistonRuedenberg.html#af02cbffdb428682c4d53cf6c862fdb02" title="Get the pointer to the unitary to use in DMRGSCF. " alt="" coords="823,3794,1037,3835"/>
<area shape="rect" id="node66" href="classCheMPS2_1_1DMRGSCFunitary.html#a2fb26346f9c7a15af27b459f7d5b0d3b" title="Rotate the unitary matrix. " alt="" coords="831,3962,1029,4003"/>
<area shape="rect" id="node67" href="classCheMPS2_1_1EdmistonRuedenberg.html#aeefc7cee7eae7da6c2beb4e0c0cdfd7c" title="Permute the orbitals so that the bandwidth of the exchange matrix is (approximately) minimized..." alt="" coords="530,3178,745,3219"/>
<area shape="rect" id="node68" href="classCheMPS2_1_1FCI.html#af904234f3a73203c39ddadba56d49555" title="Getter for the number of variables in the vector &quot; E_ij | FCI vector &gt; &quot; ; where irrep_center = I_i x..." alt="" coords="2776,7199,2976,7225"/>
<area shape="rect" id="node69" href="classCheMPS2_1_1FCI.html#afb601467d67d5d85b3783d144d608557" title="Set the entries of a vector to zero. " alt="" coords="2781,5965,2971,5992"/>
<area shape="rect" id="node70" href="classCheMPS2_1_1FCI.html#a34faadeeb812173bfa523f8619d40f87" title="Return the global counter of the Slater determinant with the lowest energy. " alt="" coords="1727,8039,1930,8081"/>
<area shape="rect" id="node77" href="classCheMPS2_1_1FCI.html#a9fba49f1eba2366bd5a26d6d5521c8e8" title="Calculates the FCI ground state with Davidson&#39;s algorithm. " alt="" coords="253,5667,448,5693"/>
<area shape="rect" id="node84" href="classCheMPS2_1_1FCI.html#a36e81090d6d9c12eb8e86f65ce1e66b4" title="Construct the (spin&#45;summed) 2&#45;RDM of a FCI vector: Gamma^2(i,j,k,l) = sum_sigma,tau &lt; a^+_i..." alt="" coords="2001,6735,2175,6761"/>
<area shape="rect" id="node115" href="classCheMPS2_1_1DMRG.html#acfb3123c72e3503f2d6c77dcf9eb141a" title="Push back current calculation and set everything up to calculate a (new) excitation. " alt="" coords="527,537,748,564"/>
<area shape="rect" id="node117" href="classCheMPS2_1_1DMRG.html#ab6d80dde8b71171ee969a6b7b86193d2" title="Solver. " alt="" coords="551,647,723,673"/>
<area shape="rect" id="node157" href="classCheMPS2_1_1DMRGSCFoptions.html#a82add836b4de5c8ef97dda33553f2c64" title="Get whether state&#45;averaging or state&#45;specific DMRGSCF should be performed. " alt="" coords="251,6810,451,6851"/>
<area shape="rect" id="node158" href="classCheMPS2_1_1DMRG.html#aea1ffffbf2e12b56d602e5b692dd3a79" title="Calculate the 2&#45;RDM and correlations. Afterwards the MPS is again in LLLLLLLC gauge. " alt="" coords="245,2609,457,2650"/>
<area shape="rect" id="node182" href="classCheMPS2_1_1CASSCF.html#a0dbcb41aa9097e3b45b93c232337ec8a" title="Copy over the DMRG 2&#45;RDM. " alt="" coords="520,2909,755,2936"/>
<area shape="rect" id="node184" href="classCheMPS2_1_1DMRG.html#a0b471ea7ea19f7a49e6e1412f443d5ac" title="Get the pointer to the 2&#45;RDM. " alt="" coords="258,6876,443,6903"/>
<area shape="rect" id="node185" href="classCheMPS2_1_1DMRG.html#ab442cbc43e2e5d877660859578849133" title="Activate the necessary storage and machinery to handle excitations. " alt="" coords="512,2207,763,2233"/>
<area shape="rect" id="node186" href="classCheMPS2_1_1DMRGSCFoptions.html#acb3c7d12b054befbe92d704d6746f4be" title="Get whether the correlations and two&#45;orbital mutual information should be printed. " alt="" coords="251,6927,451,6969"/>
<area shape="rect" id="node187" href="classCheMPS2_1_1DMRG.html#a13008f80dbfd8312ef4aa3990cbbc436" title="Get the pointer to the Correlations. " alt="" coords="237,2157,464,2184"/>
<area shape="rect" id="node190" href="classCheMPS2_1_1DMRG.html#a0f4e487c40f522846288fe1b3d55e66c" title="Call &quot;rm &quot; + CheMPS2::DMRG_MPS_storage_prefix + &quot;*.h5&quot;. " alt="" coords="517,2257,758,2284"/>
<area shape="rect" id="node191" href="classCheMPS2_1_1DMRG.html#a2254cc31b5d9497694ea2229226b7bd6" title="Call &quot;rm &quot; + tempfolder + &quot;/&quot; + CheMPS2::DMRG_OPERATOR_storage_prefix + string(thePID) + &quot;*..." alt="" coords="531,2309,743,2350"/>
<area shape="rect" id="node193" href="classCheMPS2_1_1Correlations.html#a9e99dc1d7c2d571e2743ff6b472c50f6" title="Print the correlation functions and two&#45;orbital mutual information. " alt="" coords="271,6993,431,7034"/>
<area shape="rect" id="node194" href="classCheMPS2_1_1CASSCF.html#ac35e694fd9e00f47d361bdbd47b787e1" title="Construct the 1&#45;RDM from the 2&#45;RDM. " alt="" coords="517,329,757,356"/>
<area shape="rect" id="node195" href="classCheMPS2_1_1CASSCF.html#a3f20d25b94c1d821f22f95a6bab0ebc7" title="Copy a one&#45;orbital quantity from array format to DMRGSCFmatrix format. " alt="" coords="839,4327,1021,4369"/>
<area shape="rect" id="node196" href="classCheMPS2_1_1CASSCF.html#a13589f3ee9f293b743676739bb1db372" title="Block&#45;diagonalize Mat. " alt="" coords="838,4079,1022,4121"/>
<area shape="rect" id="node197" href="classCheMPS2_1_1DMRGSCFoptions.html#a834d5855220d7b90769ab5677a0b221b" title="Get the maximum number of DMRGSCF iterations. " alt="" coords="251,7058,451,7099"/>
<area shape="rect" id="node198" href="classCheMPS2_1_1CASSCF.html#a0210ff118bab44593aef7c6ec9f31a56" title="Build the F&#45;matrix (Eq. (11) in the Siegbahn paper [CAS3]) " alt="" coords="825,4276,1035,4303"/>
<area shape="rect" id="node202" href="classCheMPS2_1_1CASSCF.html#a21471f166b873029b5e51dda4a6907c4" title="Build the Wtilde&#45;matrix (Eq. (20b) in the Siegbahn paper [CAS3]) " alt="" coords="529,4909,746,4936"/>
<area shape="rect" id="node205" href="classCheMPS2_1_1CASSCF.html#a184b5eacca476b5c00750d0485b5e0b1" title="Calculate the augmented Hessian Newton&#45;Raphson update for the orthogonal orbital rotation matrix..." alt="" coords="529,5187,746,5229"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1MPIchemps2.html#a2a6ae387436d5e5b0a320a12b87244e1" title="Get the number of MPI processes. " alt="" coords="2005,918,2171,959"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1Tensor.html#ad68f65759e764c6cb55e2b8db18f8874" title="Get the number of tensor blocks. " alt="" coords="1992,984,2184,1011"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1Tensor.html#a2f17a5413447e77ad3f128d49b3ca676" title="Get the pointer to the storage. " alt="" coords="1993,2181,2183,2208"/>
<area shape="rect" id="node7" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c" title="Get the number of irreps. " alt="" coords="1125,4743,1324,4785"/>
<area shape="rect" id="node8" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892" title="Get the number of occupied orbitals for an irrep. " alt="" coords="1125,4809,1324,4850"/>
<area shape="rect" id="node10" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2" title="Get the number of orbitals for an irrep. " alt="" coords="1433,4239,1632,4281"/>
<area shape="rect" id="node11" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec" title="Get the number of active orbitals for an irrep. " alt="" coords="1125,4626,1324,4667"/>
<area shape="rect" id="node12" href="classCheMPS2_1_1DMRGSCFindices.html#afdbe42f60924d9fb705cce44426d72d0" title="Get the number of virtual orbitals for an irrep. " alt="" coords="1125,5230,1324,5271"/>
<area shape="rect" id="node18" href="classCheMPS2_1_1Irreps.html#a1d86c7a8b3c3a7b9215c0e298f0ae047" title="Get the direct product of the irreps with numbers Irrep1 and Irrep2: a bitwise XOR for psi4&#39;s convent..." alt="" coords="2781,5191,2971,5217"/>
<area shape="rect" id="node22" href="classCheMPS2_1_1FourIndex.html#ae93c264cbb81e7d39db778a129dc7ca1" title="Get an element. " alt="" coords="2001,3163,2175,3189"/>
<area shape="rect" id="node19" href="classCheMPS2_1_1Irreps.html#a78b964944caac0cf835e42a428cfef67" title="Fill the array psi2molpro with the irrep conventions of molpro for the currently activated group..." alt="" coords="3068,5213,3235,5254"/>
<area shape="rect" id="node20" href="classCheMPS2_1_1Irreps.html#afd70b3b21e33a3f8163db04a768ef848" title="Print all info contained in this class. " alt="" coords="3066,5161,3237,5188"/>
<area shape="rect" id="node21" href="classCheMPS2_1_1Irreps.html#afd3d1b65e870aad920125c05606c4a7d" title="Get the number of irreps for the currently activated group. " alt="" coords="3327,74,3521,115"/>
<area shape="rect" id="node27" href="classCheMPS2_1_1DMRGSCFmatrix.html#acdf72e3e9d5adb923a6dfd0c0be5c27d" title="Read the DMRGSCFmatrix from disk. " alt="" coords="540,3409,735,3450"/>
<area shape="rect" id="node36" href="classCheMPS2_1_1DMRGSCFunitary.html#a8fb18978b7e7de003479e3d06a3dca0a" title="Calculate the two&#45;norm of U^T*U &#45; I. " alt="" coords="1126,3955,1323,3997"/>
<area shape="rect" id="node39" href="classCheMPS2_1_1DMRGSCFunitary.html#a96ea3563e1b1ea0965554f83025e5fbc" title="Constructor. " alt="" coords="539,4386,736,4427"/>
<area shape="rect" id="node42" href="classCheMPS2_1_1DMRGSCFmatrix.html#ae019dbde820a91821cdac1b8ff7bf1e1" title="Get the RMS deviation with another DMRGSCFmatrix. " alt="" coords="833,3611,1027,3653"/>
<area shape="rect" id="node40" href="classCheMPS2_1_1DMRGSCFmatrix.html#abe77319841704812afe86d98b2378149" title="Make this matrix the identity matrix. " alt="" coords="833,4210,1027,4251"/>
<area shape="rect" id="node41" href="classCheMPS2_1_1DMRGSCFmatrix.html#a0729b05fef0cb96eaf26e7c8d6017931" title="Clear the matrix. " alt="" coords="1127,4509,1322,4550"/>
<area shape="rect" id="node43" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9" title="Get an element. " alt="" coords="1115,3904,1335,3931"/>
<area shape="rect" id="node47" href="classCheMPS2_1_1DMRGSCFmatrix.html#ac234313f31037f3ecc326451704ae688" title="Write a DMRGSCFmatrix to disk. " alt="" coords="833,4611,1027,4653"/>
<area shape="rect" id="node50" href="classCheMPS2_1_1DMRGSCFmatrix.html#a230d9fa54109d0754a054868611177c5" title="Get a matrix block. " alt="" coords="1127,4073,1322,4114"/>
<area shape="rect" id="node52" href="classCheMPS2_1_1DMRGSCFindices.html#a2fd841a1120c44377df3ef8d9d1c9f27" title="Get the number of orbitals. " alt="" coords="831,3295,1029,3337"/>
<area shape="rect" id="node55" href="classCheMPS2_1_1DMRGSCFindices.html#a2b1f2ae0964f9c0ecd653acfe88f5bd4" title="Get the irrep corresponding to a global orbital index. " alt="" coords="831,3178,1029,3219"/>
<area shape="rect" id="node56" href="classCheMPS2_1_1DMRGSCFindices.html#a1a24f5ffe9537c50cf1a23211e3a7a5f" title="Get in the original Hamiltonian index the start orbital for the occupied orbitals with a certain irre..." alt="" coords="831,3113,1029,3154"/>
<area shape="rect" id="node58" href="classCheMPS2_1_1DMRGSCFindices.html#ad00b61100928e4134728b4e0ad17e018" title="Get the cumulative number of active orbitals for an irrep. " alt="" coords="1125,4138,1324,4179"/>
<area shape="rect" id="node59" href="classCheMPS2_1_1Special.html#aa4f2b217e055a343e0446eaadd395154" title="Triangle function for two variables. " alt="" coords="1446,2801,1619,2842"/>
<area shape="rect" id="node60" href="classCheMPS2_1_1DMRGSCFmatrix.html#a3660ff17cbeb278c265b6461450b1a24" title="Set an element. " alt="" coords="1115,4407,1335,4433"/>
<area shape="rect" id="node61" href="classCheMPS2_1_1TwoIndex.html#a49c7065a18ca6b82e7a63a56cdf2687c" title="Get an element. " alt="" coords="1138,3432,1311,3459"/>
<area shape="rect" id="node62" href="classCheMPS2_1_1Hamiltonian.html#af6664242601063dd762c6a430054e4c5" title="Set the constant energy. " alt="" coords="1145,3483,1304,3525"/>
<area shape="rect" id="node63" href="classCheMPS2_1_1Hamiltonian.html#a7a56bcf4365125ec144c21d5a4684c32" title="Set a Tmat element. " alt="" coords="1145,3366,1304,3407"/>
<area shape="rect" id="node64" href="classCheMPS2_1_1TwoIndex.html#a4385881853e910bb1ce7d5ea911b75c4" title="Set an element. " alt="" coords="1446,3373,1619,3400"/>
<area shape="rect" id="node71" href="classCheMPS2_1_1FCI.html#abe702e621bfaec9302f81561cde3c144" title="Function which returns the diagonal elements of the FCI Hamiltonian (without Econstant!!) = Slater de..." alt="" coords="2256,8053,2431,8080"/>
<area shape="rect" id="node72" href="classCheMPS2_1_1FCI.html#aeb59e611639c0249e422f0f7c5dfda28" title="Find the bit representation of a global counter corresponding to &quot; E_ij | FCI vector &gt; &quot; ; where irre..." alt="" coords="2505,7801,2726,7828"/>
<area shape="rect" id="node75" href="classCheMPS2_1_1FCI.html#ada6d8ff3debe7a82fe843785a2b2d84e" title="Function which returns the AUGMENTED one&#45;body matrix elements ( G_{ij} = T_{ij} &#45; 0..." alt="" coords="2791,8004,2961,8031"/>
<area shape="rect" id="node76" href="classCheMPS2_1_1FCI.html#a56cbdfb4af815c382559c888a32e67ac" title="Function which returns the electron repulsion integral (in chemists notation: integral dr1 dr2 orb1(r..." alt="" coords="2795,8156,2957,8183"/>
<area shape="rect" id="node73" href="classCheMPS2_1_1FCI.html#aa86f6afd61836e4bad67955b3f900465" title="Find the irrep of the up Slater determinant of a global counter corresponding to &quot; E_ij | FCI vector ..." alt="" coords="2785,7794,2967,7835"/>
<area shape="rect" id="node74" href="classCheMPS2_1_1FCI.html#aee672b186854b9fdaf2402203892852e" title="Convertor between two representations of a same spin&#45;projection Slater determinant. " alt="" coords="2795,8308,2957,8335"/>
<area shape="rect" id="node78" href="classCheMPS2_1_1Davidson.html#a3a04d5e4423b6cfc15f985aecf50c4b2" title="The iterator to converge the ground state vector. " alt="" coords="1148,5667,1301,5709"/>
<area shape="rect" id="node79" href="classCheMPS2_1_1FCI.html#a2da3e8cbf73c6bfb5a5f0ca6e1c7f987" title="Copy a vector. " alt="" coords="1999,7796,2177,7823"/>
<area shape="rect" id="node80" href="classCheMPS2_1_1FCI.html#a631d174616e2e3cea01205bce5379934" title="Fill a vector with random numbers in the interval [&#45;1,1[; used when output for GSDavidson is desired ..." alt="" coords="837,5869,1023,5896"/>
<area shape="rect" id="node81" href="classCheMPS2_1_1FCI.html#a6909d31a41e439edfcff0049cb200de0" title="Function which performs the Hamiltonian times Vector product (without Econstant!!) making use of the ..." alt="" coords="2534,7047,2697,7073"/>
<area shape="rect" id="node83" href="classCheMPS2_1_1FCI.html#ad9df11199ab6633de3df7b9c1c51001a" title="Function which returns the nuclear repulsion energy. " alt="" coords="548,7087,727,7113"/>
<area shape="rect" id="node114" href="classCheMPS2_1_1Davidson.html#a0a9f07122a47a4ec24e6add4b8b30797" title="Get the number of matrix vector multiplications which have been performed. " alt="" coords="1147,5602,1302,5643"/>
<area shape="rect" id="node82" href="classCheMPS2_1_1FCI.html#a79c9426a1f2d8a4b918adad9ffa89894" title="Get an orbital irrep. " alt="" coords="2780,6311,2972,6337"/>
<area shape="rect" id="node85" href="classCheMPS2_1_1FCI.html#a278f51555ab4e5da474403748cff8098" title="Apply E_{crea,anni} to |orig_vector&gt; and store the result in |result_vector&gt; " alt="" coords="2540,6093,2691,6134"/>
<area shape="rect" id="node86" href="classCheMPS2_1_1FCI.html#a568465ddb393655431e710b3f202ccaa" title="Take the inproduct of two vectors. " alt="" coords="2260,6404,2427,6431"/>
<area shape="rect" id="node87" href="classCheMPS2_1_1FCI.html#a46c8a713121b5554e76ffdd640450e2d" title="Construct the (spin&#45;summed) 3&#45;RDM of a FCI vector: Gamma^3(i,j,k,l,m,n) = sum_sigma,tau,s &lt; a^+_{i,sigma} a^+_{j,tau} a^+_{k,s} a_{n,s} a_{m,tau} a_{l,sigma} &gt; = ThreeRDM[ i + L * ( j + L * ( k + L * ( l + L * ( m + L * n ) ) ) ) ]. " alt="" coords="843,7484,1017,7511"/>
<area shape="rect" id="node88" href="classCheMPS2_1_1FCI.html#afbbec65f5e8dca3f343defa609ca108f" title="Construct the (spin&#45;summed) 4&#45;RDM of a FCI vector: Gamma^4(i,j,k,l,p,q,r,t) = sum_sigma,tau,s,z &lt; a^+_{i,sigma} a^+_{j,tau} a^+_{k,s} a^+_{l,z} a_{t,z} a_{r,s} a_{q,tau} a_{p,sigma} &gt; = FourRDM[ i + L * ( j + L * ( k + L * ( l + L * ( p + L * ( q + L * ( r + L * t ) ) ) ) ) ) ]. " alt="" coords="2001,6177,2175,6204"/>
<area shape="rect" id="node89" href="classCheMPS2_1_1FCI.html#a91869efdf5f581c444c69627bd3b593a" title="Construct the (spin&#45;summed) contraction of the 4&#45;RDM with the Fock operator: output(i,j,k,p,q,r) = sum_{l,t} Fock(l,t) * Gamma^4(i,j,k,l,p,q,r,t) " alt="" coords="837,7535,1023,7561"/>
<area shape="rect" id="node90" href="classCheMPS2_1_1FCI.html#a77058d7ff4691b13b773dd4ea6118bc8" title="Construct part of the 4&#45;RDM: output(i,j,k,p,q,r) = Gamma^4(i,j,k,z,p,q,r,z) " alt="" coords="1995,6113,2181,6140"/>
<area shape="rect" id="node91" href="classCheMPS2_1_1FCI.html#a6bccc92d238c94ba8e212075a464f48c" title="Do lapack&#39;s daxpy vec_y += alpha * vec_x. " alt="" coords="2255,7441,2432,7468"/>
<area shape="rect" id="node92" href="classCheMPS2_1_1FCI.html#ac6d07ca52369591cf7a7676c7181b45f" title="Measure S(S+1) (spin squared) " alt="" coords="2505,6657,2726,6684"/>
<area shape="rect" id="node93" href="classCheMPS2_1_1FCI.html#aaa00a4720e4796700dc9ebd83aa71cfc" title="Calculate the retarded Green&#39;s function (= addition + removal amplitude) " alt="" coords="835,6583,1025,6609"/>
<area shape="rect" id="node94" href="classCheMPS2_1_1FCI.html#ae8035a4a03bc0232f6a38a90f1477a60" title="Calculate the addition part of the retarded Green&#39;s function: &lt;GSvector| a_{alpha, spin(isUp)} [ omega &#45; Ham + GSenergy + I*eta ]^{&#45;1} a^+_{beta, spin(isUp)} |GSvector&gt; " alt="" coords="1129,6605,1320,6646"/>
<area shape="rect" id="node95" href="classCheMPS2_1_1FCI.html#a490f73f0901972ed913a47119b5e0f23" title="Calculate the addition Green&#39;s function: GF[i+numLeft*j] = &lt;GSvector| a_{orbsLeft[i], spin} [ alpha + beta * Ham + I*eta ]^{&#45;1} a^+_{orbsRight[j], spin} |GSvector&gt; " alt="" coords="1445,6605,1620,6646"/>
<area shape="rect" id="node96" href="classCheMPS2_1_1FCI.html#ac33683cb6adf2063e7fe0fc908c3febb" title="Set thisVector to a creator/annihilator acting on otherVector. " alt="" coords="2238,5830,2449,5871"/>
<area shape="rect" id="node97" href="classCheMPS2_1_1FCI.html#a87f310673fe8b183cb4a5bf3d3051f9f" title="Function which returns a FCI coefficient. " alt="" coords="2521,5737,2710,5764"/>
<area shape="rect" id="node98" href="classCheMPS2_1_1FCI.html#adfc4c041ecd01c3610624b92dcf1ed5b" title="Convertor between two representations of a same spin&#45;projection Slater determinant. " alt="" coords="2795,5661,2957,5688"/>
<area shape="rect" id="node99" href="classCheMPS2_1_1FCI.html#ab41b5c8e777fcdfeb700c7763f64f805" title="Calculate the solution of the equation ( alpha + beta * Hamiltonian + I * eta ) Solution = RHS with c..." alt="" coords="1719,7340,1938,7367"/>
<area shape="rect" id="node100" href="classCheMPS2_1_1FCI.html#a34f2b199f72e604c96f1aeda63f00d21" title="Calculate (without approximation) diagonal = diag[ (alpha + beta * Hamiltonian)^2 + eta^2 ] (Econstan..." alt="" coords="1994,7745,2182,7772"/>
<area shape="rect" id="node101" href="classCheMPS2_1_1FCI.html#a5dd256cb52e3b7a16ce5895dc012664e" title="Function which returns the diagonal elements of the FCI Hamiltonian squared (without Econstant!!) ..." alt="" coords="2232,7796,2455,7823"/>
<area shape="rect" id="node102" href="classCheMPS2_1_1FCI.html#a38332cb2e35e961f8b95901002385770" title="Calculate out = [(alpha + beta * Hamiltonian)^2 + eta^2] * in (Econstant is taken into account!!) ..." alt="" coords="1995,7391,2181,7417"/>
<area shape="rect" id="node103" href="classCheMPS2_1_1FCI.html#a10b843aafc2f153ee1b5dbf3699c8a1b" title="Calculate out = (alpha + beta * Hamiltonian) * in (Econstant is taken into account!!) ..." alt="" coords="2244,7133,2443,7174"/>
<area shape="rect" id="node104" href="classCheMPS2_1_1FCI.html#aabbf6b2efcbcafcac2a584c08f2be1a6" title="Calculate the removal part of the retarded Green&#39;s function: &lt;GSvector| a^+_{beta, spin(isUp)} [ omega + Ham &#45; GSenergy + I*eta ]^{&#45;1} a_{alpha, spin(isUp)} |GSvector&gt; " alt="" coords="1129,6525,1320,6566"/>
<area shape="rect" id="node105" href="classCheMPS2_1_1FCI.html#ad940e823b2f18ce3d85ff2f3a0e94889" title="Calculate the removal Green&#39;s function: GF[i+numLeft*j] = &lt;GSvector| a^+_{orbsLeft[i], spin} [ alpha + beta * Ham + I*eta ]^{&#45;1} a_{orbsRight[j], spin} |GSvector&gt; " alt="" coords="1445,6423,1620,6465"/>
<area shape="rect" id="node106" href="classCheMPS2_1_1FCI.html#a132bbdf8fb4063a5199c7cbbbdccc0e0" title="Calculate the density response Green&#39;s function (= forward &#45; backward propagating part) ..." alt="" coords="1103,7281,1346,7308"/>
<area shape="rect" id="node107" href="classCheMPS2_1_1FCI.html#ac8ae42bbe769daf5254064e65adc076f" title="Calculate the forward propagating part of the density response Green&#39;s function: &lt;GSvector| ( n_alpha..." alt="" coords="1421,7353,1645,7394"/>
<area shape="rect" id="node108" href="classCheMPS2_1_1FCI.html#ac7b47739c602e3351baca282bdc715ca" title="Set resultVector to the number operator of a specific site acting on sourceVector. " alt="" coords="1722,7594,1935,7635"/>
<area shape="rect" id="node109" href="classCheMPS2_1_1FCI.html#aee7af7bfd2815c30db028025d573a684" title="Calculate the backward propagating part of the density response Green&#39;s function: &lt;GSvector| ( n_beta..." alt="" coords="1421,7181,1645,7222"/>
<area shape="rect" id="node110" href="classCheMPS2_1_1FCI.html#adf8c063a9d17fe98f0bcaba1281c648f" title="Sandwich the Hamiltonian between two Slater determinants (return a specific element) (without Econsta..." alt="" coords="2503,8308,2728,8335"/>
<area shape="rect" id="node111" href="classCheMPS2_1_1FCI.html#aa1acb129d5615d8ea7840a3909032726" title="Calculate the 2&#45;norm of a vector. " alt="" coords="1717,6228,1941,6255"/>
<area shape="rect" id="node112" href="classCheMPS2_1_1FCI.html#a68a5f1dd25036aa6d5e1b395746ee04a" title="Do lapack&#39;s dscal vec *= alpha. " alt="" coords="843,6481,1017,6508"/>
<area shape="rect" id="node113" href="classCheMPS2_1_1FCI.html#afe4f50a1de6b4c6a6be2f7e8dd4b91e2" title="Calculate the solution of the system Operator |Sol&gt; = |RESID&gt; with Operator = precon * [ ( alpha + be..." alt="" coords="827,7332,1033,7359"/>
<area shape="rect" id="node116" href="classCheMPS2_1_1DMRG.html#aa6e349febeaf92b9dfa4c7f92d8507d4" title="Reconstruct the renormalized operators when you overwrite the matrix elements with Prob&#45;&gt;setMxElement..." alt="" coords="834,195,1026,221"/>
<area shape="rect" id="node118" href="classCheMPS2_1_1ConvergenceScheme.html#a1d5339434adafc615592bf92ab9feb16" title="Get the number of instructions. " alt="" coords="823,297,1037,338"/>
<area shape="rect" id="node119" href="classCheMPS2_1_1ConvergenceScheme.html#ac12ca4a6c69913388eca92bdc361f118" title="Get the energy convergence threshold for a particular instruction. " alt="" coords="823,414,1037,455"/>
<area shape="rect" id="node120" href="classCheMPS2_1_1ConvergenceScheme.html#a982fa5f929b66ed42211f64eb6d5a192" title="Get the number of renormalized states for a particular instruction. " alt="" coords="823,479,1037,521"/>
<area shape="rect" id="node121" href="classCheMPS2_1_1ConvergenceScheme.html#aaa418f2b95ef871dca6a6aa4d6b0b8cb" title="Get the noise prefactor for a particular instruction. " alt="" coords="823,545,1037,586"/>
<area shape="rect" id="node122" href="classCheMPS2_1_1ConvergenceScheme.html#a487130810ed96f93112f07e9beb65f3c" title="Get the Davidson residual tolerance for a particular instruction. " alt="" coords="823,610,1037,651"/>
<area shape="rect" id="node123" href="classCheMPS2_1_1Sobject.html#a687a29eab89ef3763af8c630b48e3bf6" title="Join two sites to form a composite S&#45;object. " alt="" coords="1141,1309,1308,1336"/>
<area shape="rect" id="node128" href="classCheMPS2_1_1Heff.html#a1075e481d1a1d12f09f791be7389d2f4" title="Davidson Solver. " alt="" coords="817,777,1043,804"/>
<area shape="rect" id="node134" href="classCheMPS2_1_1Problem.html#a6c6f133286114da1666965c8048e47a1" title="Get the constant part of the Hamiltonian. " alt="" coords="1127,549,1322,576"/>
<area shape="rect" id="node147" href="classCheMPS2_1_1Sobject.html#abe676ef06644b5b675c65b123d118f2c" title="Add noise to the current S&#45;object. " alt="" coords="831,828,1029,855"/>
<area shape="rect" id="node148" href="classCheMPS2_1_1Sobject.html#a34983e86ae9f19de0be6b923479c13df" title="SVD an S&#45;object into 2 TensorT&#39;s. " alt="" coords="846,1563,1014,1589"/>
<area shape="rect" id="node124" href="classCheMPS2_1_1Special.html#afffda0b19a0e9dc4bddca5fb3ebfd350" title="Phase function. " alt="" coords="1445,1393,1621,1420"/>
<area shape="rect" id="node125" href="classCheMPS2_1_1SyBookkeeper.html#ade15ac00f19abf28ea238a7d2530e049" title="Get the current virtual dimensions. " alt="" coords="1445,2233,1620,2274"/>
<area shape="rect" id="node126" href="classCheMPS2_1_1TensorT.html#aafb4d43ad6178437b47a32a24c375fa3" title="Get the pointer to the storage. " alt="" coords="1433,1613,1632,1640"/>
<area shape="rect" id="node127" href="classCheMPS2_1_1Wigner.html#a552611fbd1be53036fc06e52fc8632fa" title="Wigner&#45;6j symbol (gsl api) " alt="" coords="1439,1563,1626,1589"/>
<area shape="rect" id="node129" href="classCheMPS2_1_1Sobject.html#aff81bb404f07da2814b396306fb38588" title="Get the storage jump corresponding to a certain symmetry block. " alt="" coords="1113,651,1337,677"/>
<area shape="rect" id="node130" href="classCheMPS2_1_1Sobject.html#a1dfbe469443fbf7daa49c1d0cb34425e" title="Get the number of symmetry blocks. " alt="" coords="1127,701,1323,728"/>
<area shape="rect" id="node131" href="classCheMPS2_1_1Sobject.html#a01b16408c5439e0eca69b2fde6d0185c" title="Convert the storage from diagram convention to symmetric Hamiltonian convention. " alt="" coords="1119,397,1330,424"/>
<area shape="rect" id="node132" href="classCheMPS2_1_1Sobject.html#a55a31306f564c1d220d36ac9a07623c9" title="Get the pointer to the storage. " alt="" coords="1127,803,1322,829"/>
<area shape="rect" id="node133" href="classCheMPS2_1_1Sobject.html#a2b482f6b45ddd735e42b906843c10e24" title="Convert the storage from symmetric Hamiltonian convention to diagram convention. " alt="" coords="1119,448,1330,475"/>
<area shape="rect" id="node135" href="classCheMPS2_1_1Hamiltonian.html#a031fa6987b304e3a7f6114b9f2e1f2ab" title="Get the constant energy. " alt="" coords="1453,550,1612,591"/>
<area shape="rect" id="node136" href="classCheMPS2_1_1Problem.html#af3ad2a73da9b8af05d145b448cf8bc36" title="Get a specific interaction matrix element. " alt="" coords="1423,797,1642,824"/>
<area shape="rect" id="node137" href="classCheMPS2_1_1Problem.html#a0a979c3461cc2824cb7c0e91442d5e14" title="Set the matrix elements: Note that each time you create a DMRG object, they will be overwritten with ..." alt="" coords="1713,435,1944,461"/>
<area shape="rect" id="node138" href="classCheMPS2_1_1Problem.html#ac2e23ae168f5c9ffa1c98a73da91def4" title="Construct a table with the h&#45;matrix elements (two&#45;body augmented with one&#45;body). Remember to recall t..." alt="" coords="1433,615,1633,657"/>
<area shape="rect" id="node139" href="classCheMPS2_1_1Problem.html#a6e26b40eb9bf80eb9979083b58a4e30e" title="Check whether the given parameters L, N, and TwoS are not inconsistent and whether 0&lt;=Irrep&lt;nIrreps..." alt="" coords="3024,119,3279,145"/>
<area shape="rect" id="node140" href="classCheMPS2_1_1Problem.html#a2b562b3dce075741cf3cf038143a2754" title="Get whether the Hamiltonian orbitals are reordered for the DMRG calculation. " alt="" coords="1433,2617,1632,2644"/>
<area shape="rect" id="node141" href="classCheMPS2_1_1Problem.html#af261a2869feffd866b1f7ee5052c9ae9" title="Get the DMRG index corresponding to a Ham index. " alt="" coords="1451,2516,1615,2543"/>
<area shape="rect" id="node142" href="classCheMPS2_1_1Problem.html#ac5d35cb647b66606e3cf69a21bbcb98a" title="Get the Ham index corresponding to a DMRG index. " alt="" coords="1451,851,1615,877"/>
<area shape="rect" id="node143" href="classCheMPS2_1_1Problem.html#ace8f96e419792f829198e96b897da0a9" title="Reorder the orbitals, so that they form irrep blocks, with order of irreps Ag B1u B3u B2g B2u B3g B1g..." alt="" coords="1407,448,1658,475"/>
<area shape="rect" id="node144" href="classCheMPS2_1_1Problem.html#aac2913c0dbc0d28dc2ed6cefe853f873" title="Reorder the orbitals, so that they form irrep blocks, with order of irreps A1 B1 B2 A2..." alt="" coords="1407,499,1658,525"/>
<area shape="rect" id="node145" href="classCheMPS2_1_1Problem.html#aaa734d8f3bf869965af7529df4ff4dfc" title="Reorder the orbitals to a custom ordering. Previous reorderings are cleared. " alt="" coords="1739,583,1918,625"/>
<area shape="rect" id="node146" href="classCheMPS2_1_1Problem.html#a24b9329bce03b3d6797750a530d4dd59" title="Reorder the orbitals for d(infinity)h. Previous reorderings are cleared. " alt="" coords="1443,681,1622,722"/>
<area shape="rect" id="node149" href="classCheMPS2_1_1SyBookkeeper.html#a5e5fbbeb3f0a499ec4b905200f4a14b2" title="Get the min. possible particle number for a certain boundary. " alt="" coords="1445,2065,1620,2106"/>
<area shape="rect" id="node150" href="classCheMPS2_1_1SyBookkeeper.html#a3e5f4d30bef465424acb784caaf62628" title="Get the max. possible particle number for a certain boundary. " alt="" coords="1445,1999,1620,2041"/>
<area shape="rect" id="node151" href="classCheMPS2_1_1SyBookkeeper.html#ad57f3ba5107c78bdd56131c40ae4f3e9" title="Get the minimum possible spin value for a certain boundary and particle number. " alt="" coords="1445,1766,1620,1807"/>
<area shape="rect" id="node152" href="classCheMPS2_1_1SyBookkeeper.html#ad89a9ec018a14187e5a3e5b87ad9fb2c" title="Get the maximum possible spin value for a certain boundary and particle number. " alt="" coords="1445,1831,1620,1873"/>
<area shape="rect" id="node153" href="classCheMPS2_1_1SyBookkeeper.html#aac9b4729c5fe841b619b9527dbf69e12" title="Get the total number of irreps. " alt="" coords="1445,2298,1620,2339"/>
<area shape="rect" id="node154" href="classCheMPS2_1_1SyBookkeeper.html#a87e4bca7afcfb744aa224ab2a942c8b4" title="Get the FCI virtual dimensions ( bound by SYBK_dimensionCutoff ) " alt="" coords="1445,1267,1620,1309"/>
<area shape="rect" id="node155" href="classCheMPS2_1_1SyBookkeeper.html#aeb6f41f7c78c9e15e02e6b238419b5e7" title="Get the current virtual dimensions. " alt="" coords="1137,1715,1312,1757"/>
<area shape="rect" id="node156" href="classCheMPS2_1_1TensorT.html#a1f0830b0e729573fe19a3327462f7e7e" title="Reset the TensorT (if virtual dimensions are changed) " alt="" coords="1134,1411,1315,1437"/>
<area shape="rect" id="node159" href="classCheMPS2_1_1DMRG.html#a43f338725791d3b5822acdba6444c056" title="Calculate the reduced density matrices and correlations. Afterwards the MPS is again in LLLLLLLC gaug..." alt="" coords="556,2374,719,2415"/>
<area shape="rect" id="node160" href="classCheMPS2_1_1TwoDM.html#a5c5bf12b31aa9cb4b0b31bd53dad1ed3" title="Fill the 2DM terms with as second site index denT&#45;&gt;gIndex() " alt="" coords="1133,2808,1317,2835"/>
<area shape="rect" id="node161" href="classCheMPS2_1_1TensorT.html#a279b51f0616ab58f2a2893681b4cab71" title="Get the location index. " alt="" coords="1440,2364,1625,2391"/>
<area shape="rect" id="node162" href="classCheMPS2_1_1TwoDM.html#a520ebec8dd2e56a475105e651a98fec3" title="Add the 2&#45;RDM elements of all MPI processes. " alt="" coords="847,2458,1013,2499"/>
<area shape="rect" id="node163" href="classCheMPS2_1_1TwoDM.html#a09eb9e2471fe7fb19659b611e3e4550b" title="After the whole 2&#45;RDM is filled, a prefactor for higher multiplicities should be applied. " alt="" coords="1133,1833,1317,1874"/>
<area shape="rect" id="node164" href="classCheMPS2_1_1SyBookkeeper.html#af39babd5df4cb5eeb84ffc017af841c3" title="Get the targeted particle number. " alt="" coords="830,2524,1030,2551"/>
<area shape="rect" id="node165" href="classCheMPS2_1_1TwoDM.html#a5ea664bc3b45270494e3d6e9f8d52619" title="Return the double trace of 2DM&#45;A (should be N(N&#45;1)) " alt="" coords="1138,3061,1311,3088"/>
<area shape="rect" id="node167" href="classCheMPS2_1_1TwoDM.html#ab35662dd77d8ae32f5b28bbe04239e79" title="Calculate the energy based on the 2DM&#45;A. " alt="" coords="839,879,1021,905"/>
<area shape="rect" id="node168" href="classCheMPS2_1_1TwoDM.html#ac24a417e0cd64e7c3a82c94ba1d9d71c" title="Print the natural orbital occupation numbers. " alt="" coords="1123,2472,1327,2499"/>
<area shape="rect" id="node169" href="classCheMPS2_1_1ThreeDM.html#a41f377c3636898276dcb6c2f30dbf3ad" title="Fill the 3&#45;RDM terms corresponding to site denT&#45;&gt;gIndex() " alt="" coords="1128,1899,1321,1925"/>
<area shape="rect" id="node170" href="classCheMPS2_1_1Correlations.html#ad0628c1674123410d212401e14812964" title="Fill at the current step of the iterations the two&#45;orbital mutual information and the remaining part ..." alt="" coords="1145,2254,1305,2295"/>
<area shape="rect" id="node171" href="classCheMPS2_1_1Correlations.html#ae175e3599bab50c3fe334e3a98c41f23" title="Broadcast the diradical correlation function and the two&#45;orbital mutual information. " alt="" coords="1145,2523,1305,2565"/>
<area shape="rect" id="node172" href="classCheMPS2_1_1ThreeDM.html#acceb29cbf3244a2fee196f36c87589a7" title="Add the 3&#45;RDM elements of all MPI processes. " alt="" coords="843,2626,1017,2667"/>
<area shape="rect" id="node173" href="classCheMPS2_1_1ThreeDM.html#a0a3de81e9881218690e26094be30b749" title="After the whole 3&#45;RDM is filled, a prefactor for higher multiplicities should be applied. " alt="" coords="834,2691,1026,2733"/>
<area shape="rect" id="node174" href="classCheMPS2_1_1Correlations.html#a1cf618a098e75511dda2fb0d010dab2e" title="Get the single&#45;orbital entropy for a certain site, using hte HAM indices. " alt="" coords="1131,2641,1318,2682"/>
<area shape="rect" id="node175" href="classCheMPS2_1_1Correlations.html#a3e4a935011b95ad18b28b88ac56990fc" title="Return Idistance(power) (see return for definition) " alt="" coords="837,2239,1023,2281"/>
<area shape="rect" id="node176" href="classCheMPS2_1_1ThreeDM.html#a363f29c1aea7e4317c3e5814099a6d5a" title="Return the trace (should be N(N&#45;1)(N&#45;2)) " alt="" coords="1442,904,1623,931"/>
<area shape="rect" id="node177" href="classCheMPS2_1_1TensorT.html#a5c9ed2cb2b6014a9b16b60670ff0d2d5" title="Get the pointer to the symmetry bookkeeper. " alt="" coords="845,2757,1015,2784"/>
<area shape="rect" id="node178" href="classCheMPS2_1_1TensorT.html#a1ee5bb57153170fc200acea0859a5ef9" title="Left&#45;normalization. " alt="" coords="1141,2101,1308,2128"/>
<area shape="rect" id="node179" href="classCheMPS2_1_1TensorT.html#a88c0e7491c53ff6ba5a737a380df188b" title="Multiply at the left with a diagonal TensorOperator. " alt="" coords="1118,2707,1331,2733"/>
<area shape="rect" id="node180" href="classCheMPS2_1_1TensorT.html#abc507af3cebe59f0800c12db47bd9752" title="Right&#45;normalization. " alt="" coords="1143,2051,1306,2077"/>
<area shape="rect" id="node181" href="classCheMPS2_1_1TensorT.html#a06f61e76a7a6d46c1899141c75678aa8" title="Multiply at the right with a diagonal TensorOperator. " alt="" coords="1113,2757,1336,2784"/>
<area shape="rect" id="node166" href="classCheMPS2_1_1TwoDM.html#a2cb905399d199f45e7101e3927933005" title="Get a 2DM_A term, using the DMRG indices. " alt="" coords="1400,3011,1665,3037"/>
<area shape="rect" id="node183" href="classCheMPS2_1_1TwoDM.html#a40c2181006aaf66b8dad2e545e3d8186" title="Get a 2DM_A term, using the HAM indices. " alt="" coords="1097,2859,1352,2885"/>
<area shape="rect" id="node188" href="classCheMPS2_1_1DMRG.html#a64ad5e21fad5c4f0a383438717942a0b" title="Get a specific FCI coefficient. The array coeff contains the occupation numbers of the L Hamiltonian ..." alt="" coords="535,1531,739,1573"/>
<area shape="rect" id="node189" href="classCheMPS2_1_1DMRG.html#a0c38c4f9194d77fdf28dc34c55be55c2" title="Get a specific FCI coefficient. The arrays alpha and beta contain the alpha and beta occupation numbe..." alt="" coords="811,1044,1049,1071"/>
<area shape="rect" id="node192" href="classCheMPS2_1_1DMRG.html#a6c8741ce96ac0e806a8ddc6c3623d904" title="Print the license. " alt="" coords="532,2105,743,2132"/>
<area shape="rect" id="node199" href="classCheMPS2_1_1DMRGSCFintegrals.html#ad462dfa92d77f1f02371f12e91cac429" title="Get a two&#45;body matrix element with at most 2 virtual indices, using the FourIndex API..." alt="" coords="1121,5398,1328,5439"/>
<area shape="rect" id="node200" href="classCheMPS2_1_1DMRGSCFintegrals.html#a2c40911e39bd643684180ff400b2a9f4" title="Get an element of the Coulomb object ( c1 c2 | a1 a2 ) " alt="" coords="2240,5215,2447,5257"/>
<area shape="rect" id="node201" href="classCheMPS2_1_1DMRGSCFintegrals.html#ad3549d8b199d76fdc1edab70e132dcb0" title="Get an element of the Exchange object ( c1 v1 | c2 v2 ) " alt="" coords="1429,5398,1636,5439"/>
<area shape="rect" id="node203" href="classCheMPS2_1_1DMRGSCFwtilde.html#a939e077b9fcc8ffafd9a168056991795" title="Clear. " alt="" coords="834,4961,1026,5002"/>
<area shape="rect" id="node204" href="classCheMPS2_1_1DMRGSCFwtilde.html#a1315dead44fb4c153c1e93758f048378" title="Get the (pr) subblock of w_tilde_pqrs, which is stored as w_tilde[ I_pq ][ I_rs ][ p + ( Nocc[I_pq] +..." alt="" coords="834,5078,1026,5119"/>
<area shape="rect" id="node206" href="classCheMPS2_1_1DMRGSCFwtilde.html#a39a6ec517f0bbd6129dce43473bfbc89" title="Get an element of w_tilde_pqrs. " alt="" coords="1115,5347,1334,5373"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ace43158fe31a38fb9d9131031895578b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::CASSCF::write_f4rdm_checkpoint </td>
          <td>(</td>
          <td class="paramtype">const string&#160;</td>
          <td class="paramname"><em>f4rdm_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>hamorb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>hamorb2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>tot_dmrg_power6</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>contract</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write the checkpoint file for the contraction of the generalized Fock operator with the 4-RDM to disk. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f4rdm_file</td><td>The filename </td></tr>
    <tr><td class="paramname">hamorb1</td><td>The next hamiltonian orbital 1 </td></tr>
    <tr><td class="paramname">hamorb2</td><td>The next hamiltonian orbital 2 </td></tr>
    <tr><td class="paramname">tot_dmrg_power6</td><td>The size of the array contract </td></tr>
    <tr><td class="paramname">contract</td><td>The current partial contraction </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="CASSCFpt2_8cpp_source.html#l00044">44</a> of file <a class="el" href="CASSCFpt2_8cpp_source.html">CASSCFpt2.cpp</a>.</p>

<p><div id="dynsection-28" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-28-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-28-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-28-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_ace43158fe31a38fb9d9131031895578b_cgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_ace43158fe31a38fb9d9131031895578b_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_ace43158fe31a38fb9d9131031895578b_cgraph" id="classCheMPS2_1_1CASSCF_ace43158fe31a38fb9d9131031895578b_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1MPIchemps2.html#a6732ae60b5b4c8a4f1b063f9db304bf5" title="Get the rank of this MPI process. " alt="" coords="235,64,401,105"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1MPIchemps2.html#a2a6ae387436d5e5b0a320a12b87244e1" title="Get the number of MPI processes. " alt="" coords="462,5,629,47"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1Tensor.html#ad68f65759e764c6cb55e2b8db18f8874" title="Get the number of tensor blocks. " alt="" coords="449,71,641,98"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1Tensor.html#a2f17a5413447e77ad3f128d49b3ca676" title="Get the pointer to the storage. " alt="" coords="450,122,641,149"/>
</map>
</div>
</p>

<p><div id="dynsection-29" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-29-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-29-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-29-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1CASSCF_ace43158fe31a38fb9d9131031895578b_icgraph.png" border="0" usemap="#classCheMPS2_1_1CASSCF_ace43158fe31a38fb9d9131031895578b_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1CASSCF_ace43158fe31a38fb9d9131031895578b_icgraph" id="classCheMPS2_1_1CASSCF_ace43158fe31a38fb9d9131031895578b_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#aa0ecf5c63622cb1f2aa4e72eebb31fe1" title="CASSCF DIIS vectors remove call. " alt="" coords="461,5,715,32"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1CASSCF.html#a3f1e0dc3e01be6e48eed126ca0ff1fd9" title="Build the contraction of the fock matrix with the 4&#45;RDM. " alt="" coords="235,53,413,94"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1CASSCF.html#a0e8e56a34c6f28fe27341425a1db8384" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="492,60,684,87"/>
</map>
</div>
</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="CASSCF_8h_source.html">CASSCF.h</a></li>
<li><a class="el" href="CASSCF_8cpp_source.html">CASSCF.cpp</a></li>
<li><a class="el" href="CASSCFdebug_8cpp_source.html">CASSCFdebug.cpp</a></li>
<li><a class="el" href="CASSCFnewtonraphson_8cpp_source.html">CASSCFnewtonraphson.cpp</a></li>
<li><a class="el" href="CASSCFpt2_8cpp_source.html">CASSCFpt2.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>CheMPS2</b></li><li class="navelem"><a class="el" href="classCheMPS2_1_1CASSCF.html">CASSCF</a></li>
    <li class="footer">Generated on Wed Aug 24 2016 10:09:17 for CheMPS2 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
