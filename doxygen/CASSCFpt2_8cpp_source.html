<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>CheMPS2: CASSCFpt2.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="CheMPS2logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CheMPS2
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('CASSCFpt2_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">CASSCFpt2.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">   CheMPS2: a spin-adapted implementation of DMRG for ab initio quantum chemistry</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">   Copyright (C) 2013-2016 Sebastian Wouters</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">   This program is free software; you can redistribute it and/or modify</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">   it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">   the Free Software Foundation; either version 2 of the License, or</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">   (at your option) any later version.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">   This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">   GNU General Public License for more details.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">   You should have received a copy of the GNU General Public License along</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">   with this program; if not, write to the Free Software Foundation, Inc.,</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">   51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;assert.h&gt;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;CASSCF.h&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;DMRG.h&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;FCI.h&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;DMRGSCFrotations.h&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;Lapack.h&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;Cumulant.h&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;CASPT2.h&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;MPIchemps2.h&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;EdmistonRuedenberg.h&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">using</span> std::string;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">using</span> std::ifstream;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">using</span> std::cout;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">using</span> std::endl;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keyword">using</span> std::max;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="classCheMPS2_1_1CASSCF.html#ace43158fe31a38fb9d9131031895578b">   44</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCheMPS2_1_1CASSCF.html#ace43158fe31a38fb9d9131031895578b">CheMPS2::CASSCF::write_f4rdm_checkpoint</a>( <span class="keyword">const</span> <span class="keywordtype">string</span> f4rdm_file, <span class="keywordtype">int</span> * hamorb1, <span class="keywordtype">int</span> * hamorb2, <span class="keyword">const</span> <span class="keywordtype">int</span> tot_dmrg_power6, <span class="keywordtype">double</span> * contract ){</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">   #ifdef CHEMPS2_MPI_COMPILATION</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> am_i_master = ( <a class="code" href="classCheMPS2_1_1MPIchemps2.html#a6732ae60b5b4c8a4f1b063f9db304bf5">MPIchemps2::mpi_rank</a>() == MPI_CHEMPS2_MASTER );</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">   #else</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> am_i_master = <span class="keyword">true</span>;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">   #endif</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <span class="keywordflow">if</span> ( am_i_master ){</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      hid_t file_id  = H5Fcreate( f4rdm_file.c_str(), H5F_ACC_TRUNC, H5P_DEFAULT, H5P_DEFAULT );</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      hid_t group_id = H5Gcreate( file_id, <span class="stringliteral">&quot;/F4RDM&quot;</span>, H5P_DEFAULT, H5P_DEFAULT, H5P_DEFAULT );</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      hsize_t dimarray1   = 1;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      hid_t dataspace1_id = H5Screate_simple( 1, &amp;dimarray1, NULL );</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      hid_t dataset1_id   = H5Dcreate( group_id, <span class="stringliteral">&quot;hamorb1&quot;</span>, H5T_NATIVE_INT, dataspace1_id, H5P_DEFAULT, H5P_DEFAULT, H5P_DEFAULT );</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      H5Dwrite( dataset1_id, H5T_NATIVE_INT, H5S_ALL, H5S_ALL, H5P_DEFAULT, hamorb1 );</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      H5Dclose( dataset1_id );</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      H5Sclose( dataspace1_id );</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      hsize_t dimarray2   = 1;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      hid_t dataspace2_id = H5Screate_simple( 1, &amp;dimarray2, NULL );</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      hid_t dataset2_id   = H5Dcreate( group_id, <span class="stringliteral">&quot;hamorb2&quot;</span>, H5T_NATIVE_INT, dataspace2_id, H5P_DEFAULT, H5P_DEFAULT, H5P_DEFAULT );</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      H5Dwrite( dataset2_id, H5T_NATIVE_INT, H5S_ALL, H5S_ALL, H5P_DEFAULT, hamorb2 );</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      H5Dclose( dataset2_id );</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      H5Sclose( dataspace2_id );</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      hsize_t dimarray3   = tot_dmrg_power6;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      hid_t dataspace3_id = H5Screate_simple( 1, &amp;dimarray3, NULL );</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      hid_t dataset3_id   = H5Dcreate( group_id, <span class="stringliteral">&quot;contract&quot;</span>, H5T_NATIVE_DOUBLE, dataspace3_id, H5P_DEFAULT, H5P_DEFAULT, H5P_DEFAULT );</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      H5Dwrite( dataset3_id, H5T_NATIVE_DOUBLE, H5S_ALL, H5S_ALL, H5P_DEFAULT, contract );</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      H5Dclose( dataset3_id );</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      H5Sclose( dataspace3_id );</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      H5Gclose( group_id );</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      H5Fclose( file_id );</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Created F.4-RDM checkpoint file &quot;</span> &lt;&lt; f4rdm_file &lt;&lt; <span class="stringliteral">&quot; at next orbitals ( &quot;</span> &lt;&lt; hamorb1[ 0 ] &lt;&lt; <span class="stringliteral">&quot; , &quot;</span> &lt;&lt; hamorb2[ 0 ] &lt;&lt; <span class="stringliteral">&quot; ).&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="classCheMPS2_1_1CASSCF.html#ad493cbf60a7b807ad0d3a06de74001b9">   87</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classCheMPS2_1_1CASSCF.html#ad493cbf60a7b807ad0d3a06de74001b9">CheMPS2::CASSCF::read_f4rdm_checkpoint</a>( <span class="keyword">const</span> <span class="keywordtype">string</span> f4rdm_file, <span class="keywordtype">int</span> * hamorb1, <span class="keywordtype">int</span> * hamorb2, <span class="keyword">const</span> <span class="keywordtype">int</span> tot_dmrg_power6, <span class="keywordtype">double</span> * contract ){</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">   #ifdef CHEMPS2_MPI_COMPILATION</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> am_i_master = ( <a class="code" href="classCheMPS2_1_1MPIchemps2.html#a6732ae60b5b4c8a4f1b063f9db304bf5">MPIchemps2::mpi_rank</a>() == MPI_CHEMPS2_MASTER );</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">   #else</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> am_i_master = <span class="keyword">true</span>;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">   #endif</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <span class="comment">// Check whether the file exists</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   <span class="keywordtype">int</span> exists = 0;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   <span class="keywordflow">if</span> ( am_i_master ){</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keyword">struct </span>stat file_info;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> file_stat = stat( f4rdm_file.c_str(), &amp;file_info );</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">if</span> ( file_stat == 0 ){ exists = 1; }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">   #ifdef CHEMPS2_MPI_COMPILATION</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   MPIchemps2::broadcast_array_int( &amp;exists, 1, MPI_CHEMPS2_MASTER );</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">   #endif</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   <span class="keywordflow">if</span> ( exists == 0 ){</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Not loaded</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   <span class="keywordflow">if</span> ( am_i_master ){</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      hid_t file_id  = H5Fopen( f4rdm_file.c_str(), H5F_ACC_RDONLY, H5P_DEFAULT );</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      hid_t group_id = H5Gopen( file_id, <span class="stringliteral">&quot;/F4RDM&quot;</span>, H5P_DEFAULT );</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      hid_t dataset1_id = H5Dopen( group_id, <span class="stringliteral">&quot;hamorb1&quot;</span>, H5P_DEFAULT );</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      H5Dread( dataset1_id, H5T_NATIVE_INT, H5S_ALL, H5S_ALL, H5P_DEFAULT, hamorb1 );</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      H5Dclose( dataset1_id );</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      hid_t dataset2_id = H5Dopen( group_id, <span class="stringliteral">&quot;hamorb2&quot;</span>, H5P_DEFAULT );</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      H5Dread( dataset2_id, H5T_NATIVE_INT, H5S_ALL, H5S_ALL, H5P_DEFAULT, hamorb2 );</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      H5Dclose( dataset2_id );</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      hid_t dataset3_id = H5Dopen( group_id, <span class="stringliteral">&quot;contract&quot;</span>, H5P_DEFAULT );</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      H5Dread( dataset3_id, H5T_NATIVE_DOUBLE, H5S_ALL, H5S_ALL, H5P_DEFAULT, contract );</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      H5Dclose( dataset3_id );</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      H5Gclose( group_id );</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      H5Fclose( file_id );</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor">   #ifdef CHEMPS2_MPI_COMPILATION</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   MPIchemps2::broadcast_array_int( hamorb1, 1, MPI_CHEMPS2_MASTER );</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   MPIchemps2::broadcast_array_int( hamorb2, 1, MPI_CHEMPS2_MASTER );</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   MPIchemps2::broadcast_array_double( contract, tot_dmrg_power6, MPI_CHEMPS2_MASTER );</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor">   #endif</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// Loaded</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;}</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="classCheMPS2_1_1CASSCF.html#a0e8e56a34c6f28fe27341425a1db8384">  140</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classCheMPS2_1_1CASSCF.html#a0e8e56a34c6f28fe27341425a1db8384">CheMPS2::CASSCF::caspt2</a>( <span class="keyword">const</span> <span class="keywordtype">int</span> Nelectrons, <span class="keyword">const</span> <span class="keywordtype">int</span> TwoS, <span class="keyword">const</span> <span class="keywordtype">int</span> Irrep, <a class="code" href="classCheMPS2_1_1ConvergenceScheme.html">ConvergenceScheme</a> * OptScheme, <span class="keyword">const</span> <span class="keywordtype">int</span> rootNum, <a class="code" href="classCheMPS2_1_1DMRGSCFoptions.html">DMRGSCFoptions</a> * scf_options, <span class="keyword">const</span> <span class="keywordtype">double</span> IPEA, <span class="keyword">const</span> <span class="keywordtype">double</span> IMAG, <span class="keyword">const</span> <span class="keywordtype">bool</span> PSEUDOCANONICAL, <span class="keyword">const</span> <span class="keywordtype">bool</span> CHECKPOINT, <span class="keyword">const</span> <span class="keywordtype">bool</span> CUMULANT ){</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="preprocessor">   #ifdef CHEMPS2_MPI_COMPILATION</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> am_i_master = ( <a class="code" href="classCheMPS2_1_1MPIchemps2.html#a6732ae60b5b4c8a4f1b063f9db304bf5">MPIchemps2::mpi_rank</a>() == MPI_CHEMPS2_MASTER );</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor">   #else</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> am_i_master = <span class="keyword">true</span>;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="preprocessor">   #endif</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> num_elec = Nelectrons - 2 * iHandler-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFindices.html#a2cb6c31a775d6f155942dc127eee2218">getNOCCsum</a>();</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   assert( num_elec &gt;= 0 );</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   <span class="keywordflow">if</span> ( <a class="code" href="classCheMPS2_1_1CASPT2.html#a0aad4cf7db898047a811ea75f45b2abc">CASPT2::vector_length</a>( iHandler ) == 0 ){</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordflow">if</span> ( am_i_master ){</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;CheMPS2::CASSCF::caspt2 : There are no CASPT2 excitations between the CORE, ACTIVE, and VIRTUAL orbital spaces.&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordflow">return</span> 0.0;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   }</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   <span class="comment">//Determine the maximum NORB(irrep) and the max_block_size for the ERI orbital rotation</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> maxlinsize      = iHandler-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFindices.html#ade657fa7e0ebf49098f5d22172a0dc01">getNORBmax</a>();</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> fullsize  = ((<span class="keywordtype">long</span> long) maxlinsize ) * ((<span class="keywordtype">long</span> long) maxlinsize ) * ((<span class="keywordtype">long</span> long) maxlinsize ) * ((<span class="keywordtype">long</span> long) maxlinsize );</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">string</span> tmp_filename = tmp_folder + <span class="stringliteral">&quot;/&quot;</span> + CheMPS2::DMRGSCF_eri_storage_name;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> dmrgsize_power4 = nOrbDMRG * nOrbDMRG * nOrbDMRG * nOrbDMRG;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   <span class="comment">//For (ERI rotation, update unitary, block diagonalize, orbital localization)</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   <a class="code" href="classCheMPS2_1_1DMRGSCFintegrals.html">DMRGSCFintegrals</a> * theRotatedTEI = <span class="keyword">new</span> <a class="code" href="classCheMPS2_1_1DMRGSCFintegrals.html">DMRGSCFintegrals</a>( iHandler );</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> temp_work_size = (( fullsize &gt; CheMPS2::DMRGSCF_max_mem_eri_tfo ) ? CheMPS2::DMRGSCF_max_mem_eri_tfo : fullsize );</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> work_mem_size  = max( max( temp_work_size , maxlinsize * maxlinsize * 4 ) , dmrgsize_power4 );</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> tot_dmrg_power6 = dmrgsize_power4 * nOrbDMRG * nOrbDMRG;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <span class="keywordtype">double</span> * mem1 = <span class="keyword">new</span> <span class="keywordtype">double</span>[ work_mem_size ];</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   <span class="keywordtype">double</span> * mem2 = <span class="keyword">new</span> <span class="keywordtype">double</span>[ ( PSEUDOCANONICAL ) ? work_mem_size : max( work_mem_size, tot_dmrg_power6 ) ];</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   <span class="comment">// Rotate to pseudocanonical orbitals</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   <span class="keywordflow">if</span> ( PSEUDOCANONICAL ){</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      assert( successful_solve ); <span class="comment">// DMRG1RDM needs to be set by CASSCF::solve for buildQmatACT()</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      buildTmatrix();</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      buildQmatOCC();</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      buildQmatACT();</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <a class="code" href="classCheMPS2_1_1CASSCF.html#a10b37b294f7573005a6b49b669e734ca">construct_fock</a>( theFmatrix, theTmatrix, theQmatOCC, theQmatACT, iHandler );</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <a class="code" href="classCheMPS2_1_1CASSCF.html#a13589f3ee9f293b743676739bb1db372">block_diagonalize</a>( <span class="charliteral">&#39;O&#39;</span>, theFmatrix, unitary, mem1, mem2, iHandler, <span class="keyword">false</span>, NULL, NULL, NULL );</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <a class="code" href="classCheMPS2_1_1CASSCF.html#a13589f3ee9f293b743676739bb1db372">block_diagonalize</a>( <span class="charliteral">&#39;A&#39;</span>, theFmatrix, unitary, mem1, mem2, iHandler, <span class="keyword">false</span>, NULL, NULL, NULL );</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <a class="code" href="classCheMPS2_1_1CASSCF.html#a13589f3ee9f293b743676739bb1db372">block_diagonalize</a>( <span class="charliteral">&#39;V&#39;</span>, theFmatrix, unitary, mem1, mem2, iHandler, <span class="keyword">false</span>, NULL, NULL, NULL );</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">if</span> ( successful_solve == <span class="keyword">false</span> ){</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;         assert( scf_options-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFoptions.html#acea3d3f5a5abf8a4bdd509fc13a1a275">getStoreUnitary</a>() );</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;         <span class="keywordflow">if</span> ( am_i_master ){</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="keyword">struct </span>stat file_info;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> file_stat = stat( (scf_options-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFoptions.html#a45fb0323c73651fb83f6856af5145e83">getUnitaryStorageName</a>()).c_str(), &amp;file_info );</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            assert( file_stat == 0 );</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            unitary-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFunitary.html#a93dc806a8a1c931334570903c326220e">loadU</a>( scf_options-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFoptions.html#a45fb0323c73651fb83f6856af5145e83">getUnitaryStorageName</a>() );</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;         }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor">         #ifdef CHEMPS2_MPI_COMPILATION</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;         unitary-&gt;broadcast( MPI_CHEMPS2_MASTER );</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">         #endif</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   <span class="comment">// Fill active space Hamiltonian</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   <a class="code" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a> * HamAS = <span class="keyword">new</span> <a class="code" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a>( nOrbDMRG, SymmInfo.<a class="code" href="classCheMPS2_1_1Irreps.html#a9813550797b0557cf22d2bca5f3e07b0">getGroupNumber</a>(), iHandler-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFindices.html#ae04eb205d9aa13edaae834e535c3396d">getIrrepOfEachDMRGorbital</a>() );</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   <a class="code" href="classCheMPS2_1_1Problem.html">Problem</a> * Prob = <span class="keyword">new</span> <a class="code" href="classCheMPS2_1_1Problem.html">Problem</a>( HamAS, TwoS, num_elec, Irrep );</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   Prob-&gt;SetupReorderD2h(); <span class="comment">// Doesn&#39;t matter if the group isn&#39;t D2h, Prob checks it.</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   buildTmatrix();</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   buildQmatOCC();</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   fillConstAndTmatDMRG( HamAS );</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   <span class="keywordflow">if</span> ( am_i_master ){</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <a class="code" href="classCheMPS2_1_1DMRGSCFrotations.html#a0ac61c3fa5cf82a20d0664b1e1452ea0">DMRGSCFrotations::rotate</a>( VMAT_ORIG, HamAS-&gt;<a class="code" href="classCheMPS2_1_1Hamiltonian.html#af2d3836be75d50640cbed9a9234af126">getVmat</a>(), NULL, <span class="charliteral">&#39;A&#39;</span>, <span class="charliteral">&#39;A&#39;</span>, <span class="charliteral">&#39;A&#39;</span>, <span class="charliteral">&#39;A&#39;</span>, iHandler, unitary, mem1, mem2, work_mem_size, tmp_filename );</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">   #ifdef CHEMPS2_MPI_COMPILATION</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   HamAS-&gt;<a class="code" href="classCheMPS2_1_1Hamiltonian.html#af2d3836be75d50640cbed9a9234af126">getVmat</a>()-&gt;broadcast( MPI_CHEMPS2_MASTER );</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">   #endif</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   <span class="comment">// Reorder the orbitals based on the Fiedler vector of the exchange matrix</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   <span class="keywordflow">if</span> ( scf_options-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFoptions.html#a9f81d7a089fc4a239638d95d93c24099">getWhichActiveSpace</a>() == 3 ){</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keywordtype">int</span> * dmrg2ham = <span class="keyword">new</span> <span class="keywordtype">int</span>[ nOrbDMRG ];</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="keywordflow">if</span> ( am_i_master ){</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;         <a class="code" href="classCheMPS2_1_1EdmistonRuedenberg.html">EdmistonRuedenberg</a> * theLocalizer = <span class="keyword">new</span> <a class="code" href="classCheMPS2_1_1EdmistonRuedenberg.html">EdmistonRuedenberg</a>( HamAS-&gt;<a class="code" href="classCheMPS2_1_1Hamiltonian.html#af2d3836be75d50640cbed9a9234af126">getVmat</a>(), iHandler-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFindices.html#a3689ebc91a3c11f3703ba21f53e7604d">getGroupNumber</a>() );</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;         theLocalizer-&gt;<a class="code" href="classCheMPS2_1_1EdmistonRuedenberg.html#aeefc7cee7eae7da6c2beb4e0c0cdfd7c">FiedlerGlobal</a>( dmrg2ham );</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;         <span class="keyword">delete</span> theLocalizer;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">      #ifdef CHEMPS2_MPI_COMPILATION</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      MPIchemps2::broadcast_array_int( dmrg2ham, nOrbDMRG, MPI_CHEMPS2_MASTER );</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="preprocessor">      #endif</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      Prob-&gt;setup_reorder_custom( dmrg2ham );</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keyword">delete</span> [] dmrg2ham;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;   }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   <span class="keywordtype">double</span> E_CASSCF = 0.0;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;   <span class="keywordtype">double</span> * three_dm = <span class="keyword">new</span> <span class="keywordtype">double</span>[ tot_dmrg_power6 ];</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;   <span class="keywordtype">double</span> * contract = <span class="keyword">new</span> <span class="keywordtype">double</span>[ tot_dmrg_power6 ];</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> cnt = 0; cnt &lt; tot_dmrg_power6; cnt++ ){ contract[ cnt ] = 0.0; }</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   <span class="keywordtype">int</span> next_hamorb1 = 0;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   <span class="keywordtype">int</span> next_hamorb2 = 0;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">bool</span> make_checkpt = (( CUMULANT == false ) &amp;&amp; ( CHECKPOINT ));</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;   <span class="keywordtype">bool</span> checkpt_loaded = <span class="keyword">false</span>;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;   <span class="keywordflow">if</span> ( make_checkpt ){</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      assert(( OptScheme != NULL ) || ( rootNum &gt; 1 ));</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      checkpt_loaded = <a class="code" href="classCheMPS2_1_1CASSCF.html#ad493cbf60a7b807ad0d3a06de74001b9">read_f4rdm_checkpoint</a>( CheMPS2::DMRGSCF_f4rdm_name, &amp;next_hamorb1, &amp;next_hamorb2, tot_dmrg_power6, contract );</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;   }</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   <span class="comment">// Solve the active space problem</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   <span class="keywordflow">if</span> (( OptScheme == NULL ) &amp;&amp; ( rootNum == 1 )){ <span class="comment">// Do FCI</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordflow">if</span> ( am_i_master ){</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> nalpha = ( num_elec + TwoS ) / 2;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> nbeta  = ( num_elec - TwoS ) / 2;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">double</span> workmem = 1000.0; <span class="comment">// 1GB</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> verbose = 2;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;         <a class="code" href="classCheMPS2_1_1FCI.html">CheMPS2::FCI</a> * theFCI = <span class="keyword">new</span> <a class="code" href="classCheMPS2_1_1FCI.html">CheMPS2::FCI</a>( HamAS, nalpha, nbeta, Irrep, workmem, verbose );</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;         <span class="keywordtype">double</span> * inoutput = <span class="keyword">new</span> <span class="keywordtype">double</span>[ theFCI-&gt;<a class="code" href="classCheMPS2_1_1FCI.html#af904234f3a73203c39ddadba56d49555">getVecLength</a>(0) ];</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;         theFCI-&gt;<a class="code" href="classCheMPS2_1_1FCI.html#afb601467d67d5d85b3783d144d608557">ClearVector</a>( theFCI-&gt;<a class="code" href="classCheMPS2_1_1FCI.html#af904234f3a73203c39ddadba56d49555">getVecLength</a>(0), inoutput );</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;         inoutput[ theFCI-&gt;<a class="code" href="classCheMPS2_1_1FCI.html#a34faadeeb812173bfa523f8619d40f87">LowestEnergyDeterminant</a>() ] = 1.0;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;         E_CASSCF = theFCI-&gt;<a class="code" href="classCheMPS2_1_1FCI.html#a9fba49f1eba2366bd5a26d6d5521c8e8">GSDavidson</a>( inoutput );</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;         theFCI-&gt;<a class="code" href="classCheMPS2_1_1FCI.html#a36e81090d6d9c12eb8e86f65ce1e66b4">Fill2RDM</a>( inoutput, DMRG2DM );                     <span class="comment">// 2-RDM</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;         theFCI-&gt;<a class="code" href="classCheMPS2_1_1FCI.html#a46c8a713121b5554e76ffdd640450e2d">Fill3RDM</a>( inoutput, three_dm );                    <span class="comment">// 3-RDM</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;         <a class="code" href="classCheMPS2_1_1CASSCF.html#ac35e694fd9e00f47d361bdbd47b787e1">setDMRG1DM</a>( num_elec, nOrbDMRG, DMRG1DM, DMRG2DM );        <span class="comment">// 1-RDM</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;         buildQmatACT();</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;         <a class="code" href="classCheMPS2_1_1CASSCF.html#a10b37b294f7573005a6b49b669e734ca">construct_fock</a>( theFmatrix, theTmatrix, theQmatOCC, theQmatACT, iHandler );</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;         <a class="code" href="classCheMPS2_1_1CASSCF.html#a3f20d25b94c1d821f22f95a6bab0ebc7">copy_active</a>( theFmatrix, mem2, iHandler );                 <span class="comment">// Fock</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;         theFCI-&gt;<a class="code" href="classCheMPS2_1_1FCI.html#a91869efdf5f581c444c69627bd3b593a">Fock4RDM</a>( inoutput, three_dm, mem2, contract );    <span class="comment">// trace( Fock * 4-RDM )</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;         <span class="keyword">delete</span> theFCI;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;         <span class="keyword">delete</span> [] inoutput;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      }</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="preprocessor">      #ifdef CHEMPS2_MPI_COMPILATION</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      MPIchemps2::broadcast_array_double( &amp;E_CASSCF, 1, MPI_CHEMPS2_MASTER );</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      MPIchemps2::broadcast_array_double(  DMRG2DM, dmrgsize_power4, MPI_CHEMPS2_MASTER );</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      MPIchemps2::broadcast_array_double( three_dm, tot_dmrg_power6, MPI_CHEMPS2_MASTER );</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      MPIchemps2::broadcast_array_double( contract, tot_dmrg_power6, MPI_CHEMPS2_MASTER );</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <a class="code" href="classCheMPS2_1_1CASSCF.html#ac35e694fd9e00f47d361bdbd47b787e1">setDMRG1DM</a>( num_elec, nOrbDMRG, DMRG1DM, DMRG2DM );</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="preprocessor">      #endif</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   } <span class="keywordflow">else</span> { <span class="comment">// Do the DMRG sweeps</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      assert( OptScheme != NULL );</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> cnt = 0; cnt &lt; dmrgsize_power4; cnt++ ){ DMRG2DM[ cnt ] = 0.0; } <span class="comment">// Clear the 2-RDM</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <a class="code" href="classCheMPS2_1_1DMRG.html">CheMPS2::DMRG</a> * theDMRG = <span class="keyword">new</span> <a class="code" href="classCheMPS2_1_1DMRG.html">DMRG</a>( Prob, OptScheme, make_checkpt, tmp_folder );</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> state = 0; state &lt; rootNum; state++ ){</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;         <span class="keywordflow">if</span> ( state &gt; 0 ){ theDMRG-&gt;<a class="code" href="classCheMPS2_1_1DMRG.html#acfb3123c72e3503f2d6c77dcf9eb141a">newExcitation</a>( fabs( E_CASSCF ) ); }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;         <span class="keywordflow">if</span> ( checkpt_loaded == <span class="keyword">false</span> ){ E_CASSCF = theDMRG-&gt;<a class="code" href="classCheMPS2_1_1DMRG.html#ab6d80dde8b71171ee969a6b7b86193d2">Solve</a>(); }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;         <span class="keywordflow">if</span> (( state == 0 ) &amp;&amp; ( rootNum &gt; 1 )){ theDMRG-&gt;<a class="code" href="classCheMPS2_1_1DMRG.html#ab442cbc43e2e5d877660859578849133">activateExcitations</a>( rootNum - 1 ); }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      theDMRG-&gt;<a class="code" href="classCheMPS2_1_1DMRG.html#a43f338725791d3b5822acdba6444c056">calc_rdms_and_correlations</a>( <span class="keyword">true</span> );</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <a class="code" href="classCheMPS2_1_1CASSCF.html#a0dbcb41aa9097e3b45b93c232337ec8a">copy2DMover</a>( theDMRG-&gt;<a class="code" href="classCheMPS2_1_1DMRG.html#a0b471ea7ea19f7a49e6e1412f443d5ac">get2DM</a>(), nOrbDMRG, DMRG2DM ); <span class="comment">// 2-RDM</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <a class="code" href="classCheMPS2_1_1CASSCF.html#ac35e694fd9e00f47d361bdbd47b787e1">setDMRG1DM</a>( num_elec, nOrbDMRG, DMRG1DM, DMRG2DM ); <span class="comment">// 1-RDM</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      buildQmatACT();</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <a class="code" href="classCheMPS2_1_1CASSCF.html#a10b37b294f7573005a6b49b669e734ca">construct_fock</a>( theFmatrix, theTmatrix, theQmatOCC, theQmatACT, iHandler );</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <a class="code" href="classCheMPS2_1_1CASSCF.html#a3f20d25b94c1d821f22f95a6bab0ebc7">copy_active</a>( theFmatrix, mem2, iHandler ); <span class="comment">// Fock</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordflow">if</span> ( CUMULANT ){</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;         <a class="code" href="classCheMPS2_1_1Cumulant.html#a71af6ca25a81326cac7f772bd9723ab7">CheMPS2::Cumulant::gamma4_fock_contract_ham</a>( Prob, theDMRG-&gt;<a class="code" href="classCheMPS2_1_1DMRG.html#ae87028e0d13f774aa31d5b41978e6aa4">get3DM</a>(), theDMRG-&gt;<a class="code" href="classCheMPS2_1_1DMRG.html#a0b471ea7ea19f7a49e6e1412f443d5ac">get2DM</a>(), mem2, contract );</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;         <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> ham_orbz = 0; ham_orbz &lt; nOrbDMRG; ham_orbz++ ){</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="keywordflow">if</span> (( next_hamorb1 == ham_orbz ) &amp;&amp; ( next_hamorb2 == ham_orbz )){</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;               theDMRG-&gt;<a class="code" href="classCheMPS2_1_1DMRG.html#a5e39f9d280ccbdc3944b5d50012306ac">Symm4RDM</a>( three_dm, ham_orbz, ham_orbz, <span class="keyword">false</span> );</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;               <span class="keywordtype">int</span> size = tot_dmrg_power6;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;               <span class="keywordtype">double</span> f_zz = 0.5 * mem2[ ham_orbz + nOrbDMRG * ham_orbz ];</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;               <span class="keywordtype">int</span> inc1 = 1;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;               daxpy_( &amp;size, &amp;f_zz, three_dm, &amp;inc1, contract, &amp;inc1 ); <span class="comment">// trace( Fock * 4-RDM )</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;               <span class="keywordflow">if</span> ( ham_orbz == nOrbDMRG - 1 ){</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                  next_hamorb1 = 0;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                  next_hamorb2 = 1;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;               } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                  next_hamorb1 = ham_orbz + 1;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                  next_hamorb2 = ham_orbz + 1;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;               }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;               <span class="keywordflow">if</span> ( make_checkpt ){ <a class="code" href="classCheMPS2_1_1CASSCF.html#ace43158fe31a38fb9d9131031895578b">write_f4rdm_checkpoint</a>( CheMPS2::DMRGSCF_f4rdm_name, &amp;next_hamorb1, &amp;next_hamorb2, tot_dmrg_power6, contract ); }</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;         }</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;         <span class="keywordflow">if</span> ( PSEUDOCANONICAL == <span class="keyword">false</span> ){</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> ham_orb1 = 0; ham_orb1 &lt; nOrbDMRG; ham_orb1++ ){</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;               <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> ham_orb2 = ham_orb1 + 1; ham_orb2 &lt; nOrbDMRG; ham_orb2++ ){</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                  <span class="keywordflow">if</span> (( next_hamorb1 == ham_orb1 ) &amp;&amp; ( next_hamorb2 == ham_orb2 )){</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                     <span class="keywordflow">if</span> ( HamAS-&gt;<a class="code" href="classCheMPS2_1_1Hamiltonian.html#a02130b2901a5a3c05171d4f7dd5fa4cd">getOrbitalIrrep</a>( ham_orb1 ) == HamAS-&gt;<a class="code" href="classCheMPS2_1_1Hamiltonian.html#a02130b2901a5a3c05171d4f7dd5fa4cd">getOrbitalIrrep</a>( ham_orb2 ) ){</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                        theDMRG-&gt;<a class="code" href="classCheMPS2_1_1DMRG.html#a5e39f9d280ccbdc3944b5d50012306ac">Symm4RDM</a>( three_dm, ham_orb1, ham_orb2, <span class="keyword">false</span> );</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                        <span class="keywordtype">int</span> size = tot_dmrg_power6;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                        <span class="keywordtype">double</span> f_12 = 0.5 * ( mem2[ ham_orb1 + nOrbDMRG * ham_orb2 ] + mem2[ ham_orb2 + nOrbDMRG * ham_orb1 ] );</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                        <span class="keywordtype">int</span> inc1 = 1;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                        daxpy_( &amp;size, &amp;f_12, three_dm, &amp;inc1, contract, &amp;inc1 ); <span class="comment">// trace( Fock * 4-RDM )</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                     }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                     <span class="keywordflow">if</span> ( ham_orb2 == nOrbDMRG - 1 ){</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                        next_hamorb1 = next_hamorb1 + 1;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                        next_hamorb2 = next_hamorb1 + 1;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                     } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                        next_hamorb2 = next_hamorb2 + 1;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                     }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                     <span class="keywordflow">if</span> (( HamAS-&gt;<a class="code" href="classCheMPS2_1_1Hamiltonian.html#a02130b2901a5a3c05171d4f7dd5fa4cd">getOrbitalIrrep</a>( ham_orb1 ) == HamAS-&gt;<a class="code" href="classCheMPS2_1_1Hamiltonian.html#a02130b2901a5a3c05171d4f7dd5fa4cd">getOrbitalIrrep</a>( ham_orb2 ) ) &amp;&amp; ( make_checkpt )){</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                        <a class="code" href="classCheMPS2_1_1CASSCF.html#ace43158fe31a38fb9d9131031895578b">write_f4rdm_checkpoint</a>( CheMPS2::DMRGSCF_f4rdm_name, &amp;next_hamorb1, &amp;next_hamorb2, tot_dmrg_power6, contract );</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                     }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                  }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;               }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;         }</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      }</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      theDMRG-&gt;<a class="code" href="classCheMPS2_1_1DMRG.html#ae87028e0d13f774aa31d5b41978e6aa4">get3DM</a>()-&gt;<a class="code" href="classCheMPS2_1_1ThreeDM.html#af918bc3d3c4655263b8205a2f99632c8">fill_ham_index</a>( 1.0, <span class="keyword">false</span>, three_dm, 0, nOrbDMRG );</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keywordflow">if</span> (( CheMPS2::DMRG_storeMpsOnDisk ) &amp;&amp; ( make_checkpt == <span class="keyword">false</span> )){ theDMRG-&gt;<a class="code" href="classCheMPS2_1_1DMRG.html#a0f4e487c40f522846288fe1b3d55e66c">deleteStoredMPS</a>(); }</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="keywordflow">if</span> ( CheMPS2::DMRG_storeRenormOptrOnDisk ){ theDMRG-&gt;<a class="code" href="classCheMPS2_1_1DMRG.html#a2254cc31b5d9497694ea2229226b7bd6">deleteStoredOperators</a>(); }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keyword">delete</span> theDMRG;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   }</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   <span class="keyword">delete</span> Prob;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   <span class="keyword">delete</span> HamAS;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   <span class="keywordflow">if</span> ( PSEUDOCANONICAL == <span class="keyword">false</span> ){</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="keywordflow">if</span> ( am_i_master ){ cout &lt;&lt; <span class="stringliteral">&quot;CASPT2 : Deviation from pseudocanonical = &quot;</span> &lt;&lt; <a class="code" href="classCheMPS2_1_1CASSCF.html#ad4c00cd4c21dc402ad5e966232b199d3">deviation_from_blockdiag</a>( theFmatrix, iHandler ) &lt;&lt; endl; }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <a class="code" href="classCheMPS2_1_1CASSCF.html#a13589f3ee9f293b743676739bb1db372">block_diagonalize</a>( <span class="charliteral">&#39;O&#39;</span>, theFmatrix, unitary, mem1, mem2, iHandler, <span class="keyword">false</span>, NULL, NULL, NULL );</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <a class="code" href="classCheMPS2_1_1CASSCF.html#a13589f3ee9f293b743676739bb1db372">block_diagonalize</a>( <span class="charliteral">&#39;A&#39;</span>, theFmatrix, unitary, mem1, mem2, iHandler, <span class="keyword">false</span>, DMRG2DM, three_dm, contract ); <span class="comment">// 2-RDM, 3-RDM, and trace( Fock * cu(4)-4-RDM )</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <a class="code" href="classCheMPS2_1_1CASSCF.html#a13589f3ee9f293b743676739bb1db372">block_diagonalize</a>( <span class="charliteral">&#39;V&#39;</span>, theFmatrix, unitary, mem1, mem2, iHandler, <span class="keyword">false</span>, NULL, NULL, NULL );</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <a class="code" href="classCheMPS2_1_1CASSCF.html#ac35e694fd9e00f47d361bdbd47b787e1">setDMRG1DM</a>( num_elec, nOrbDMRG, DMRG1DM, DMRG2DM ); <span class="comment">// 1-RDM</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      buildTmatrix();</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      buildQmatOCC();</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      buildQmatACT();</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <a class="code" href="classCheMPS2_1_1CASSCF.html#a10b37b294f7573005a6b49b669e734ca">construct_fock</a>( theFmatrix, theTmatrix, theQmatOCC, theQmatACT, iHandler ); <span class="comment">// Fock</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   }</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   <span class="comment">// Calculate the matrix elements needed to calculate the CASPT2 V-vector</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   <span class="keywordflow">if</span> ( am_i_master ){</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <a class="code" href="classCheMPS2_1_1DMRGSCFrotations.html#a0ac61c3fa5cf82a20d0664b1e1452ea0">DMRGSCFrotations::rotate</a>( VMAT_ORIG, NULL, theRotatedTEI, <span class="charliteral">&#39;C&#39;</span>, <span class="charliteral">&#39;C&#39;</span>, <span class="charliteral">&#39;F&#39;</span>, <span class="charliteral">&#39;F&#39;</span>, iHandler, unitary, mem1, mem2, work_mem_size, tmp_filename );</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <a class="code" href="classCheMPS2_1_1DMRGSCFrotations.html#a0ac61c3fa5cf82a20d0664b1e1452ea0">DMRGSCFrotations::rotate</a>( VMAT_ORIG, NULL, theRotatedTEI, <span class="charliteral">&#39;C&#39;</span>, <span class="charliteral">&#39;V&#39;</span>, <span class="charliteral">&#39;C&#39;</span>, <span class="charliteral">&#39;V&#39;</span>, iHandler, unitary, mem1, mem2, work_mem_size, tmp_filename );</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      delete_file( tmp_filename );</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;   }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;   <span class="keyword">delete</span> [] mem1;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   <span class="keyword">delete</span> [] mem2;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   <span class="keywordtype">double</span> E_CASPT2 = 0.0;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;   <span class="keywordflow">if</span> ( am_i_master ){</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;CASPT2 : Deviation from pseudocanonical = &quot;</span> &lt;&lt; <a class="code" href="classCheMPS2_1_1CASSCF.html#ad4c00cd4c21dc402ad5e966232b199d3">deviation_from_blockdiag</a>( theFmatrix, iHandler ) &lt;&lt; endl;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <a class="code" href="classCheMPS2_1_1CASPT2.html">CheMPS2::CASPT2</a> * myCASPT2 = <span class="keyword">new</span> <a class="code" href="classCheMPS2_1_1CASPT2.html">CheMPS2::CASPT2</a>( iHandler, theRotatedTEI, theTmatrix, theFmatrix, DMRG1DM, DMRG2DM, three_dm, contract, IPEA );</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keyword">delete</span> theRotatedTEI;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keyword">delete</span> [] three_dm;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="keyword">delete</span> [] contract;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      E_CASPT2 = myCASPT2-&gt;<a class="code" href="classCheMPS2_1_1CASPT2.html#acda216c42c5245d79ae398ec59f2253f">solve</a>( IMAG );</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keyword">delete</span> myCASPT2;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="keyword">delete</span> theRotatedTEI;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="keyword">delete</span> [] three_dm;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keyword">delete</span> [] contract;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;   }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="preprocessor">   #ifdef CHEMPS2_MPI_COMPILATION</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   MPIchemps2::broadcast_array_double( &amp;E_CASPT2, 1, MPI_CHEMPS2_MASTER );</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="preprocessor">   #endif</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   <span class="keywordflow">return</span> E_CASPT2;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno"><a class="line" href="classCheMPS2_1_1CASSCF.html#a10b37b294f7573005a6b49b669e734ca">  385</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCheMPS2_1_1CASSCF.html#a10b37b294f7573005a6b49b669e734ca">CheMPS2::CASSCF::construct_fock</a>( <a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> * Fock, <span class="keyword">const</span> <a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> * Tmat, <span class="keyword">const</span> <a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> * Qocc, <span class="keyword">const</span> <a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> * Qact, <span class="keyword">const</span> <a class="code" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> * idx ){</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> n_irreps = idx-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c">getNirreps</a>();</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> irrep = 0; irrep &lt; n_irreps; irrep++ ){</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> NORB = idx-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2">getNORB</a>( irrep );</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; NORB; row++){</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col = 0; col &lt; NORB; col++){</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            Fock-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html#a3660ff17cbeb278c265b6461450b1a24">set</a>( irrep, row, col, Tmat-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9">get</a>( irrep, row, col )</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                                      + Qocc-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9">get</a>( irrep, row, col )</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                                      + Qact-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9">get</a>( irrep, row, col ) );</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;         }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;}</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   </div><div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="classCheMPS2_1_1CASSCF.html#ad4c00cd4c21dc402ad5e966232b199d3">  401</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classCheMPS2_1_1CASSCF.html#ad4c00cd4c21dc402ad5e966232b199d3">CheMPS2::CASSCF::deviation_from_blockdiag</a>( <a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html">DMRGSCFmatrix</a> * matrix, <span class="keyword">const</span> <a class="code" href="classCheMPS2_1_1DMRGSCFindices.html">DMRGSCFindices</a> * idx ){</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;   </div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   <span class="keywordtype">double</span> rms_deviation = 0.0;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> n_irreps = idx-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c">getNirreps</a>();</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> irrep = 0; irrep &lt; n_irreps; irrep++ ){</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> NOCC = idx-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892">getNOCC</a>( irrep );</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> row = 0; row &lt; NOCC; row++ ){</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;         <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> col = row + 1; col &lt; NOCC; col++ ){</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            rms_deviation += matrix-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9">get</a>( irrep, row, col ) * matrix-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9">get</a>( irrep, row, col );</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            rms_deviation += matrix-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9">get</a>( irrep, col, row ) * matrix-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9">get</a>( irrep, col, row );</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;         }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      }</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> NACT = idx-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec">getNDMRG</a>( irrep );</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> row = 0; row &lt; NACT; row++ ){</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;         <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> col = row + 1; col &lt; NACT; col++ ){</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            rms_deviation += matrix-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9">get</a>( irrep, NOCC + row, NOCC + col ) * matrix-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9">get</a>( irrep, NOCC + row, NOCC + col );</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            rms_deviation += matrix-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9">get</a>( irrep, NOCC + col, NOCC + row ) * matrix-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9">get</a>( irrep, NOCC + col, NOCC + row );</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;         }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      }</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> NVIR = idx-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFindices.html#afdbe42f60924d9fb705cce44426d72d0">getNVIRT</a>( irrep );</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> N_OA = NOCC + NACT;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> row = 0; row &lt; NVIR; row++ ){</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;         <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> col = row + 1; col &lt; NVIR; col++ ){</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            rms_deviation += matrix-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9">get</a>( irrep, N_OA + row, N_OA + col ) * matrix-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9">get</a>( irrep, N_OA + row, N_OA + col );</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            rms_deviation += matrix-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9">get</a>( irrep, N_OA + col, N_OA + row ) * matrix-&gt;<a class="code" href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9">get</a>( irrep, N_OA + col, N_OA + row );</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;         }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      }</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   }</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   rms_deviation = sqrt( rms_deviation );</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   <span class="keywordflow">return</span> rms_deviation;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;}</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="ttc" id="classCheMPS2_1_1DMRGSCFoptions_html"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFoptions.html">CheMPS2::DMRGSCFoptions</a></div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFoptions_8h_source.html#l00051">DMRGSCFoptions.h:51</a></div></div>
<div class="ttc" id="classCheMPS2_1_1CASSCF_html_ace43158fe31a38fb9d9131031895578b"><div class="ttname"><a href="classCheMPS2_1_1CASSCF.html#ace43158fe31a38fb9d9131031895578b">CheMPS2::CASSCF::write_f4rdm_checkpoint</a></div><div class="ttdeci">static void write_f4rdm_checkpoint(const string f4rdm_file, int *hamorb1, int *hamorb2, const int tot_dmrg_power6, double *contract)</div><div class="ttdoc">Write the checkpoint file for the contraction of the generalized Fock operator with the 4-RDM to disk...</div><div class="ttdef"><b>Definition:</b> <a href="CASSCFpt2_8cpp_source.html#l00044">CASSCFpt2.cpp:44</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRGSCFindices_html_a2dbdf51ff018cb4110fdd14b300967c2"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFindices.html#a2dbdf51ff018cb4110fdd14b300967c2">CheMPS2::DMRGSCFindices::getNORB</a></div><div class="ttdeci">int getNORB(const int irrep) const </div><div class="ttdoc">Get the number of orbitals for an irrep. </div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFindices_8cpp_source.html#l00098">DMRGSCFindices.cpp:98</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRGSCFindices_html_a2cb6c31a775d6f155942dc127eee2218"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFindices.html#a2cb6c31a775d6f155942dc127eee2218">CheMPS2::DMRGSCFindices::getNOCCsum</a></div><div class="ttdeci">int getNOCCsum() const </div><div class="ttdoc">Get the total number of occupied orbitals. </div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFindices_8cpp_source.html#l00118">DMRGSCFindices.cpp:118</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRGSCFindices_html"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFindices.html">CheMPS2::DMRGSCFindices</a></div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFindices_8h_source.html#l00032">DMRGSCFindices.h:32</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRGSCFrotations_html_a0ac61c3fa5cf82a20d0664b1e1452ea0"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFrotations.html#a0ac61c3fa5cf82a20d0664b1e1452ea0">CheMPS2::DMRGSCFrotations::rotate</a></div><div class="ttdeci">static void rotate(const FourIndex *ORIG_VMAT, FourIndex *NEW_VMAT, DMRGSCFintegrals *ROT_TEI, const char space1, const char space2, const char space3, const char space4, DMRGSCFindices *idx, DMRGSCFunitary *umat, double *mem1, double *mem2, const int mem_size, const string filename)</div><div class="ttdoc">Fill the rotated two-body matrix elements for the space. If the blocks become too large...</div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFrotations_8cpp_source.html#l00389">DMRGSCFrotations.cpp:389</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRG_html_a5e39f9d280ccbdc3944b5d50012306ac"><div class="ttname"><a href="classCheMPS2_1_1DMRG.html#a5e39f9d280ccbdc3944b5d50012306ac">CheMPS2::DMRG::Symm4RDM</a></div><div class="ttdeci">void Symm4RDM(double *output, const int ham_orb1, const int ham_orb2, const bool last_case)</div><div class="ttdoc">Obtain the symmetrized 4-RDM terms 0.5 * ( Gamma4_ijkl,pqrt + Gamma4_ijkt,pqrl ) with l and t fixed...</div><div class="ttdef"><b>Definition:</b> <a href="DMRGfock_8cpp_source.html#l00041">DMRGfock.cpp:41</a></div></div>
<div class="ttc" id="classCheMPS2_1_1FCI_html_a9fba49f1eba2366bd5a26d6d5521c8e8"><div class="ttname"><a href="classCheMPS2_1_1FCI.html#a9fba49f1eba2366bd5a26d6d5521c8e8">CheMPS2::FCI::GSDavidson</a></div><div class="ttdeci">double GSDavidson(double *inoutput=NULL, const int DVDSN_NUM_VEC=CheMPS2::DAVIDSON_NUM_VEC) const </div><div class="ttdoc">Calculates the FCI ground state with Davidson&amp;#39;s algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="FCI_8cpp_source.html#l01920">FCI.cpp:1920</a></div></div>
<div class="ttc" id="classCheMPS2_1_1CASPT2_html_acda216c42c5245d79ae398ec59f2253f"><div class="ttname"><a href="classCheMPS2_1_1CASPT2.html#acda216c42c5245d79ae398ec59f2253f">CheMPS2::CASPT2::solve</a></div><div class="ttdeci">double solve(const double imag_shift, const bool CONJUGATE_GRADIENT=false) const </div><div class="ttdoc">Solve for the CASPT2 energy (note that the IPEA shift has been set in the constructor) ...</div><div class="ttdef"><b>Definition:</b> <a href="CASPT2_8cpp_source.html#l00206">CASPT2.cpp:206</a></div></div>
<div class="ttc" id="classCheMPS2_1_1CASSCF_html_a3f20d25b94c1d821f22f95a6bab0ebc7"><div class="ttname"><a href="classCheMPS2_1_1CASSCF.html#a3f20d25b94c1d821f22f95a6bab0ebc7">CheMPS2::CASSCF::copy_active</a></div><div class="ttdeci">static void copy_active(double *origin, DMRGSCFmatrix *result, const DMRGSCFindices *idx, const bool one_rdm)</div><div class="ttdoc">Copy a one-orbital quantity from array format to DMRGSCFmatrix format. </div><div class="ttdef"><b>Definition:</b> <a href="CASSCF_8cpp_source.html#l00375">CASSCF.cpp:375</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRG_html_a0f4e487c40f522846288fe1b3d55e66c"><div class="ttname"><a href="classCheMPS2_1_1DMRG.html#a0f4e487c40f522846288fe1b3d55e66c">CheMPS2::DMRG::deleteStoredMPS</a></div><div class="ttdeci">void deleteStoredMPS()</div><div class="ttdoc">Call &quot;rm &quot; + CheMPS2::DMRG_MPS_storage_prefix + &quot;*.h5&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="DMRGmpsio_8cpp_source.html#l00164">DMRGmpsio.cpp:164</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRGSCFindices_html_a3689ebc91a3c11f3703ba21f53e7604d"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFindices.html#a3689ebc91a3c11f3703ba21f53e7604d">CheMPS2::DMRGSCFindices::getGroupNumber</a></div><div class="ttdeci">int getGroupNumber() const </div><div class="ttdoc">Get the group number. </div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFindices_8cpp_source.html#l00094">DMRGSCFindices.cpp:94</a></div></div>
<div class="ttc" id="classCheMPS2_1_1CASSCF_html_a10b37b294f7573005a6b49b669e734ca"><div class="ttname"><a href="classCheMPS2_1_1CASSCF.html#a10b37b294f7573005a6b49b669e734ca">CheMPS2::CASSCF::construct_fock</a></div><div class="ttdeci">static void construct_fock(DMRGSCFmatrix *Fock, const DMRGSCFmatrix *Tmat, const DMRGSCFmatrix *Qocc, const DMRGSCFmatrix *Qact, const DMRGSCFindices *idx)</div><div class="ttdoc">Construct the Fock matrix. </div><div class="ttdef"><b>Definition:</b> <a href="CASSCFpt2_8cpp_source.html#l00385">CASSCFpt2.cpp:385</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRGSCFunitary_html_a93dc806a8a1c931334570903c326220e"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFunitary.html#a93dc806a8a1c931334570903c326220e">CheMPS2::DMRGSCFunitary::loadU</a></div><div class="ttdeci">void loadU(const string filename=DMRGSCF_unitary_storage_name)</div><div class="ttdoc">Load the unitary from disk. </div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFunitary_8cpp_source.html#l00437">DMRGSCFunitary.cpp:437</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRGSCFindices_html_ae04eb205d9aa13edaae834e535c3396d"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFindices.html#ae04eb205d9aa13edaae834e535c3396d">CheMPS2::DMRGSCFindices::getIrrepOfEachDMRGorbital</a></div><div class="ttdeci">int * getIrrepOfEachDMRGorbital()</div><div class="ttdoc">Get an array with the irreps of each DMRG orbital. </div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFindices_8cpp_source.html#l00114">DMRGSCFindices.cpp:114</a></div></div>
<div class="ttc" id="classCheMPS2_1_1Hamiltonian_html_a02130b2901a5a3c05171d4f7dd5fa4cd"><div class="ttname"><a href="classCheMPS2_1_1Hamiltonian.html#a02130b2901a5a3c05171d4f7dd5fa4cd">CheMPS2::Hamiltonian::getOrbitalIrrep</a></div><div class="ttdeci">int getOrbitalIrrep(const int nOrb) const </div><div class="ttdoc">Get an orbital irrep number. </div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian_8cpp_source.html#l00097">Hamiltonian.cpp:97</a></div></div>
<div class="ttc" id="classCheMPS2_1_1MPIchemps2_html_a6732ae60b5b4c8a4f1b063f9db304bf5"><div class="ttname"><a href="classCheMPS2_1_1MPIchemps2.html#a6732ae60b5b4c8a4f1b063f9db304bf5">CheMPS2::MPIchemps2::mpi_rank</a></div><div class="ttdeci">static int mpi_rank()</div><div class="ttdoc">Get the rank of this MPI process. </div><div class="ttdef"><b>Definition:</b> <a href="MPIchemps2_8h_source.html#l00131">MPIchemps2.h:131</a></div></div>
<div class="ttc" id="classCheMPS2_1_1CASPT2_html_a0aad4cf7db898047a811ea75f45b2abc"><div class="ttname"><a href="classCheMPS2_1_1CASPT2.html#a0aad4cf7db898047a811ea75f45b2abc">CheMPS2::CASPT2::vector_length</a></div><div class="ttdeci">static long long vector_length(const DMRGSCFindices *idx)</div><div class="ttdoc">Return the vector length for the CASPT2 first order wavefunction (before diagonalization of the overl...</div><div class="ttdef"><b>Definition:</b> <a href="CASPT2_8cpp_source.html#l00793">CASPT2.cpp:793</a></div></div>
<div class="ttc" id="classCheMPS2_1_1Hamiltonian_html_af2d3836be75d50640cbed9a9234af126"><div class="ttname"><a href="classCheMPS2_1_1Hamiltonian.html#af2d3836be75d50640cbed9a9234af126">CheMPS2::Hamiltonian::getVmat</a></div><div class="ttdeci">double getVmat(const int index1, const int index2, const int index3, const int index4) const </div><div class="ttdoc">Get a Vmat element. </div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian_8cpp_source.html#l00136">Hamiltonian.cpp:136</a></div></div>
<div class="ttc" id="classCheMPS2_1_1FCI_html"><div class="ttname"><a href="classCheMPS2_1_1FCI.html">CheMPS2::FCI</a></div><div class="ttdef"><b>Definition:</b> <a href="FCI_8h_source.html#l00032">FCI.h:32</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRG_html_a0b471ea7ea19f7a49e6e1412f443d5ac"><div class="ttname"><a href="classCheMPS2_1_1DMRG.html#a0b471ea7ea19f7a49e6e1412f443d5ac">CheMPS2::DMRG::get2DM</a></div><div class="ttdeci">TwoDM * get2DM()</div><div class="ttdoc">Get the pointer to the 2-RDM. </div><div class="ttdef"><b>Definition:</b> <a href="DMRG_8h_source.html#l00113">DMRG.h:113</a></div></div>
<div class="ttc" id="classCheMPS2_1_1Irreps_html_a9813550797b0557cf22d2bca5f3e07b0"><div class="ttname"><a href="classCheMPS2_1_1Irreps.html#a9813550797b0557cf22d2bca5f3e07b0">CheMPS2::Irreps::getGroupNumber</a></div><div class="ttdeci">int getGroupNumber() const </div><div class="ttdoc">Get the group number. </div><div class="ttdef"><b>Definition:</b> <a href="Irreps_8cpp_source.html#l00066">Irreps.cpp:66</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRGSCFmatrix_html_a3660ff17cbeb278c265b6461450b1a24"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFmatrix.html#a3660ff17cbeb278c265b6461450b1a24">CheMPS2::DMRGSCFmatrix::set</a></div><div class="ttdeci">void set(const int irrep, const int p, const int q, const double val)</div><div class="ttdoc">Set an element. </div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFmatrix_8cpp_source.html#l00052">DMRGSCFmatrix.cpp:52</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRGSCFindices_html_ade657fa7e0ebf49098f5d22172a0dc01"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFindices.html#ade657fa7e0ebf49098f5d22172a0dc01">CheMPS2::DMRGSCFindices::getNORBmax</a></div><div class="ttdeci">int getNORBmax() const </div><div class="ttdoc">Get the maximum NORB. </div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFindices_8cpp_source.html#l00126">DMRGSCFindices.cpp:126</a></div></div>
<div class="ttc" id="classCheMPS2_1_1FCI_html_a34faadeeb812173bfa523f8619d40f87"><div class="ttname"><a href="classCheMPS2_1_1FCI.html#a34faadeeb812173bfa523f8619d40f87">CheMPS2::FCI::LowestEnergyDeterminant</a></div><div class="ttdeci">unsigned int LowestEnergyDeterminant() const </div><div class="ttdoc">Return the global counter of the Slater determinant with the lowest energy. </div><div class="ttdef"><b>Definition:</b> <a href="FCI_8cpp_source.html#l01700">FCI.cpp:1700</a></div></div>
<div class="ttc" id="classCheMPS2_1_1ThreeDM_html_af918bc3d3c4655263b8205a2f99632c8"><div class="ttname"><a href="classCheMPS2_1_1ThreeDM.html#af918bc3d3c4655263b8205a2f99632c8">CheMPS2::ThreeDM::fill_ham_index</a></div><div class="ttdeci">void fill_ham_index(const double alpha, const bool add, double *storage, const int last_orb_start, const int last_orb_num)</div><div class="ttdoc">Perform storage[ :, :, :, :, :, : ] { = or += } alpha * 3-RDM[ :, :, :, :, :, last_orb_start: last_or...</div><div class="ttdef"><b>Definition:</b> <a href="ThreeDM_8cpp_source.html#l00155">ThreeDM.cpp:155</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRG_html_ab6d80dde8b71171ee969a6b7b86193d2"><div class="ttname"><a href="classCheMPS2_1_1DMRG.html#ab6d80dde8b71171ee969a6b7b86193d2">CheMPS2::DMRG::Solve</a></div><div class="ttdeci">double Solve()</div><div class="ttdoc">Solver. </div><div class="ttdef"><b>Definition:</b> <a href="DMRG_8cpp_source.html#l00199">DMRG.cpp:199</a></div></div>
<div class="ttc" id="classCheMPS2_1_1CASSCF_html_a0dbcb41aa9097e3b45b93c232337ec8a"><div class="ttname"><a href="classCheMPS2_1_1CASSCF.html#a0dbcb41aa9097e3b45b93c232337ec8a">CheMPS2::CASSCF::copy2DMover</a></div><div class="ttdeci">static void copy2DMover(TwoDM *theDMRG2DM, const int LAS, double *two_dm)</div><div class="ttdoc">Copy over the DMRG 2-RDM. </div><div class="ttdef"><b>Definition:</b> <a href="CASSCF_8cpp_source.html#l00119">CASSCF.cpp:119</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRGSCFoptions_html_a9f81d7a089fc4a239638d95d93c24099"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFoptions.html#a9f81d7a089fc4a239638d95d93c24099">CheMPS2::DMRGSCFoptions::getWhichActiveSpace</a></div><div class="ttdeci">int getWhichActiveSpace() const </div><div class="ttdoc">Get which active space should be considered in the DMRG routine. </div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFoptions_8cpp_source.html#l00054">DMRGSCFoptions.cpp:54</a></div></div>
<div class="ttc" id="classCheMPS2_1_1CASSCF_html_a0e8e56a34c6f28fe27341425a1db8384"><div class="ttname"><a href="classCheMPS2_1_1CASSCF.html#a0e8e56a34c6f28fe27341425a1db8384">CheMPS2::CASSCF::caspt2</a></div><div class="ttdeci">double caspt2(const int Nelectrons, const int TwoS, const int Irrep, ConvergenceScheme *OptScheme, const int rootNum, DMRGSCFoptions *scf_options, const double IPEA, const double IMAG, const bool PSEUDOCANONICAL, const bool CHECKPOINT=false, const bool CUMULANT=false)</div><div class="ttdoc">Calculate the caspt2 correction energy for a converged casscf wavefunction. </div><div class="ttdef"><b>Definition:</b> <a href="CASSCFpt2_8cpp_source.html#l00140">CASSCFpt2.cpp:140</a></div></div>
<div class="ttc" id="classCheMPS2_1_1CASSCF_html_a13589f3ee9f293b743676739bb1db372"><div class="ttname"><a href="classCheMPS2_1_1CASSCF.html#a13589f3ee9f293b743676739bb1db372">CheMPS2::CASSCF::block_diagonalize</a></div><div class="ttdeci">static void block_diagonalize(const char space, const DMRGSCFmatrix *Mat, DMRGSCFunitary *Umat, double *work1, double *work2, const DMRGSCFindices *idx, const bool invert, double *two_dm, double *three_dm, double *contract)</div><div class="ttdoc">Block-diagonalize Mat. </div><div class="ttdef"><b>Definition:</b> <a href="CASSCF_8cpp_source.html#l00433">CASSCF.cpp:433</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRG_html"><div class="ttname"><a href="classCheMPS2_1_1DMRG.html">CheMPS2::DMRG</a></div><div class="ttdef"><b>Definition:</b> <a href="DMRG_8h_source.html#l00082">DMRG.h:82</a></div></div>
<div class="ttc" id="classCheMPS2_1_1EdmistonRuedenberg_html_aeefc7cee7eae7da6c2beb4e0c0cdfd7c"><div class="ttname"><a href="classCheMPS2_1_1EdmistonRuedenberg.html#aeefc7cee7eae7da6c2beb4e0c0cdfd7c">CheMPS2::EdmistonRuedenberg::FiedlerGlobal</a></div><div class="ttdeci">void FiedlerGlobal(int *dmrg2ham) const </div><div class="ttdoc">Permute the orbitals so that the bandwidth of the exchange matrix is (approximately) minimized...</div><div class="ttdef"><b>Definition:</b> <a href="EdmistonRuedenberg_8cpp_source.html#l00432">EdmistonRuedenberg.cpp:432</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRG_html_acfb3123c72e3503f2d6c77dcf9eb141a"><div class="ttname"><a href="classCheMPS2_1_1DMRG.html#acfb3123c72e3503f2d6c77dcf9eb141a">CheMPS2::DMRG::newExcitation</a></div><div class="ttdeci">void newExcitation(const double EshiftIn)</div><div class="ttdoc">Push back current calculation and set everything up to calculate a (new) excitation. </div><div class="ttdef"><b>Definition:</b> <a href="DMRG_8cpp_source.html#l00395">DMRG.cpp:395</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRGSCFintegrals_html"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFintegrals.html">CheMPS2::DMRGSCFintegrals</a></div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFintegrals_8h_source.html#l00039">DMRGSCFintegrals.h:39</a></div></div>
<div class="ttc" id="classCheMPS2_1_1Hamiltonian_html"><div class="ttname"><a href="classCheMPS2_1_1Hamiltonian.html">CheMPS2::Hamiltonian</a></div><div class="ttdef"><b>Definition:</b> <a href="Hamiltonian_8h_source.html#l00053">Hamiltonian.h:53</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRGSCFmatrix_html_a2ef8f82defc36267771d5b8c69d36bd9"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFmatrix.html#a2ef8f82defc36267771d5b8c69d36bd9">CheMPS2::DMRGSCFmatrix::get</a></div><div class="ttdeci">double get(const int irrep, const int p, const int q) const </div><div class="ttdoc">Get an element. </div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFmatrix_8cpp_source.html#l00081">DMRGSCFmatrix.cpp:81</a></div></div>
<div class="ttc" id="classCheMPS2_1_1ConvergenceScheme_html"><div class="ttname"><a href="classCheMPS2_1_1ConvergenceScheme.html">CheMPS2::ConvergenceScheme</a></div><div class="ttdef"><b>Definition:</b> <a href="ConvergenceScheme_8h_source.html#l00041">ConvergenceScheme.h:41</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRGSCFoptions_html_acea3d3f5a5abf8a4bdd509fc13a1a275"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFoptions.html#acea3d3f5a5abf8a4bdd509fc13a1a275">CheMPS2::DMRGSCFoptions::getStoreUnitary</a></div><div class="ttdeci">bool getStoreUnitary() const </div><div class="ttdoc">Get whether the Orbital Rotation checkpoint should be stored to disk. </div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFoptions_8cpp_source.html#l00051">DMRGSCFoptions.cpp:51</a></div></div>
<div class="ttc" id="classCheMPS2_1_1FCI_html_af904234f3a73203c39ddadba56d49555"><div class="ttname"><a href="classCheMPS2_1_1FCI.html#af904234f3a73203c39ddadba56d49555">CheMPS2::FCI::getVecLength</a></div><div class="ttdeci">unsigned int getVecLength(const int irrep_center) const </div><div class="ttdoc">Getter for the number of variables in the vector &quot; E_ij | FCI vector &gt; &quot; ; where irrep_center = I_i x...</div><div class="ttdef"><b>Definition:</b> <a href="FCI_8h_source.html#l00065">FCI.h:65</a></div></div>
<div class="ttc" id="classCheMPS2_1_1CASSCF_html_ac35e694fd9e00f47d361bdbd47b787e1"><div class="ttname"><a href="classCheMPS2_1_1CASSCF.html#ac35e694fd9e00f47d361bdbd47b787e1">CheMPS2::CASSCF::setDMRG1DM</a></div><div class="ttdeci">static void setDMRG1DM(const int num_elec, const int LAS, double *one_dm, double *two_dm)</div><div class="ttdoc">Construct the 1-RDM from the 2-RDM. </div><div class="ttdef"><b>Definition:</b> <a href="CASSCF_8cpp_source.html#l00134">CASSCF.cpp:134</a></div></div>
<div class="ttc" id="classCheMPS2_1_1FCI_html_a46c8a713121b5554e76ffdd640450e2d"><div class="ttname"><a href="classCheMPS2_1_1FCI.html#a46c8a713121b5554e76ffdd640450e2d">CheMPS2::FCI::Fill3RDM</a></div><div class="ttdeci">void Fill3RDM(double *vector, double *ThreeRDM) const </div><div class="ttdoc">Construct the (spin-summed) 3-RDM of a FCI vector: Gamma^3(i,j,k,l,m,n) = sum_sigma,tau,s &lt; a^+_{i,sigma} a^+_{j,tau} a^+_{k,s} a_{n,s} a_{m,tau} a_{l,sigma} &gt; = ThreeRDM[ i + L * ( j + L * ( k + L * ( l + L * ( m + L * n ) ) ) ) ]. </div><div class="ttdef"><b>Definition:</b> <a href="FCI_8cpp_source.html#l01168">FCI.cpp:1168</a></div></div>
<div class="ttc" id="classCheMPS2_1_1EdmistonRuedenberg_html"><div class="ttname"><a href="classCheMPS2_1_1EdmistonRuedenberg.html">CheMPS2::EdmistonRuedenberg</a></div><div class="ttdef"><b>Definition:</b> <a href="EdmistonRuedenberg_8h_source.html#l00126">EdmistonRuedenberg.h:126</a></div></div>
<div class="ttc" id="classCheMPS2_1_1Problem_html"><div class="ttname"><a href="classCheMPS2_1_1Problem.html">CheMPS2::Problem</a></div><div class="ttdef"><b>Definition:</b> <a href="Problem_8h_source.html#l00035">Problem.h:35</a></div></div>
<div class="ttc" id="classCheMPS2_1_1FCI_html_afb601467d67d5d85b3783d144d608557"><div class="ttname"><a href="classCheMPS2_1_1FCI.html#afb601467d67d5d85b3783d144d608557">CheMPS2::FCI::ClearVector</a></div><div class="ttdeci">static void ClearVector(const unsigned int vecLength, double *vec)</div><div class="ttdoc">Set the entries of a vector to zero. </div><div class="ttdef"><b>Definition:</b> <a href="FCI_8cpp_source.html#l01908">FCI.cpp:1908</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRG_html_ab442cbc43e2e5d877660859578849133"><div class="ttname"><a href="classCheMPS2_1_1DMRG.html#ab442cbc43e2e5d877660859578849133">CheMPS2::DMRG::activateExcitations</a></div><div class="ttdeci">void activateExcitations(const int maxExcIn)</div><div class="ttdoc">Activate the necessary storage and machinery to handle excitations. </div><div class="ttdef"><b>Definition:</b> <a href="DMRG_8cpp_source.html#l00384">DMRG.cpp:384</a></div></div>
<div class="ttc" id="classCheMPS2_1_1Cumulant_html_a71af6ca25a81326cac7f772bd9723ab7"><div class="ttname"><a href="classCheMPS2_1_1Cumulant.html#a71af6ca25a81326cac7f772bd9723ab7">CheMPS2::Cumulant::gamma4_fock_contract_ham</a></div><div class="ttdeci">static void gamma4_fock_contract_ham(const Problem *prob, const ThreeDM *the3DM, const TwoDM *the2DM, double *fock, double *result)</div><div class="ttdoc">Contract the CASPT2 Fock operator with the cumulant approximation of  in  time, using HAM indices...</div><div class="ttdef"><b>Definition:</b> <a href="Cumulant_8cpp_source.html#l00084">Cumulant.cpp:84</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRGSCFindices_html_aed2d6043d3bd4965a4b85c6f1de5efec"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFindices.html#aed2d6043d3bd4965a4b85c6f1de5efec">CheMPS2::DMRGSCFindices::getNDMRG</a></div><div class="ttdeci">int getNDMRG(const int irrep) const </div><div class="ttdoc">Get the number of active orbitals for an irrep. </div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFindices_8cpp_source.html#l00102">DMRGSCFindices.cpp:102</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRG_html_ae87028e0d13f774aa31d5b41978e6aa4"><div class="ttname"><a href="classCheMPS2_1_1DMRG.html#ae87028e0d13f774aa31d5b41978e6aa4">CheMPS2::DMRG::get3DM</a></div><div class="ttdeci">ThreeDM * get3DM()</div><div class="ttdoc">Get the pointer to the 3-RDM. </div><div class="ttdef"><b>Definition:</b> <a href="DMRG_8h_source.html#l00117">DMRG.h:117</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRGSCFindices_html_a5c96f1d95fd5c2ce508f1f159f12f892"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFindices.html#a5c96f1d95fd5c2ce508f1f159f12f892">CheMPS2::DMRGSCFindices::getNOCC</a></div><div class="ttdeci">int getNOCC(const int irrep) const </div><div class="ttdoc">Get the number of occupied orbitals for an irrep. </div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFindices_8cpp_source.html#l00100">DMRGSCFindices.cpp:100</a></div></div>
<div class="ttc" id="classCheMPS2_1_1CASSCF_html_ad493cbf60a7b807ad0d3a06de74001b9"><div class="ttname"><a href="classCheMPS2_1_1CASSCF.html#ad493cbf60a7b807ad0d3a06de74001b9">CheMPS2::CASSCF::read_f4rdm_checkpoint</a></div><div class="ttdeci">static bool read_f4rdm_checkpoint(const string f4rdm_file, int *hamorb1, int *hamorb2, const int tot_dmrg_power6, double *contract)</div><div class="ttdoc">Read the checkpoint file for the contraction of the generalized Fock operator with the 4-RDM from dis...</div><div class="ttdef"><b>Definition:</b> <a href="CASSCFpt2_8cpp_source.html#l00087">CASSCFpt2.cpp:87</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRG_html_a43f338725791d3b5822acdba6444c056"><div class="ttname"><a href="classCheMPS2_1_1DMRG.html#a43f338725791d3b5822acdba6444c056">CheMPS2::DMRG::calc_rdms_and_correlations</a></div><div class="ttdeci">void calc_rdms_and_correlations(const bool do_3rdm, const bool disk_3rdm=false)</div><div class="ttdoc">Calculate the reduced density matrices and correlations. Afterwards the MPS is again in LLLLLLLC gaug...</div><div class="ttdef"><b>Definition:</b> <a href="DMRGtechnics_8cpp_source.html#l00040">DMRGtechnics.cpp:40</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRG_html_a2254cc31b5d9497694ea2229226b7bd6"><div class="ttname"><a href="classCheMPS2_1_1DMRG.html#a2254cc31b5d9497694ea2229226b7bd6">CheMPS2::DMRG::deleteStoredOperators</a></div><div class="ttdeci">void deleteStoredOperators()</div><div class="ttdoc">Call &quot;rm &quot; + tempfolder + &quot;/&quot; + CheMPS2::DMRG_OPERATOR_storage_prefix + string(thePID) + &quot;*...</div><div class="ttdef"><b>Definition:</b> <a href="DMRGoperators_8cpp_source.html#l01541">DMRGoperators.cpp:1541</a></div></div>
<div class="ttc" id="classCheMPS2_1_1CASSCF_html_ad4c00cd4c21dc402ad5e966232b199d3"><div class="ttname"><a href="classCheMPS2_1_1CASSCF.html#ad4c00cd4c21dc402ad5e966232b199d3">CheMPS2::CASSCF::deviation_from_blockdiag</a></div><div class="ttdeci">static double deviation_from_blockdiag(DMRGSCFmatrix *matrix, const DMRGSCFindices *idx)</div><div class="ttdoc">Return the RMS deviation from block-diagonal. </div><div class="ttdef"><b>Definition:</b> <a href="CASSCFpt2_8cpp_source.html#l00401">CASSCFpt2.cpp:401</a></div></div>
<div class="ttc" id="classCheMPS2_1_1FCI_html_a36e81090d6d9c12eb8e86f65ce1e66b4"><div class="ttname"><a href="classCheMPS2_1_1FCI.html#a36e81090d6d9c12eb8e86f65ce1e66b4">CheMPS2::FCI::Fill2RDM</a></div><div class="ttdeci">double Fill2RDM(double *vector, double *TwoRDM) const </div><div class="ttdoc">Construct the (spin-summed) 2-RDM of a FCI vector: Gamma^2(i,j,k,l) = sum_sigma,tau &lt; a^+_i...</div><div class="ttdef"><b>Definition:</b> <a href="FCI_8cpp_source.html#l00805">FCI.cpp:805</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRGSCFindices_html_afdbe42f60924d9fb705cce44426d72d0"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFindices.html#afdbe42f60924d9fb705cce44426d72d0">CheMPS2::DMRGSCFindices::getNVIRT</a></div><div class="ttdeci">int getNVIRT(const int irrep) const </div><div class="ttdoc">Get the number of virtual orbitals for an irrep. </div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFindices_8cpp_source.html#l00104">DMRGSCFindices.cpp:104</a></div></div>
<div class="ttc" id="classCheMPS2_1_1FCI_html_a91869efdf5f581c444c69627bd3b593a"><div class="ttname"><a href="classCheMPS2_1_1FCI.html#a91869efdf5f581c444c69627bd3b593a">CheMPS2::FCI::Fock4RDM</a></div><div class="ttdeci">void Fock4RDM(double *vector, double *ThreeRDM, double *Fock, double *output) const </div><div class="ttdoc">Construct the (spin-summed) contraction of the 4-RDM with the Fock operator: output(i,j,k,p,q,r) = sum_{l,t} Fock(l,t) * Gamma^4(i,j,k,l,p,q,r,t) </div><div class="ttdef"><b>Definition:</b> <a href="FCI_8cpp_source.html#l01160">FCI.cpp:1160</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRGSCFmatrix_html"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFmatrix.html">CheMPS2::DMRGSCFmatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFmatrix_8h_source.html#l00032">DMRGSCFmatrix.h:32</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRGSCFoptions_html_a45fb0323c73651fb83f6856af5145e83"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFoptions.html#a45fb0323c73651fb83f6856af5145e83">CheMPS2::DMRGSCFoptions::getUnitaryStorageName</a></div><div class="ttdeci">string getUnitaryStorageName() const </div><div class="ttdoc">Get the Orbital Rotation checkpoint filename. </div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFoptions_8cpp_source.html#l00052">DMRGSCFoptions.cpp:52</a></div></div>
<div class="ttc" id="classCheMPS2_1_1DMRGSCFindices_html_a4254f02aa6d668a25461217fccb8f40c"><div class="ttname"><a href="classCheMPS2_1_1DMRGSCFindices.html#a4254f02aa6d668a25461217fccb8f40c">CheMPS2::DMRGSCFindices::getNirreps</a></div><div class="ttdeci">int getNirreps() const </div><div class="ttdoc">Get the number of irreps. </div><div class="ttdef"><b>Definition:</b> <a href="DMRGSCFindices_8cpp_source.html#l00096">DMRGSCFindices.cpp:96</a></div></div>
<div class="ttc" id="classCheMPS2_1_1CASPT2_html"><div class="ttname"><a href="classCheMPS2_1_1CASPT2.html">CheMPS2::CASPT2</a></div><div class="ttdef"><b>Definition:</b> <a href="CASPT2_8h_source.html#l00062">CASPT2.h:62</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>CASSCFpt2.cpp</b></li>
    <li class="footer">Generated on Tue Jun 28 2016 17:16:17 for CheMPS2 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
