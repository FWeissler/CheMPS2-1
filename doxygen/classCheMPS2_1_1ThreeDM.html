<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>CheMPS2: CheMPS2::ThreeDM Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="CheMPS2logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CheMPS2
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classCheMPS2_1_1ThreeDM.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classCheMPS2_1_1ThreeDM-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CheMPS2::ThreeDM Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="ThreeDM_8h_source.html">ThreeDM.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab312bfae70038282f302d0335fb627bf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1ThreeDM.html#ab312bfae70038282f302d0335fb627bf">ThreeDM</a> (const <a class="el" href="classCheMPS2_1_1SyBookkeeper.html">SyBookkeeper</a> *book_in, const <a class="el" href="classCheMPS2_1_1Problem.html">Problem</a> *prob_in, const bool disk_in)</td></tr>
<tr class="memdesc:ab312bfae70038282f302d0335fb627bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#ab312bfae70038282f302d0335fb627bf">More...</a><br /></td></tr>
<tr class="separator:ab312bfae70038282f302d0335fb627bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac707f31b495fcad9a4082894b68b15bc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac707f31b495fcad9a4082894b68b15bc"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1ThreeDM.html#ac707f31b495fcad9a4082894b68b15bc">~ThreeDM</a> ()</td></tr>
<tr class="memdesc:ac707f31b495fcad9a4082894b68b15bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:ac707f31b495fcad9a4082894b68b15bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3a0de0da6659adca36ea0cdae16da0e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1ThreeDM.html#ae3a0de0da6659adca36ea0cdae16da0e">get_ham_index</a> (const int cnt1, const int cnt2, const int cnt3, const int cnt4, const int cnt5, const int cnt6) const </td></tr>
<tr class="memdesc:ae3a0de0da6659adca36ea0cdae16da0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a 3-RDM, using the HAM indices.  <a href="#ae3a0de0da6659adca36ea0cdae16da0e">More...</a><br /></td></tr>
<tr class="separator:ae3a0de0da6659adca36ea0cdae16da0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af918bc3d3c4655263b8205a2f99632c8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1ThreeDM.html#af918bc3d3c4655263b8205a2f99632c8">fill_ham_index</a> (const double alpha, const bool add, double *storage, const int last_orb_start, const int last_orb_num)</td></tr>
<tr class="memdesc:af918bc3d3c4655263b8205a2f99632c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform storage[ :, :, :, :, :, : ] { = or += } alpha * 3-RDM[ :, :, :, :, :, last_orb_start: last_orb_start + last_orb_num ].  <a href="#af918bc3d3c4655263b8205a2f99632c8">More...</a><br /></td></tr>
<tr class="separator:af918bc3d3c4655263b8205a2f99632c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41f377c3636898276dcb6c2f30dbf3ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1ThreeDM.html#a41f377c3636898276dcb6c2f30dbf3ad">fill_site</a> (<a class="el" href="classCheMPS2_1_1TensorT.html">TensorT</a> *denT, <a class="el" href="classCheMPS2_1_1TensorL.html">TensorL</a> ***Ltens, <a class="el" href="classCheMPS2_1_1TensorF0.html">TensorF0</a> ****F0tens, <a class="el" href="classCheMPS2_1_1TensorF1.html">TensorF1</a> ****F1tens, <a class="el" href="classCheMPS2_1_1TensorS0.html">TensorS0</a> ****S0tens, <a class="el" href="classCheMPS2_1_1TensorS1.html">TensorS1</a> ****S1tens, <a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****dm3_a_J0_doublet, <a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****dm3_a_J1_doublet, <a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****dm3_a_J1_quartet, <a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****dm3_b_J0_doublet, <a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****dm3_b_J1_doublet, <a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****dm3_b_J1_quartet, <a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****dm3_c_J0_doublet, <a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****dm3_c_J1_doublet, <a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****dm3_c_J1_quartet, <a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****dm3_d_J0_doublet, <a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****dm3_d_J1_doublet, <a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****dm3_d_J1_quartet)</td></tr>
<tr class="memdesc:a41f377c3636898276dcb6c2f30dbf3ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill the 3-RDM terms corresponding to site denT-&gt;gIndex()  <a href="#a41f377c3636898276dcb6c2f30dbf3ad">More...</a><br /></td></tr>
<tr class="separator:a41f377c3636898276dcb6c2f30dbf3ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a3de81e9881218690e26094be30b749"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0a3de81e9881218690e26094be30b749"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1ThreeDM.html#a0a3de81e9881218690e26094be30b749">correct_higher_multiplicities</a> ()</td></tr>
<tr class="memdesc:a0a3de81e9881218690e26094be30b749"><td class="mdescLeft">&#160;</td><td class="mdescRight">After the whole 3-RDM is filled, a prefactor for higher multiplicities should be applied. <br /></td></tr>
<tr class="separator:a0a3de81e9881218690e26094be30b749"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a363f29c1aea7e4317c3e5814099a6d5a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1ThreeDM.html#a363f29c1aea7e4317c3e5814099a6d5a">trace</a> ()</td></tr>
<tr class="memdesc:a363f29c1aea7e4317c3e5814099a6d5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the trace (should be N(N-1)(N-2))  <a href="#a363f29c1aea7e4317c3e5814099a6d5a">More...</a><br /></td></tr>
<tr class="separator:a363f29c1aea7e4317c3e5814099a6d5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acceb29cbf3244a2fee196f36c87589a7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acceb29cbf3244a2fee196f36c87589a7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1ThreeDM.html#acceb29cbf3244a2fee196f36c87589a7">mpi_allreduce</a> ()</td></tr>
<tr class="memdesc:acceb29cbf3244a2fee196f36c87589a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add the 3-RDM elements of all MPI processes. <br /></td></tr>
<tr class="separator:acceb29cbf3244a2fee196f36c87589a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1d8f0a899a6e7c9532d54f69deb4591"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1ThreeDM.html#ac1d8f0a899a6e7c9532d54f69deb4591">save_HAM</a> (const string filename) const </td></tr>
<tr class="memdesc:ac1d8f0a899a6e7c9532d54f69deb4591"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save the 3-RDM to disk in <a class="el" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a> indices.  <a href="#ac1d8f0a899a6e7c9532d54f69deb4591">More...</a><br /></td></tr>
<tr class="separator:ac1d8f0a899a6e7c9532d54f69deb4591"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a891c794acfb021f3ac4cd0c154973c30"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCheMPS2_1_1ThreeDM.html#a891c794acfb021f3ac4cd0c154973c30">save_HAM_generic</a> (const string filename, const int LAS, const string tag, double *array)</td></tr>
<tr class="memdesc:a891c794acfb021f3ac4cd0c154973c30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic save routine for objects of size LAS**6.  <a href="#a891c794acfb021f3ac4cd0c154973c30">More...</a><br /></td></tr>
<tr class="separator:a891c794acfb021f3ac4cd0c154973c30"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classCheMPS2_1_1ThreeDM.html">ThreeDM</a> class. </p><dl class="section author"><dt>Author</dt><dd>Sebastian Wouters <a href="#" onclick="location.href='mai'+'lto:'+'seb'+'as'+'tia'+'nw'+'out'+'er'+'s@g'+'ma'+'il.'+'co'+'m'; return false;">sebas<span style="display: none;">.nosp@m.</span>tian<span style="display: none;">.nosp@m.</span>woute<span style="display: none;">.nosp@m.</span>rs@g<span style="display: none;">.nosp@m.</span>mail.<span style="display: none;">.nosp@m.</span>com</a> </dd></dl>
<dl class="section date"><dt>Date</dt><dd>November 16, 2015</dd></dl>
<p>The <a class="el" href="classCheMPS2_1_1ThreeDM.html">ThreeDM</a> class stores the spin-summed three-particle reduced density matrix (3-RDM) of a converged <a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> calculation: <br />
 <img class="formulaInl" alt="$ \Gamma_{ijk;lmn} = \sum_{\sigma \tau s} \braket{ a^{\dagger}_{i \sigma} a^{\dagger}_{j \tau} a^{\dagger}_{k s} a_{n s} a_{m \tau} a_{l \sigma}} $" src="form_186.png"/><br />
Because the wave-function belongs to a certain Abelian irrep, <img class="formulaInl" alt="$ I_{i} \otimes I_{j} \otimes I_{k} = I_{l} \otimes I_{m} \otimes I_{n} $" src="form_187.png"/> must be valid before the corresponding element <img class="formulaInl" alt="$ \Gamma_{ijk;lmn} $" src="form_188.png"/> is non-zero. </p>

<p>Definition at line <a class="el" href="ThreeDM_8h_source.html#l00041">41</a> of file <a class="el" href="ThreeDM_8h_source.html">ThreeDM.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab312bfae70038282f302d0335fb627bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CheMPS2::ThreeDM::ThreeDM </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1SyBookkeeper.html">SyBookkeeper</a> *&#160;</td>
          <td class="paramname"><em>book_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCheMPS2_1_1Problem.html">Problem</a> *&#160;</td>
          <td class="paramname"><em>prob_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>disk_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">book_in</td><td>Symmetry sector bookkeeper </td></tr>
    <tr><td class="paramname">prob_in</td><td>The problem to be solved </td></tr>
    <tr><td class="paramname">disk_in</td><td>Whether or not to use disk in order to avoid storing the full 3-RDM of size L^6 </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ThreeDM_8cpp_source.html#l00038">38</a> of file <a class="el" href="ThreeDM_8cpp_source.html">ThreeDM.cpp</a>.</p>

<p><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1ThreeDM_ab312bfae70038282f302d0335fb627bf_cgraph.png" border="0" usemap="#classCheMPS2_1_1ThreeDM_ab312bfae70038282f302d0335fb627bf_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1ThreeDM_ab312bfae70038282f302d0335fb627bf_cgraph" id="classCheMPS2_1_1ThreeDM_ab312bfae70038282f302d0335fb627bf_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1SyBookkeeper.html#aff6ffb8d891d6380a7b2770348a0dcd7" title="Get the number of orbitals. " alt="" coords="260,5,457,32"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1Problem.html#a3e7be26cd15d22f4e0a65a34616cbcdd" title="Get the number of orbitals. " alt="" coords="505,5,665,32"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="af918bc3d3c4655263b8205a2f99632c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::ThreeDM::fill_ham_index </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>add</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>storage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>last_orb_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>last_orb_num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform storage[ :, :, :, :, :, : ] { = or += } alpha * 3-RDM[ :, :, :, :, :, last_orb_start: last_orb_start + last_orb_num ]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alpha</td><td>The prefactor </td></tr>
    <tr><td class="paramname">add</td><td>Whether to add to, or to set the storage </td></tr>
    <tr><td class="paramname">storage</td><td>Array of size L * L * L * L * L * last_orb_num </td></tr>
    <tr><td class="paramname">last_orb_start</td><td>Begin index for the sixth orbital of the 3-RDM </td></tr>
    <tr><td class="paramname">last_orb_num</td><td>Number of consecutive sixth orbitals to copy </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ThreeDM_8cpp_source.html#l00155">155</a> of file <a class="el" href="ThreeDM_8cpp_source.html">ThreeDM.cpp</a>.</p>

<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1ThreeDM_af918bc3d3c4655263b8205a2f99632c8_icgraph.png" border="0" usemap="#classCheMPS2_1_1ThreeDM_af918bc3d3c4655263b8205a2f99632c8_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1ThreeDM_af918bc3d3c4655263b8205a2f99632c8_icgraph" id="classCheMPS2_1_1ThreeDM_af918bc3d3c4655263b8205a2f99632c8_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1CASSCF.html#a0e8e56a34c6f28fe27341425a1db8384" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="745,38,937,65"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1DMRG.html#a5e39f9d280ccbdc3944b5d50012306ac" title="Obtain the symmetrized 4&#45;RDM terms 0.5 * ( Gamma4_ijkl,pqrt + Gamma4_ijkt,pqrl ) with l and t fixed..." alt="" coords="219,38,433,65"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1CASSCF.html#a3f1e0dc3e01be6e48eed126ca0ff1fd9" title="Build the contraction of the fock matrix with the 4&#45;RDM. " alt="" coords="485,89,663,131"/>
<area shape="rect" id="node6" href="classCheMPS2_1_1DMRG.html#ae87028e0d13f774aa31d5b41978e6aa4" title="Get the pointer to the 3&#45;RDM. " alt="" coords="481,38,667,65"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1CASSCF.html#aa0ecf5c63622cb1f2aa4e72eebb31fe1" title="CASSCF DIIS vectors remove call. " alt="" coords="715,97,968,123"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a41f377c3636898276dcb6c2f30dbf3ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::ThreeDM::fill_site </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1TensorT.html">TensorT</a> *&#160;</td>
          <td class="paramname"><em>denT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1TensorL.html">TensorL</a> ***&#160;</td>
          <td class="paramname"><em>Ltens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1TensorF0.html">TensorF0</a> ****&#160;</td>
          <td class="paramname"><em>F0tens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1TensorF1.html">TensorF1</a> ****&#160;</td>
          <td class="paramname"><em>F1tens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1TensorS0.html">TensorS0</a> ****&#160;</td>
          <td class="paramname"><em>S0tens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1TensorS1.html">TensorS1</a> ****&#160;</td>
          <td class="paramname"><em>S1tens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****&#160;</td>
          <td class="paramname"><em>dm3_a_J0_doublet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****&#160;</td>
          <td class="paramname"><em>dm3_a_J1_doublet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****&#160;</td>
          <td class="paramname"><em>dm3_a_J1_quartet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****&#160;</td>
          <td class="paramname"><em>dm3_b_J0_doublet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****&#160;</td>
          <td class="paramname"><em>dm3_b_J1_doublet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****&#160;</td>
          <td class="paramname"><em>dm3_b_J1_quartet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****&#160;</td>
          <td class="paramname"><em>dm3_c_J0_doublet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****&#160;</td>
          <td class="paramname"><em>dm3_c_J1_doublet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****&#160;</td>
          <td class="paramname"><em>dm3_c_J1_quartet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****&#160;</td>
          <td class="paramname"><em>dm3_d_J0_doublet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****&#160;</td>
          <td class="paramname"><em>dm3_d_J1_doublet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCheMPS2_1_1Tensor3RDM.html">Tensor3RDM</a> ****&#160;</td>
          <td class="paramname"><em>dm3_d_J1_quartet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill the 3-RDM terms corresponding to site denT-&gt;gIndex() </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">denT</td><td><a class="el" href="classCheMPS2_1_1DMRG.html">DMRG</a> site-matrices </td></tr>
    <tr><td class="paramname">Ltens</td><td>Ltensors </td></tr>
    <tr><td class="paramname">F0tens</td><td>F0tensors </td></tr>
    <tr><td class="paramname">F1tens</td><td>F1tensors </td></tr>
    <tr><td class="paramname">S0tens</td><td>S0tensors </td></tr>
    <tr><td class="paramname">S1tens</td><td>S1tensors </td></tr>
    <tr><td class="paramname">dm3_a_J0_doublet</td><td>Renormalized operator of three second quantized operators: annihilator, annihilator, annihilator </td></tr>
    <tr><td class="paramname">dm3_a_J1_doublet</td><td>Renormalized operator of three second quantized operators: annihilator, annihilator, annihilator </td></tr>
    <tr><td class="paramname">dm3_a_J1_quartet</td><td>Renormalized operator of three second quantized operators: annihilator, annihilator, annihilator </td></tr>
    <tr><td class="paramname">dm3_b_J0_doublet</td><td>Renormalized operator of three second quantized operators: annihilator, annihilator, creator </td></tr>
    <tr><td class="paramname">dm3_b_J1_doublet</td><td>Renormalized operator of three second quantized operators: annihilator, annihilator, creator </td></tr>
    <tr><td class="paramname">dm3_b_J1_quartet</td><td>Renormalized operator of three second quantized operators: annihilator, annihilator, creator </td></tr>
    <tr><td class="paramname">dm3_c_J0_doublet</td><td>Renormalized operator of three second quantized operators: annihilator, creator, annihilator </td></tr>
    <tr><td class="paramname">dm3_c_J1_doublet</td><td>Renormalized operator of three second quantized operators: annihilator, creator, annihilator </td></tr>
    <tr><td class="paramname">dm3_c_J1_quartet</td><td>Renormalized operator of three second quantized operators: annihilator, creator, annihilator </td></tr>
    <tr><td class="paramname">dm3_d_J0_doublet</td><td>Renormalized operator of three second quantized operators: creator, annihilator, annihilator </td></tr>
    <tr><td class="paramname">dm3_d_J1_doublet</td><td>Renormalized operator of three second quantized operators: creator, annihilator, annihilator </td></tr>
    <tr><td class="paramname">dm3_d_J1_quartet</td><td>Renormalized operator of three second quantized operators: creator, annihilator, annihilator </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ThreeDM_8cpp_source.html#l00398">398</a> of file <a class="el" href="ThreeDM_8cpp_source.html">ThreeDM.cpp</a>.</p>

<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1ThreeDM_a41f377c3636898276dcb6c2f30dbf3ad_cgraph.png" border="0" usemap="#classCheMPS2_1_1ThreeDM_a41f377c3636898276dcb6c2f30dbf3ad_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1ThreeDM_a41f377c3636898276dcb6c2f30dbf3ad_cgraph" id="classCheMPS2_1_1ThreeDM_a41f377c3636898276dcb6c2f30dbf3ad_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1MPIchemps2.html#a6732ae60b5b4c8a4f1b063f9db304bf5" title="Get the rank of this MPI process. " alt="" coords="263,64,429,105"/>
<area shape="rect" id="node6" href="classCheMPS2_1_1TensorT.html#a279b51f0616ab58f2a2893681b4cab71" title="Get the location index. " alt="" coords="253,130,439,157"/>
<area shape="rect" id="node7" href="classCheMPS2_1_1SyBookkeeper.html#a470a4876ee25036e3f7db2663986d608" title="Get the maximum virtual dimension at a certain boundary. " alt="" coords="259,333,433,375"/>
<area shape="rect" id="node8" href="classCheMPS2_1_1SyBookkeeper.html#a5e5fbbeb3f0a499ec4b905200f4a14b2" title="Get the min. possible particle number for a certain boundary. " alt="" coords="502,173,677,215"/>
<area shape="rect" id="node9" href="classCheMPS2_1_1SyBookkeeper.html#a3e5f4d30bef465424acb784caaf62628" title="Get the max. possible particle number for a certain boundary. " alt="" coords="502,240,677,281"/>
<area shape="rect" id="node10" href="classCheMPS2_1_1SyBookkeeper.html#ad57f3ba5107c78bdd56131c40ae4f3e9" title="Get the minimum possible spin value for a certain boundary and particle number. " alt="" coords="502,307,677,348"/>
<area shape="rect" id="node11" href="classCheMPS2_1_1SyBookkeeper.html#ad89a9ec018a14187e5a3e5b87ad9fb2c" title="Get the maximum possible spin value for a certain boundary and particle number. " alt="" coords="502,376,677,417"/>
<area shape="rect" id="node12" href="classCheMPS2_1_1SyBookkeeper.html#ade15ac00f19abf28ea238a7d2530e049" title="Get the current virtual dimensions. " alt="" coords="502,443,677,484"/>
<area shape="rect" id="node13" href="classCheMPS2_1_1Special.html#aa4f2b217e055a343e0446eaadd395154" title="Triangle function for two variables. " alt="" coords="259,501,433,543"/>
<area shape="rect" id="node14" href="classCheMPS2_1_1SyBookkeeper.html#ac0d4a5f26831eaf12b023c623494c144" title="Get an orbital irrep. " alt="" coords="259,567,433,608"/>
<area shape="rect" id="node17" href="classCheMPS2_1_1Special.html#abe7c3ec1d1a684a0c86693b11589eaf5" title="Triangle function for three variables. " alt="" coords="259,632,433,673"/>
<area shape="rect" id="node18" href="classCheMPS2_1_1Irreps.html#a1d86c7a8b3c3a7b9215c0e298f0ae047" title="Get the direct product of the irreps with numbers Irrep1 and Irrep2: a bitwise XOR for psi4&#39;s convent..." alt="" coords="494,690,685,717"/>
<area shape="rect" id="node23" href="classCheMPS2_1_1TensorOperator.html#a0c347c3df77117eb3e6340ce032fb3b7" title="Make the in&#45;product of two TensorOperator. " alt="" coords="256,800,436,841"/>
<area shape="rect" id="node25" href="classCheMPS2_1_1TensorOperator.html#a7438680d389551c7c3d38075f83240ce" title="Get how many electrons there are more in the symmetry sector of the lower leg compared to the upper l..." alt="" coords="499,741,679,783"/>
<area shape="rect" id="node26" href="classCheMPS2_1_1TensorOperator.html#a1b08aef00ecb10b1e88220dda5c7e285" title="Get the (real&#45;valued abelian) point group irrep difference between the symmetry sectors of the lower ..." alt="" coords="499,859,679,900"/>
<area shape="rect" id="node27" href="classCheMPS2_1_1TensorOperator.html#a0013992f81ec5681774124e104a22a9d" title="Get the pointer to the storage. " alt="" coords="499,924,679,965"/>
<area shape="rect" id="node28" href="classCheMPS2_1_1Special.html#afffda0b19a0e9dc4bddca5fb3ebfd350" title="Phase function. " alt="" coords="501,990,677,1017"/>
<area shape="rect" id="node29" href="classCheMPS2_1_1Tensor3RDM.html#abce2935d5e3293bbfbd39c7b78b4705e" title="Make the in&#45;product of two Tensor3RDMs. " alt="" coords="262,968,430,1009"/>
<area shape="rect" id="node30" href="classCheMPS2_1_1Tensor3RDM.html#a119e63036c8e52a6f77123798586af1e" title="Get the spin value of the Tensor3RDM. " alt="" coords="505,1107,673,1148"/>
<area shape="rect" id="node32" href="classCheMPS2_1_1SyBookkeeper.html#aac9b4729c5fe841b619b9527dbf69e12" title="Get the total number of irreps. " alt="" coords="259,1136,433,1177"/>
<area shape="rect" id="node33" href="classCheMPS2_1_1TensorT.html#aafb4d43ad6178437b47a32a24c375fa3" title="Get the pointer to the storage. " alt="" coords="247,1202,445,1229"/>
<area shape="rect" id="node34" href="classCheMPS2_1_1Tensor3RDM.html#a4829f26ff83a00999ca6c4159520702a" title="Get the intermediary spin coupling value of the Tensor3RDM. " alt="" coords="262,1253,430,1295"/>
<area shape="rect" id="node35" href="classCheMPS2_1_1Wigner.html#a552611fbd1be53036fc06e52fc8632fa" title="Wigner&#45;6j symbol (gsl api) " alt="" coords="496,1378,683,1405"/>
<area shape="rect" id="node37" href="classCheMPS2_1_1TensorOperator.html#a2088bb2ec0105ad443d02413ee2dd998" title="Set all storage variables to 0.0. " alt="" coords="256,1371,436,1412"/>
<area shape="rect" id="node38" href="classCheMPS2_1_1Wigner.html#aa97a080dbd6e3377e3320abdc8c61289" title="Wigner&#45;9j symbol (gsl api) " alt="" coords="253,1319,439,1346"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1MPIchemps2.html#a2a6ae387436d5e5b0a320a12b87244e1" title="Get the number of MPI processes. " alt="" coords="506,5,673,47"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1Tensor.html#ad68f65759e764c6cb55e2b8db18f8874" title="Get the number of tensor blocks. " alt="" coords="493,71,685,98"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1Tensor.html#a2f17a5413447e77ad3f128d49b3ca676" title="Get the pointer to the storage. " alt="" coords="494,122,685,149"/>
<area shape="rect" id="node15" href="classCheMPS2_1_1Problem.html#ac09cc027ab9b41132096e9bd14b549ff" title="Get an orbital irrep. " alt="" coords="500,574,679,601"/>
<area shape="rect" id="node16" href="classCheMPS2_1_1Hamiltonian.html#a02130b2901a5a3c05171d4f7dd5fa4cd" title="Get an orbital irrep number. " alt="" coords="745,567,903,608"/>
<area shape="rect" id="node19" href="classCheMPS2_1_1Irreps.html#a78b964944caac0cf835e42a428cfef67" title="Fill the array psi2molpro with the irrep conventions of molpro for the currently activated group..." alt="" coords="741,741,907,783"/>
<area shape="rect" id="node21" href="classCheMPS2_1_1Irreps.html#afd70b3b21e33a3f8163db04a768ef848" title="Print all info contained in this class. " alt="" coords="739,690,909,717"/>
<area shape="rect" id="node20" href="classCheMPS2_1_1Irreps.html#aa56e8dea52881f0c86c348539b21bb5c" title="Get the name of the group. " alt="" coords="963,749,1181,775"/>
<area shape="rect" id="node22" href="classCheMPS2_1_1Irreps.html#afd3d1b65e870aad920125c05606c4a7d" title="Get the number of irreps for the currently activated group. " alt="" coords="975,683,1169,724"/>
<area shape="rect" id="node24" href="classCheMPS2_1_1TensorOperator.html#a374c949f32263391f2f8d49532e47f9d" title="Get twice the spin of the tensor operator. " alt="" coords="734,956,914,997"/>
<area shape="rect" id="node31" href="classCheMPS2_1_1Tensor3RDM.html#a98adc5adc004f729db92bf6c5a853311" title="Get whether the tensor convention is prime last. " alt="" coords="505,1041,673,1083"/>
<area shape="rect" id="node36" href="classCheMPS2_1_1Wigner.html#a9e0f7bc0b1b95ad9f57eceaf2ad74651" title="Two times the maximum value of the angular momentum which is allowed. " alt="" coords="733,1378,915,1405"/>
</map>
</div>
</p>

<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1ThreeDM_a41f377c3636898276dcb6c2f30dbf3ad_icgraph.png" border="0" usemap="#classCheMPS2_1_1ThreeDM_a41f377c3636898276dcb6c2f30dbf3ad_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1ThreeDM_a41f377c3636898276dcb6c2f30dbf3ad_icgraph" id="classCheMPS2_1_1ThreeDM_a41f377c3636898276dcb6c2f30dbf3ad_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRG.html#a5e39f9d280ccbdc3944b5d50012306ac" title="Obtain the symmetrized 4&#45;RDM terms 0.5 * ( Gamma4_ijkl,pqrt + Gamma4_ijkt,pqrl ) with l and t fixed..." alt="" coords="247,67,461,94"/>
<area shape="rect" id="node7" href="classCheMPS2_1_1DMRG.html#a43f338725791d3b5822acdba6444c056" title="Calculate the reduced density matrices and correlations. Afterwards the MPS is again in LLLLLLLC gaug..." alt="" coords="273,119,435,160"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1CASSCF.html#a3f1e0dc3e01be6e48eed126ca0ff1fd9" title="Build the contraction of the fock matrix with the 4&#45;RDM. " alt="" coords="526,5,705,47"/>
<area shape="rect" id="node6" href="classCheMPS2_1_1DMRG.html#ae87028e0d13f774aa31d5b41978e6aa4" title="Get the pointer to the 3&#45;RDM. " alt="" coords="523,71,708,98"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1CASSCF.html#aa0ecf5c63622cb1f2aa4e72eebb31fe1" title="CASSCF DIIS vectors remove call. " alt="" coords="769,13,1023,39"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1CASSCF.html#a0e8e56a34c6f28fe27341425a1db8384" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="800,71,992,98"/>
<area shape="rect" id="node8" href="classCheMPS2_1_1DMRG.html#aea1ffffbf2e12b56d602e5b692dd3a79" title="Calculate the 2&#45;RDM and correlations. Afterwards the MPS is again in LLLLLLLC gauge. " alt="" coords="509,173,721,215"/>
<area shape="rect" id="node9" href="classCheMPS2_1_1CASSCF.html#a8b4ebee13ba2a5764081fae5275f6c7e" title="Do the CASSCF cycles with the augmented Hessian Newton&#45;Raphson method. " alt="" coords="804,181,988,207"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae3a0de0da6659adca36ea0cdae16da0e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CheMPS2::ThreeDM::get_ham_index </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>cnt1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>cnt2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>cnt3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>cnt4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>cnt5</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>cnt6</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a 3-RDM, using the HAM indices. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cnt1</td><td>the first index </td></tr>
    <tr><td class="paramname">cnt2</td><td>the second index </td></tr>
    <tr><td class="paramname">cnt3</td><td>the third index </td></tr>
    <tr><td class="paramname">cnt4</td><td>the fourth index </td></tr>
    <tr><td class="paramname">cnt5</td><td>the fifth index </td></tr>
    <tr><td class="paramname">cnt6</td><td>the sixth index </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the desired value </dd></dl>

<p>Definition at line <a class="el" href="ThreeDM_8cpp_source.html#l00148">148</a> of file <a class="el" href="ThreeDM_8cpp_source.html">ThreeDM.cpp</a>.</p>

<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1ThreeDM_ae3a0de0da6659adca36ea0cdae16da0e_icgraph.png" border="0" usemap="#classCheMPS2_1_1ThreeDM_ae3a0de0da6659adca36ea0cdae16da0e_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1ThreeDM_ae3a0de0da6659adca36ea0cdae16da0e_icgraph" id="classCheMPS2_1_1ThreeDM_ae3a0de0da6659adca36ea0cdae16da0e_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1Cumulant.html#a71af6ca25a81326cac7f772bd9723ab7" title="Contract the CASPT2 Fock operator with the cumulant approximation of &#160;in &#160;time, using HAM indices..." alt="" coords="487,5,677,47"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1Cumulant.html#ad55b86a6598f2af787a1d246334f5c71" title="Get the cumulant approximation of , using HAM indices. " alt="" coords="254,216,409,257"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1DMRG.html#a5e39f9d280ccbdc3944b5d50012306ac" title="Obtain the symmetrized 4&#45;RDM terms 0.5 * ( Gamma4_ijkl,pqrt + Gamma4_ijkt,pqrl ) with l and t fixed..." alt="" coords="224,114,439,141"/>
<area shape="rect" id="node9" href="classCheMPS2_1_1ThreeDM.html#a363f29c1aea7e4317c3e5814099a6d5a" title="Return the trace (should be N(N&#45;1)(N&#45;2)) " alt="" coords="241,165,422,191"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1CASSCF.html#a0e8e56a34c6f28fe27341425a1db8384" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="756,75,948,102"/>
<area shape="rect" id="node6" href="classCheMPS2_1_1CASSCF.html#a3f1e0dc3e01be6e48eed126ca0ff1fd9" title="Build the contraction of the fock matrix with the 4&#45;RDM. " alt="" coords="493,123,671,164"/>
<area shape="rect" id="node8" href="classCheMPS2_1_1DMRG.html#ae87028e0d13f774aa31d5b41978e6aa4" title="Get the pointer to the 3&#45;RDM. " alt="" coords="489,71,675,98"/>
<area shape="rect" id="node7" href="classCheMPS2_1_1CASSCF.html#aa0ecf5c63622cb1f2aa4e72eebb31fe1" title="CASSCF DIIS vectors remove call. " alt="" coords="725,130,979,157"/>
<area shape="rect" id="node10" href="classCheMPS2_1_1DMRG.html#a43f338725791d3b5822acdba6444c056" title="Calculate the reduced density matrices and correlations. Afterwards the MPS is again in LLLLLLLC gaug..." alt="" coords="501,188,663,229"/>
<area shape="rect" id="node11" href="classCheMPS2_1_1DMRG.html#aea1ffffbf2e12b56d602e5b692dd3a79" title="Calculate the 2&#45;RDM and correlations. Afterwards the MPS is again in LLLLLLLC gauge. " alt="" coords="746,188,958,229"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac1d8f0a899a6e7c9532d54f69deb4591"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::ThreeDM::save_HAM </td>
          <td>(</td>
          <td class="paramtype">const string&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save the 3-RDM to disk in <a class="el" href="classCheMPS2_1_1Hamiltonian.html">Hamiltonian</a> indices. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>The filename to store the 3-RDM at </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ThreeDM_8cpp_source.html#l00371">371</a> of file <a class="el" href="ThreeDM_8cpp_source.html">ThreeDM.cpp</a>.</p>

<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1ThreeDM_ac1d8f0a899a6e7c9532d54f69deb4591_cgraph.png" border="0" usemap="#classCheMPS2_1_1ThreeDM_ac1d8f0a899a6e7c9532d54f69deb4591_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1ThreeDM_ac1d8f0a899a6e7c9532d54f69deb4591_cgraph" id="classCheMPS2_1_1ThreeDM_ac1d8f0a899a6e7c9532d54f69deb4591_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1ThreeDM.html#a891c794acfb021f3ac4cd0c154973c30" title="Generic save routine for objects of size LAS**6. " alt="" coords="271,5,451,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a891c794acfb021f3ac4cd0c154973c30"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheMPS2::ThreeDM::save_HAM_generic </td>
          <td>(</td>
          <td class="paramtype">const string&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>LAS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const string&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generic save routine for objects of size LAS**6. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>The filename to store the object at </td></tr>
    <tr><td class="paramname">LAS</td><td>The number of orbitals </td></tr>
    <tr><td class="paramname">tag</td><td>The name of the object </td></tr>
    <tr><td class="paramname">array</td><td>Pointer to the object </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ThreeDM_8cpp_source.html#l00378">378</a> of file <a class="el" href="ThreeDM_8cpp_source.html">ThreeDM.cpp</a>.</p>

<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1ThreeDM_a891c794acfb021f3ac4cd0c154973c30_icgraph.png" border="0" usemap="#classCheMPS2_1_1ThreeDM_a891c794acfb021f3ac4cd0c154973c30_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1ThreeDM_a891c794acfb021f3ac4cd0c154973c30_icgraph" id="classCheMPS2_1_1ThreeDM_a891c794acfb021f3ac4cd0c154973c30_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1ThreeDM.html#ac1d8f0a899a6e7c9532d54f69deb4591" title="Save the 3&#45;RDM to disk in Hamiltonian indices. " alt="" coords="233,13,451,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a363f29c1aea7e4317c3e5814099a6d5a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CheMPS2::ThreeDM::trace </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the trace (should be N(N-1)(N-2)) </p>
<dl class="section return"><dt>Returns</dt><dd>Trace of the 3-RDM </dd></dl>

<p>Definition at line <a class="el" href="ThreeDM_8cpp_source.html#l00191">191</a> of file <a class="el" href="ThreeDM_8cpp_source.html">ThreeDM.cpp</a>.</p>

<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1ThreeDM_a363f29c1aea7e4317c3e5814099a6d5a_cgraph.png" border="0" usemap="#classCheMPS2_1_1ThreeDM_a363f29c1aea7e4317c3e5814099a6d5a_cgraph" alt=""/></div>
<map name="classCheMPS2_1_1ThreeDM_a363f29c1aea7e4317c3e5814099a6d5a_cgraph" id="classCheMPS2_1_1ThreeDM_a363f29c1aea7e4317c3e5814099a6d5a_cgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1ThreeDM.html#ae3a0de0da6659adca36ea0cdae16da0e" title="Get a 3&#45;RDM, using the HAM indices. " alt="" coords="235,5,405,47"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1MPIchemps2.html#a6732ae60b5b4c8a4f1b063f9db304bf5" title="Get the rank of this MPI process. " alt="" coords="237,71,403,112"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1MPIchemps2.html#a2a6ae387436d5e5b0a320a12b87244e1" title="Get the number of MPI processes. " alt="" coords="466,12,633,53"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1Tensor.html#ad68f65759e764c6cb55e2b8db18f8874" title="Get the number of tensor blocks. " alt="" coords="453,78,645,105"/>
<area shape="rect" id="node6" href="classCheMPS2_1_1Tensor.html#a2f17a5413447e77ad3f128d49b3ca676" title="Get the pointer to the storage. " alt="" coords="454,129,645,155"/>
</map>
</div>
</p>

<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classCheMPS2_1_1ThreeDM_a363f29c1aea7e4317c3e5814099a6d5a_icgraph.png" border="0" usemap="#classCheMPS2_1_1ThreeDM_a363f29c1aea7e4317c3e5814099a6d5a_icgraph" alt=""/></div>
<map name="classCheMPS2_1_1ThreeDM_a363f29c1aea7e4317c3e5814099a6d5a_icgraph" id="classCheMPS2_1_1ThreeDM_a363f29c1aea7e4317c3e5814099a6d5a_icgraph">
<area shape="rect" id="node2" href="classCheMPS2_1_1DMRG.html#a43f338725791d3b5822acdba6444c056" title="Calculate the reduced density matrices and correlations. Afterwards the MPS is again in LLLLLLLC gaug..." alt="" coords="235,27,397,69"/>
<area shape="rect" id="node3" href="classCheMPS2_1_1CASSCF.html#a0e8e56a34c6f28fe27341425a1db8384" title="Calculate the caspt2 correction energy for a converged casscf wavefunction. " alt="" coords="455,5,647,32"/>
<area shape="rect" id="node4" href="classCheMPS2_1_1DMRG.html#aea1ffffbf2e12b56d602e5b692dd3a79" title="Calculate the 2&#45;RDM and correlations. Afterwards the MPS is again in LLLLLLLC gauge. " alt="" coords="445,57,657,98"/>
<area shape="rect" id="node5" href="classCheMPS2_1_1CASSCF.html#a8b4ebee13ba2a5764081fae5275f6c7e" title="Do the CASSCF cycles with the augmented Hessian Newton&#45;Raphson method. " alt="" coords="705,64,889,91"/>
</map>
</div>
</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="ThreeDM_8h_source.html">ThreeDM.h</a></li>
<li><a class="el" href="ThreeDM_8cpp_source.html">ThreeDM.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>CheMPS2</b></li><li class="navelem"><a class="el" href="classCheMPS2_1_1ThreeDM.html">ThreeDM</a></li>
    <li class="footer">Generated on Wed Aug 24 2016 10:09:17 for CheMPS2 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
